# Kotlin

- [Kotlin](#kotlin)
  - [å˜é‡å’Œå‡½æ•°](#å˜é‡å’Œå‡½æ•°)
    - [å˜é‡](#å˜é‡)
  - [å¸¸é‡](#å¸¸é‡)
    - [å‡½æ•°](#å‡½æ•°)
  - [ç¨‹åºçš„é€»è¾‘æ§åˆ¶](#ç¨‹åºçš„é€»è¾‘æ§åˆ¶)
    - [if æ¡ä»¶è¯­å¥](#if-æ¡ä»¶è¯­å¥)
    - [when æ¡ä»¶è¯­å¥](#when-æ¡ä»¶è¯­å¥)
    - [å¾ªç¯è¯­å¥](#å¾ªç¯è¯­å¥)
  - [é¢å‘å¯¹è±¡ç¼–ç¨‹](#é¢å‘å¯¹è±¡ç¼–ç¨‹)
    - [ç±»ä¸å¯¹è±¡](#ç±»ä¸å¯¹è±¡)
    - [ç»§æ‰¿ä¸æ„é€ å‡½æ•°](#ç»§æ‰¿ä¸æ„é€ å‡½æ•°)
      - [ç»§æ‰¿](#ç»§æ‰¿)
      - [æ„é€ å‡½æ•°](#æ„é€ å‡½æ•°)
    - [æ¥å£](#æ¥å£)
    - [å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦](#å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦)
    - [æ•°æ®ç±»ä¸å•ä¾‹ç±»](#æ•°æ®ç±»ä¸å•ä¾‹ç±»)
      - [æ•°æ®ç±»](#æ•°æ®ç±»)
      - [å•ä¾‹ç±»](#å•ä¾‹ç±»)
  - [Lambda ç¼–ç¨‹](#lambda-ç¼–ç¨‹)
    - [é›†åˆçš„åˆ›å»ºå’Œéå†](#é›†åˆçš„åˆ›å»ºå’Œéå†)
    - [é›†åˆçš„å‡½æ•°å¼ API](#é›†åˆçš„å‡½æ•°å¼-api)
    - [Java å‡½æ•°å¼ API çš„ä½¿ç”¨](#java-å‡½æ•°å¼-api-çš„ä½¿ç”¨)
  - [ç©ºæŒ‡é’ˆæ£€æŸ¥](#ç©ºæŒ‡é’ˆæ£€æŸ¥)
    - [å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·](#å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·)
  - [Kotlinä¸­çš„å°é­”æœ¯](#kotlinä¸­çš„å°é­”æœ¯)
    - [å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼](#å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼)
    - [å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼](#å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼)
  - [æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•](#æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•)
    - [æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun å’Œ apply](#æ ‡å‡†å‡½æ•°letalsowithrun-å’Œ-apply)
    - [å®šä¹‰é™æ€æ–¹æ³•](#å®šä¹‰é™æ€æ–¹æ³•)
  - [å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»](#å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»)
    - [å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–](#å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–)
    - [ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç ](#ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç )
  - [æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦](#æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦)
    - [å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°](#å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°)
    - [æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½](#æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½)
  - [é«˜é˜¶å‡½æ•°è¯¦è§£](#é«˜é˜¶å‡½æ•°è¯¦è§£)
    - [å®šä¹‰é«˜é˜¶å‡½æ•°](#å®šä¹‰é«˜é˜¶å‡½æ•°)
    - [é«˜é˜¶å‡½æ•°çš„è°ƒç”¨](#é«˜é˜¶å‡½æ•°çš„è°ƒç”¨)
    - [å†…è”å‡½æ•°çš„ä½œç”¨](#å†…è”å‡½æ•°çš„ä½œç”¨)
  - [æ³›å‹å’Œå§”æ‰˜](#æ³›å‹å’Œå§”æ‰˜)
    - [ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§](#ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§)
    - [ä½¿ç”¨ infix å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•](#ä½¿ç”¨-infix-å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•)
    - [æ³›å‹æ“¦é™¤](#æ³›å‹æ“¦é™¤)
      - [æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤](#æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤)
      - [ä¼ªæ³›å‹](#ä¼ªæ³›å‹)
      - [æ³›å‹æ“¦é™¤è¿›é˜¶](#æ³›å‹æ“¦é™¤è¿›é˜¶)
      - [æ³›å‹è·å–ç»éªŒæ€»ç»“](#æ³›å‹è·å–ç»éªŒæ€»ç»“)
    - [è¾¹ç•Œ](#è¾¹ç•Œ)
    - [é€šé…ç¬¦](#é€šé…ç¬¦)
      - [æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜](#æ³›å‹çš„åå˜é€†å˜å’Œä¸å˜)
      - [æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦](#æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦)
      - [æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦](#æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦)
      - [æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦](#æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦)
      - [PECS åŸåˆ™](#pecs-åŸåˆ™)
      - [ä½¿ç”¨é€šé…ç¬¦æ€»ç»“](#ä½¿ç”¨é€šé…ç¬¦æ€»ç»“)
    - [æ³›å‹çš„é™åˆ¶](#æ³›å‹çš„é™åˆ¶)
    - [é—®é¢˜](#é—®é¢˜)
    - [æ³›å‹çš„åŸºæœ¬ç”¨æ³•](#æ³›å‹çš„åŸºæœ¬ç”¨æ³•)
    - [è¾¹ç•Œ](#è¾¹ç•Œ-1)
    - [æ³›å‹å®åŒ–](#æ³›å‹å®åŒ–)
    - [æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜](#æ³›å‹åå˜é€†å˜å’Œä¸å˜)
  - [åç¨‹](#åç¨‹)
    - [åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“](#åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“)
    - [ä½¿ç”¨ GlobalScope.launch å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹](#ä½¿ç”¨-globalscopelaunch-å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹)
    - [åç¨‹ä½œç”¨åŸŸ](#åç¨‹ä½œç”¨åŸŸ)
      - [CoroutineScope](#coroutinescope)
      - [GlobalScope](#globalscope)
      - [åç¨‹ä½œç”¨åŸŸä½œç”¨](#åç¨‹ä½œç”¨åŸŸä½œç”¨)
      - [ä½œç”¨åŸŸç»†åˆ†](#ä½œç”¨åŸŸç»†åˆ†)
      - [çˆ¶å­åç¨‹é—´çš„è§„åˆ™](#çˆ¶å­åç¨‹é—´çš„è§„åˆ™)
    - [ä½¿ç”¨ Delay å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ](#ä½¿ç”¨-delay-å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ)
    - [ä½¿ç”¨ runBlocking å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ](#ä½¿ç”¨-runblocking-å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ)
    - [ä½¿ç”¨ launch å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹](#ä½¿ç”¨-launch-å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹)
    - [ä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°](#ä½¿ç”¨-suspend-å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°)
    - [ä½¿ç”¨ coroutineScope å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ](#ä½¿ç”¨-coroutinescope-å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ)
    - [ä½¿ç”¨ async å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ](#ä½¿ç”¨-async-å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ)
    - [ä½¿ç”¨ withContext å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„  async å‡½æ•°](#ä½¿ç”¨-withcontext-å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„--async-å‡½æ•°)
    - [ä½¿ç”¨ suspendCoroutine å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•](#ä½¿ç”¨-suspendcoroutine-å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•)
  - [æŒ‚èµ·](#æŒ‚èµ·)
    - [æŒ‚èµ·çš„æœ¬è´¨](#æŒ‚èµ·çš„æœ¬è´¨)
      - [çº¿ç¨‹](#çº¿ç¨‹)
      - [åç¨‹](#åç¨‹-1)
    - [æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ](#æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„)
    - [ä½¿ç”¨ suspend çš„æ„ä¹‰](#ä½¿ç”¨-suspend-çš„æ„ä¹‰)
    - [å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ](#å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°)

![Alt text](image.png)

## å˜é‡å’Œå‡½æ•°

### å˜é‡

1. ä½¿ç”¨ ``val``ï¼ˆvalue çš„ç®€å†™ï¼‰å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯åªè¯»å˜é‡ï¼Œè¿™ç§å˜é‡åˆå§‹èµ‹å€¼åå°±ä¸èƒ½é‡æ–°èµ‹å€¼äº†ï¼Œå¯¹åº” Java ä¸­çš„ ``final`` å˜é‡
2. ä½¿ç”¨ ``var`` ï¼ˆvariable çš„ç®€å†™ï¼‰å…³é”®å­—ç”¨æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯è¯»å†™å˜é‡ï¼Œè¿™ç§å˜é‡åˆå§‹èµ‹åˆå€¼åä»ç„¶å¯ä»¥é‡æ–°è¢«èµ‹å€¼ï¼Œå¯¹åº” Java ä¸­çš„é ``final`` å˜é‡
3. Kotlin ä¸­çš„æ¯ä¸€è¡Œä»£ç éƒ½ä¸ç”¨åŠ `` ï¼›``

```kotlin
//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå®šä¹‰
int a = 10;
boolean b = true

//åœ¨ Kotlin ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®šä¹‰ï¼Œå½“ç»™å˜é‡èµ‹å€¼åï¼ŒKotlin ç¼–è¯‘å™¨ä¼šè¿›è¡Œç±»å‹æ¨å¯¼
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ a 
val a = 10
//å®šä¹‰ä¸€ä¸ªå¯å˜çš„å˜é‡ b
var b = true

//å¦‚æœæˆ‘ä»¬æ˜¾ç¤ºçš„ç»™å˜é‡æŒ‡å®šç±»å‹ï¼ŒKotlin å°±ä¸ä¼šè¿›è¡Œç±»å‹æ¨å¯¼äº†
val a: Int = 10
var b: Boolean = "erdai"
```

å¦‚æœä½ è§‚å¯Ÿçš„ä»”ç»†ä¼šå‘ç°ï¼Œä¸Šè¿°ä»£ç  Kotlin å®šä¹‰å˜é‡ç»™å˜é‡æ˜¾ç¤ºçš„æŒ‡å®šç±»å‹æ—¶ï¼Œä½¿ç”¨çš„éƒ½æ˜¯é¦–å­—æ¯å¤§å°çš„ ``Int``ï¼Œ``Boolean``ï¼Œè€Œåœ¨ Java ä¸­éƒ½æ˜¯å°å†™çš„ ``int``ï¼Œ``boolean``ï¼Œè¿™è¡¨æ˜ï¼š Kotlin å®Œå…¨æŠ›å¼ƒäº† Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¨éƒ¨éƒ½æ˜¯**å¯¹è±¡æ•°æ®**ç±»å‹ã€‚ ä¸‹é¢ç»™å‡ºä¸€ä¸ª Java å’Œ Kotlin æ•°æ®ç±»å‹å¯¹ç…§è¡¨ï¼š
| Java åŸºæœ¬æ•°æ®ç±»å‹ | Kotlin å¯¹è±¡æ•°æ®ç±»å‹ | æ•°æ®ç±»å‹è¯´æ˜ |
| ----------------- | ------------------- | ------------ |
| byte              | Byte                | å­—èŠ‚å‹       |
| short             | Short               | çŸ­æ•´å‹       |
| int               | Int                 | æ•´å‹         |
| long              | Long                | é•¿æ•´å‹       |
| float             | Float               | å•ç²¾åº¦æµ®ç‚¹æ•° |
| double            | Double              | åŒç²¾åº¦æµ®ç‚¹æ•° |
| char              | Char                | å­—ç¬¦å‹       |
| boolean           | Boolean             | å¸ƒå°”å‹       |

## å¸¸é‡

Kotlin ä¸­å®šä¹‰ä¸€ä¸ªå¸¸é‡éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶

1. ä½¿ç”¨ ``const val`` æ¥ä¿®é¥°ï¼Œå¹¶åˆå§‹åŒ–
2. ä¿®é¥°çš„ç±»å‹åªèƒ½æ˜¯å­—ç¬¦ä¸²å’ŒåŸºç¡€å¯¹è±¡ç±»å‹
3. åªèƒ½ä¿®é¥°é¡¶å±‚çš„å¸¸é‡ï¼Œobject ä¿®é¥°çš„æˆå‘˜ï¼Œcompanion object çš„æˆå‘˜ï¼Œè¿™äº›æ¦‚å¿µåé¢è¿˜ä¼šè®²åˆ°

```kotlin
//å®šä¹‰ä¸€ä¸ªé¡¶å±‚çš„å¸¸é‡ï¼Œè¿™ä¸ªå¸¸é‡ä¸æ”¾åœ¨ä»»ä½•çš„ç±»ä¸­
const val CONSTANT = "This is a constant"

//å®šä¹‰ä¸€ä¸ª object ä¿®é¥°çš„å•ä¾‹ç±»ï¼Œç±»ä¸­å®šä¹‰ä¸€ä¸ªå¸¸é‡
object SingeTon {
    const val CONSTANT = "This is a constant"
}

class KotlinPractice {
    //å®šä¹‰ä¸€ä¸ª companion object ä¿®é¥°çš„ä¼´ç”Ÿå¯¹è±¡ï¼Œé‡Œé¢å®šä¹‰ä¸€ä¸ªå¸¸é‡
    companion object{
        const val CONSTANT = "This is a constant"
    }
}
```

### å‡½æ•°

1. å‡½æ•°å’Œæ–¹æ³•æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼Œåœ¨ Java ä¸­æˆ‘ä»¬ä¹ æƒ¯å«æ–¹æ³• (method)ï¼Œä½†æ˜¯ Kotlin ä¸­å°±éœ€è¦å«å‡½æ•° (function)
2. å‡½æ•°æ˜¯è¿è¡Œä»£ç çš„è½½ä½“,åƒæˆ‘ä»¬ä½¿ç”¨è¿‡çš„ main å‡½æ•°å°±æ˜¯ä¸€ä¸ªå‡½æ•°
Kotlin ä¸­å®šä¹‰è¯­æ³•çš„è§„åˆ™ï¼š

```kotlin
fun methodName(param1: Int, param2: Int): Int {
    return 0
}

//ä¸‹é¢è¿™ä¸¤ä¸ªæ–¹æ³•æ•ˆæœæ˜¯ä¸€æ ·çš„
fun methodName1(params: Int,params2: Int): Unit{

}

fun methodName1(params: Int,params2: Int){

}
```

ä¸Šè¿°å‡½æ•°è¯­æ³•è§£é‡Šï¼š

fun ( function çš„ç¼©å†™ ) æ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•°çš„å…³é”®å­—ï¼Œæ— è®ºä½ å®šä¹‰ä»€ä¹ˆå‡½æ•°ï¼Œéƒ½è¦ç”¨ fun æ¥å£°æ˜
å‡½æ•°åç§°å¯ä»¥éšä¾¿å–ï¼Œå°±åƒ Java é‡Œé¢å®šä¹‰å‡½æ•°åä¸€æ ·
å‡½æ•°åé‡Œé¢çš„å‚æ•°å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼Œå‚æ•°çš„å£°æ˜æ ¼å¼ä¸ºï¼š``"å‚æ•°å"ï¼š"å‚æ•°ç±»å‹"``
å‚æ•°ååé¢è¿™éƒ¨åˆ†ä»£è¡¨è¿”å›å€¼ï¼Œæˆ‘ä»¬è¿™è¿”å›çš„æ˜¯ä¸€ä¸ª ``Int`` ç±»å‹çš„å€¼ï¼Œè¿™éƒ¨åˆ†æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸å®šä¹‰ï¼Œé»˜è®¤è¿”å›å€¼ä¸º ``Unit``ï¼Œä¸” ``Unit`` å¯çœç•¥

å®è·µä¸€ä¸‹ï¼š

```kotlin
fun main() {
    val number1 = 15
    val number2 = 20
    val maxNumber = largeNumber(number1,number2)
    println(maxNumber)
}

fun largeNumber(number1: Int,number2: Int) : Int{
    //è°ƒç”¨é¡¶å±‚ max å‡½æ•°è®¡ç®—ä¸¤è€…ä¸­çš„æœ€å¤§å€¼
    return max(number1,number2)
}

//æ‰“å°ç»“æœ
20
```

> Kotlin è¯­æ³•ç³–ï¼šå½“ä¸€ä¸ªå‡½æ•°ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç¼–å†™å‡½æ•°ä½“ï¼Œå¯ä»¥å°†å”¯ä¸€çš„ä¸€è¡Œä»£ç å†™åœ¨å‡½æ•°å®šä¹‰çš„å°¾éƒ¨ï¼Œä¸­é—´ç”¨ = è¿æ¥å³å¯

é‚£ä¹ˆä¸Šè¿° largeNumber è¿™ä¸ªå‡½æ•°æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ï¼š

```kotlin
//æ ¹æ®ä¸Šè¿°è¯­æ³•ç³–ï¼Œæˆ‘ä»¬çœç•¥äº†å‡½æ•°ä½“çš„ {} å’Œ return å…³é”®å­—ï¼Œå¢å‡çš„ = è¿æ¥
fun largeNumber(number1: Int,number2: Int) : Int = max(number1,number2)
//æ ¹æ® Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠå‡½æ•°çš„è¿”å›å€¼ç»™çœç•¥ï¼Œæœ€ç»ˆå˜æˆäº†è¿™æ ·
fun largeNumber(number1: Int,number2: Int) = max(number1,number2)
```

## ç¨‹åºçš„é€»è¾‘æ§åˆ¶

### if æ¡ä»¶è¯­å¥

1. Kotlin ä¸­çš„ if æ¡ä»¶è¯­å¥é™¤äº†ç»§æ‰¿äº† Java ä¸­ if æ¡ä»¶è¯­å¥çš„æ‰€æœ‰ç‰¹æ€§ï¼Œä¸”å¯ä»¥æŠŠæ¯ä¸€ä¸ªæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼

æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¸Šè¿° largeNumber å‡½æ•°çš„å†…éƒ¨å®ç°ï¼š

```kotlin
//Kotlin ä¸­æŠŠæ¯ä¸€ä¸ªæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼
fun largeNumber(number1: Int,number2: Int) : Int{
    return if(number1 > number2){
      	number1
    }else {
      	number2
    }
}

//æ ¹æ®ä¸Šé¢å­¦ä¹ çš„è¯­æ³•ç³–å’Œ Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç®€å†™ largeNumber å‡½æ•°ï¼Œæœ€ç»ˆå˜æˆäº†è¿™æ ·
fun largeNumber(number1: Int,number2: Int) = if(number1 > number2) number1 else number 2
```

### when æ¡ä»¶è¯­å¥

- when æ¡ä»¶è¯­å¥ä¹Ÿæ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå’Œ if æ¡ä»¶è¯­å¥ç±»ä¼¼ï¼Œæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼
- when æ¡ä»¶è¯­å¥å…è®¸ä¼ å…¥ä»»æ„ç±»å‹çš„å‚æ•°
- when æ¡ä»¶ä½“ä¸­æ¡ä»¶æ ¼å¼ï¼š``åŒ¹é…å€¼ -> { æ‰§è¡Œé€»è¾‘ }``
- when æ¡ä»¶è¯­å¥å’Œ if æ¡ä»¶è¯­å¥ä¸€æ ·ï¼Œå½“æ¡ä»¶ä½“é‡Œé¢åªæœ‰ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œæ¡ä»¶ä½“çš„ {} å¯çœç•¥

```kotlin
//when ä¸­æœ‰å‚æ•°çš„æƒ…å†µ
fun getScore(name: String) = when (name) {
    "tom" -> 99
    "jim" -> 80
    "lucy" -> 70
    else -> 0
}

//when ä¸­æ— å‚æ•°çš„æƒ…å†µï¼ŒKotin ä¸­åˆ¤æ–­å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œç›´æ¥ä½¿ç”¨ == æ“ä½œç¬¦å³å¯
fun getScore(name: String) = when {
    name == "tom" -> 99
    name == "jim" -> 80
    name =="lucy" -> 70
    else -> 0
}
```

### å¾ªç¯è¯­å¥

ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§å¾ªç¯ï¼š

1. while å¾ªç¯ï¼Œè¿™ç§å¾ªç¯å’Œ Java æ²¡æœ‰ä»»ä½•åŒºåˆ«
2. for å¾ªç¯ï¼ŒJava ä¸­å¸¸ç”¨çš„å¾ªç¯æœ‰ï¼šfor-iï¼Œfor-eachï¼ŒKotlin ä¸­ä¸»è¦æ˜¯ï¼šfor-in

åŒºé—´

- ä½¿ç”¨ .. è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„å‡åºåŒºé—´
- ä½¿ç”¨ until è¡¨ç¤ºåˆ›å»ºå·¦ç«¯æ˜¯é—­åŒºé—´å³ç«¯æ˜¯å¼€åŒºé—´çš„å‡åºåŒºé—´
- ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´
- åœ¨åŒºé—´çš„åé¢åŠ ä¸Š step ï¼Œè¡¨ç¤ºè·³è¿‡å‡ ä¸ªå…ƒç´ 

```kotlin
//æ³¨æ„: Kotlin ä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­å¯ä»¥å¼•ç”¨å˜é‡ï¼Œåç»­è¿˜ä¼šè®²åˆ°
//æƒ…å†µ1
fun main() {
    //ä½¿ç”¨ .. è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„å‡åºåŒºé—´
    for (i in 0..10){
        print("$i ")
    }
}
//æ‰“å°ç»“æœ
0 1 2 3 4 5 6 7 8 9 10

//æƒ…å†µ2
fun main() {
    //ä½¿ç”¨ until è¡¨ç¤ºåˆ›å»ºå·¦ç«¯æ˜¯é—­åŒºé—´å³ç«¯æ˜¯å¼€åŒºé—´çš„å‡åºåŒºé—´
    for (i in 0 until 10){
        print("$i ")
    }
}
//æ‰“å°ç»“æœ
0 1 2 3 4 5 6 7 8 9

//æƒ…å†µ3
fun main() {
    //ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´
    for (i in 10 downTo 0){
        print("$i ")
    }
}
//æ‰“å°ç»“æœ
10 9 8 7 6 5 4 3 2 1 0

//æƒ…å†µ4
fun main() {
    //ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´,æ¯æ¬¡åœ¨è·³è¿‡3ä¸ªå…ƒç´ 
    for (i in 10 downTo 0 step 3){
        print("$i ")
    }
}
//æ‰“å°ç»“æœ
10 7 4 1 
```

## é¢å‘å¯¹è±¡ç¼–ç¨‹

### ç±»ä¸å¯¹è±¡

1. å½“æˆ‘ä»¬åœ¨ç±»ä¸­åˆ›å»ºå±æ€§çš„æ—¶å€™ï¼ŒKotlin ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º ``get`` å’Œ ``set`` æ–¹æ³•
2. Kotlin ä¸­å®ä¾‹åŒ–å¯¹è±¡å’Œ Java ç±»ä¼¼ï¼Œä½†æ˜¯æŠŠ ``new`` å…³é”®å­—ç»™å»æ‰äº†
3. ä¸€èˆ¬åœ¨ç±»ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨ ``var`` å…³é”®å­—å»å®šä¹‰ä¸€ä¸ªå±æ€§ï¼Œå› ä¸ºå±æ€§ä¸€èˆ¬æ˜¯å¯å˜çš„ï¼Œå¦‚æœä½ ç¡®å®šæŸä¸ªå±æ€§ä¸éœ€è¦æ”¹å˜ï¼Œåˆ™ç”¨ ``val``

```kotlin
class Person {
    var name = ""
    var age = 0

    fun sleep(){
        println("$name is sleep, He is $age years old.")
    }
}

fun main() {
    val person = Person()
    person.name = "erdai"
    person.age = 20
    person.sleep()
}
//æ‰“å°ç»“æœ
erdai is sleep, He is 20 years old.
```

### ç»§æ‰¿ä¸æ„é€ å‡½æ•°

#### ç»§æ‰¿

1. Kotlin ä¸­è§„å®šï¼Œå¦‚æœè¦å£°æ˜ä¸€ä¸ªéæŠ½è±¡ç±»å¯ç»§æ‰¿ï¼Œå¿…é¡»åŠ ä¸Š ``open`` å…³é”®å­—ï¼Œå¦åˆ™ä¸å¯ç»§æ‰¿ï¼Œè¿™ç‚¹å’Œ Java ä¸­ä¸åŒï¼ŒJava ä¸­çš„ç±»é»˜è®¤æ˜¯å¯è¢«ç»§æ‰¿çš„ï¼ŒEffective Java è¿™æœ¬ä¹¦ä¸­æåˆ°ï¼šå¦‚æœä¸€ä¸ªç±»ä¸æ˜¯ä¸“é—¨ä¸ºç»§æ‰¿è€Œè®¾è®¡çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä¸»åŠ¨å°†å®ƒåŠ ä¸Š final å£°æ˜ï¼Œç¦æ­¢ä»–å¯ä»¥è¢«ç»§æ‰¿
2. Kotlinä¸­çš„ç»§æ‰¿å’Œå®ç°éƒ½æ˜¯ç”¨ : è¡¨ç¤º

```kotlin
//å£°æ˜ Person ç±»å¯ä»¥è¢«ç»§æ‰¿
open class Person {
    var name = ""
    var age = 0
  
    fun sleep() {
        println("$name is sleep, He is $age years old.")
    }
}

//å®šä¹‰ Student ç»§æ‰¿ Person ç±»
//ä¸ºå•¥ Person åé¢ä¼šæœ‰ä¸€ä¸ªæ‹¬å·å‘¢ï¼Ÿå› ä¸ºå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨çˆ¶ç±»ä¸­çš„æ„é€ å‡½æ•°ï¼Œåœ¨ Java ä¸­ï¼Œå­ç±»çš„æ„é€ å‡½æ•°ä¼šéšå¼çš„å»è°ƒç”¨
class Student : Person(){
    
}
```

#### æ„é€ å‡½æ•°

1. ä¸»æ„é€ å‡½æ•°çš„ç‰¹ç‚¹æ˜¯æ²¡æœ‰å‡½æ•°ä½“ï¼Œç›´æ¥è·Ÿåœ¨ç±»åçš„åé¢å³å¯ï¼Œå¦‚æœéœ€è¦åœ¨ä¸»æ„é€ å‡½æ•°é‡Œé¢åšé€»è¾‘ï¼Œå¤å†™ ``init`` å‡½æ•°å³å¯
2. ä¸»æ„é€ å‡½æ•°ä¸­å£°æ˜æˆ ``val`` æˆ–è€… ``var`` çš„å‚æ•°å°†è‡ªåŠ¨æˆä¸ºè¯¥ç±»çš„å­—æ®µï¼Œå¦‚æœä¸åŠ ï¼Œé‚£ä¹ˆè¯¥å­—æ®µçš„ä½œç”¨åŸŸä»…é™å®šåœ¨ä¸»æ„é€ å‡½æ•°ä¸­
3. æ¬¡æ„é€ å‡½æ•°æ˜¯é€šè¿‡ ``constructor`` å…³é”®å­—æ¥å®šä¹‰çš„
4. å½“ä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºçš„å®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å®šä¹‰äº†æ¬¡æ„é€ å‡½æ•°æ—¶ï¼Œé‚£ä¹ˆè¢«ç»§æ‰¿çš„ç±»åé¢ä¸éœ€è¦åŠ  ()

```kotlin
//å®šä¹‰ Student ç±»ï¼Œå®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œå®šä¹‰å±æ€§ sno å’Œ grade, ç»§æ‰¿ Person ç±»
class Student(var sno: String, var grade: Int) : Person() {
        //åšä¸€äº›åˆå§‹åŒ–çš„é€»è¾‘
  	init {
        name = "erdai"
        age = 20
    }
    
    //å£°æ˜å¸¦ä¸€ä¸ªå‚æ•°çš„æ¬¡æ„é€ å‡½æ•°
    constructor(sno: String): this(sno,8){

    }

    //å£°æ˜ä¸€ä¸ªæ— å‚çš„æ¬¡æ„é€ å‡½æ•°
    constructor(): this("123",7){

    }

    fun printInfo(){
        println("I am $name, $age yeas old, sno: $sno, grade: $grade")
    }
}

fun main() {
    val student1 = Student()
    val student2 = Student("456")
    val student3 = Student("789",9)
    student1.printInfo()
    student2.printInfo()
    student3.printInfo()
}
//æ‰“å°ç»“æœ
I am erdai, 20 yeas old, sno: 123, grade: 7
I am erdai, 20 yeas old, sno: 456, grade: 8
I am erdai, 20 yeas old, sno: 789, grade: 9

//ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå½“ä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºçš„å®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å®šä¹‰äº†æ¬¡æ„é€ å‡½æ•°æ—¶ï¼Œé‚£ä¹ˆè¢«ç»§æ‰¿çš„ç±»åé¢ä¸éœ€è¦åŠ  ()
class Student : Person{
    constructor() : super(){
        
    }
}
```

### æ¥å£

Kotlin å’Œ Java ä¸­å®šä¹‰æ¥å£æ²¡æœ‰ä»»ä½•åŒºåˆ«

```kotlin
//å®šä¹‰æ¥å£ä¸­çš„ä¸€ç³»åˆ—çš„æŠ½è±¡è¡Œä¸º Kotlin ä¸­å¢åŠ äº†æ¥å£ä¸­å®šä¹‰çš„å‡½æ•°å¯ä»¥æœ‰é»˜è®¤å®ï¼Œå…¶å® Java åœ¨ JDK1.8 ä¹‹åä¹Ÿå¼€å§‹æ”¯æŒè¿™ä¸ªåŠŸèƒ½
interface Study{
     fun readBooks()
     //å¦‚æœå­ç±»æ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•,é‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„é»˜è®¤å®ç°
     fun doHomework(){
         println("do homework default implementation")
     }
}

//å®šä¹‰ä¸€ä¸ªå¯è¢«ç»§æ‰¿çš„ People ç±»ï¼Œæœ‰ name å’Œ age ä¸¤ä¸ªå±æ€§
open class People(val name: String,val age: Int){

}

//å®šä¹‰ä¸€ä¸ª Student ç±»ï¼Œç»§æ‰¿ People ç±»ï¼Œå®ç° Study æ¥å£
class Student(name: String, age: Int) : People(name, age),Study{
    override fun readBooks() {
        println("$name is read book")
    }
}

//å®šä¹‰çš„ä¸€ä¸ªæ–¹æ³• ç„¶ååœ¨mainå‡½æ•°è°ƒç”¨
fun doStudy(study: Study){
    study.readBooks()
    study.doHomework()
}

//mainå‡½æ•°è°ƒç”¨
fun main(){
    val student = Student("erdai",20)
    //è¿™é‡Œstudentå®ç°äº†Studyæ¥å£,è¿™ç§å«åšé¢å‘æ¥å£ç¼–ç¨‹,ä¹Ÿå¯ä»¥ç§°ä¸ºå¤šæ€
    doStydy(student)
}

//æ‰“å°ç»“æœ
erdai is read book
do homework default implementation
```

### å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦

| ä¿®é¥°ç¬¦    | Java                         | Kotlin               |
| --------- | ---------------------------- | -------------------- |
| public    | æ‰€æœ‰ç±»å¯è§                   | æ‰€æœ‰ç±»å¯è§(é»˜è®¤)     |
| private   | å½“å‰ç±»å¯è§                   | å½“å‰ç±»å¯è§           |
| protected | å½“å‰ç±»,å­ç±»,åŒä¸€ä¸ªåŒ…ä¸‹çš„å¯è§ | å½“å‰ç±»å’Œå­ç±»å¯è§     |
| default   | åŒä¸€ä¸ªåŒ…ä¸‹çš„å¯è§(é»˜è®¤)       | æ—                    |
| internal  | æ—                            | åŒä¸€ä¸ªæ¨¡å—ä¸­çš„ç±»å¯è§ |

### æ•°æ®ç±»ä¸å•ä¾‹ç±»

#### æ•°æ®ç±»

1. åœ¨ Java ä¸­ï¼Œæ•°æ®ç±»é€šå¸¸éœ€è¦é‡å†™ equals( )ï¼ŒhashCode( )ï¼ŒtoString( ) è¿™å‡ ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ equals( ) æ–¹æ³•ç”¨äºåˆ¤æ–­ä¸¤ä¸ªæ•°æ®ç±»æ˜¯å¦ç›¸ç­‰ã€‚hashCode( ) æ–¹æ³•ä½œä¸º equals( ) çš„é…å¥—æ–¹æ³•ï¼Œä¹Ÿéœ€è¦ä¸€èµ·é‡å†™ï¼Œå¦åˆ™ä¼šå¯¼è‡´ hash ç›¸å…³çš„ç³»ç»Ÿç±»æ— æ³•æ­£å¸¸å·¥ä½œï¼ŒtoString( ) æ–¹æ³•åˆ™ç”¨äºæä¾›æ›´æ¸…æ™°çš„è¾“å…¥æ—¥å¿—ï¼Œå¦åˆ™ä¸€ä¸ªæ•°æ®ç±»é»˜è®¤æ‰“å°å‡ºæ¥çš„æ˜¯ä¸€è¡Œå†…å­˜åœ°å€
2. åœ¨ Kotlin ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ ``data`` å…³é”®å­—å»ä¿®é¥°ä¸€ä¸ªç±»ï¼ŒKotlin å°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆ Java éœ€è¦é‡å†™çš„é‚£äº›æ–¹æ³•

```kotlin
//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå†™
public class Cellphone {
    
    String brand;
    double price;

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Cellphone cellphone = (Cellphone) o;
        return Double.compare(cellphone.price, price) == 0 &&
                Objects.equals(brand, cellphone.brand);
    }

    @Override
    public int hashCode() {
        return Objects.hash(brand, price);
    }

    @Override
    public String toString() {
        return "Cellphone{" +
                "brand='" + brand + '\'' +
                ", price=" + price +
                '}';
    }
}

//åœ¨ Kotlin ä¸­ï¼Œä½ ä¼šå‘ç°æ˜¯å¦‚æ­¤çš„ç®€æ´
data class Cellphone(val brand: String, val price: Double)
```

#### å•ä¾‹ç±»

1. Kotlin ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ ``object`` å…³é”®å­—å»æ›¿æ¢ ``class`` å…³é”®å­—å°±å¯ä»¥å»å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»äº†
2. è°ƒç”¨å•ä¾‹ç±»ä¸­çš„æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ç±»å . ä¸Šæ–¹æ³•å°±å¯ä»¥äº†ï¼Œç±»ä¼¼äº Java ä¸­çš„é™æ€æ–¹æ³•è°ƒç”¨æ–¹å¼

```kotlin
//javaä¸­å•ä¾‹ æ‡’æ±‰å¼
public class Singleton{
  	private static Singleton instance;
  
  	public synchronized static Singleton getInstace() {
      		if(instance == null){
            	instance = new Singleton();
          }
      		return instance;
    }
  
  	public void singleonTest(){
      	System.out.println("singletonTest in Java is called.");
    }
}

//Kotlinä¸­çš„å•ä¾‹
object Singleton{
  	fun singletonTest(){
      	println("singletonTest in Kotlin is called.")
    }
}

fun main() {
    Singleton.singletonTest()
}
//æ‰“å°ç»“æœ
singletonTest in Kotlin is called.
```

## Lambda ç¼–ç¨‹

Kotlin ä»ç¬¬ä¸€ä¸ªç‰ˆæœ¬å°±å¼€å§‹æ”¯æŒäº† Lambda ç¼–ç¨‹ï¼Œå¹¶ä¸” Kotlin ä¸­çš„ Lambda è¡¨è¾¾å¼æä¸ºå¼ºå¤§ï¼Œæœ¬ç« æˆ‘ä»¬å­¦ä¹  Lambda ç¼–ç¨‹çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼š

1. ç®€å•æ¥è¯´ï¼ŒLambda å°±æ˜¯ä¸€æ®µå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’çš„ä»£ç ï¼Œå®ƒå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡
2. Lambda å®Œæ•´çš„è¡¨è¾¾å¼çš„è¯­æ³•ç»“æ„ï¼š``{ å‚æ•°å1ï¼šå‚æ•°ç±»å‹ï¼Œå‚æ•°å2ï¼šå‚æ•°ç±»å‹ -> å‡½æ•°ä½“ }``
3. å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç®€åŒ–å½¢å¼çš„è¯­æ³•ç»“æ„ï¼Œç›´æ¥å°±æ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼š{å‡½æ•°ä½“}ï¼Œè¿™ç§æƒ…å†µæ˜¯å½“ Lambda è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‚æ•°ç»™çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°
4. Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢
5. Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥

### é›†åˆçš„åˆ›å»ºå’Œéå†

1. ä¸å¯å˜é›†åˆï¼šåœ¨é›†åˆåˆå§‹åŒ–ä¹‹åï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹å…¶è¿›è¡Œå¢åˆ æ”¹æ“ä½œ
2. å¯å˜é›†åˆï¼šåœ¨é›†åˆåˆå§‹åŒ–ä¹‹åï¼Œæˆ‘ä»¬è¿˜èƒ½å¯¹å…¶è¿›è¡Œå¢åˆ æ”¹æ“ä½œ

| ä¸å¯å˜é›†åˆ | å¯å˜é›†åˆ      |
| ---------- | ------------- |
| listOf     | mutableListOf |
| setOf      | mutableSetOf  |
| mapOf      | mutableMapOf  |

```kotlin
//List é›†åˆ 
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ List é›†åˆ
val list1 = listOf("Apple","Banana","Orange","Pear","Grape")
//å®šä¹‰ä¸€ä¸ªå¯å˜ List é›†åˆ
val list2 = mutableListOf("Apple","Banana","Orange","Pear","Grape")
//æ·»åŠ å…ƒç´ 
list2.add("Watermelon")
for (i in list2) {
    print("$i ")
}
//æ‰“å°ç»“æœ
Apple Banana Orange Pear Grape Watermelon

//Set é›†åˆå’Œ List é›†åˆç”¨æ³•å®Œå…¨ä¸€æ ·
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Set é›†åˆ
val set1 = setOf("Apple","Banana","Orange","Pear","Grape")
//å®šä¹‰ä¸€ä¸ªå¯å˜ Set é›†åˆ
val set2 = mutableSetOf("Apple","Banana","Orange","Pear","Grape")
//æ·»åŠ å…ƒç´ 
set2.add("Watermelon")
for (i in set2) {
    print("$i ")
}
//æ‰“å°ç»“æœ
Apple Banana Orange Pear Grape Watermelon

//Map é›†åˆ
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Map é›†åˆ
val map1 = mapOf("Apple" to 1,"Banana" to 2,"Orange" to 3, "Pear" to 4,"Grape" to 5)
//å®šä¹‰ä¸€ä¸ªå¯å˜ Map é›†åˆ
val map2 = mutableMapOf("Apple" to 1,"Banana" to 2,"Orange" to 3, "Pear" to 4,"Grape" to 5)
//å½“å‰ key å­˜åœ¨åˆ™ä¿®æ”¹å…ƒç´ ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ å…ƒç´ 
map2["Watermelon"] = 6
for ((key,value) in map2) {
    print("$key: $value ")
}
//æ‰“å°ç»“æœ
```

### é›†åˆçš„å‡½æ•°å¼ API

```kotlin
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ List é›†åˆ
val list1 = listOf("Apple","Banana","Orange","Pear","Grape","Watermelon")
//ç°åœ¨æˆ‘æƒ³æ‰“å°é›†åˆä¸­è‹±æ–‡åå­—æœ€é•¿çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåš
//æ–¹å¼1
var maxLengthFruit = ""
for (fruit in list1) {
    if(fruit.length > maxLengthFruit.length){
        maxLengthFruit = fruit
    }
}
print(maxLengthFruit)
//æ‰“å°ç»“æœ
Watermelon

//ä½†æ˜¯å¦‚æœä½¿ç”¨å‡½æ•°å¼ Api å°†ä¼šå˜å¾—æ›´åŠ ç®€å•, maxBy å‡½æ•°ä¼šæ ¹æ®ä½ çš„æ¡ä»¶éå†å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„æœ€å¤§å€¼
//æ–¹å¼2
val maxLengthFruit = list1.maxBy {
    it.length
}
print(maxLengthFruit)
//æ‰“å°ç»“æœ
Watermelon

//é€šè¿‡ maxBy å‡½æ•°ç»“åˆ Lambda è¡¨è¾¾å¼è¯­æ³•ç»“æ„ï¼Œæˆ‘ä»¬æ¥å‰–ææ–¹å¼2è¿™ç§å†™æ³•çš„åŸç†, å¦‚ä¸‹æ‰€ç¤º
//1
val list1 = listOf("Apple","Banana","Orange","Pear","Grape","Watermelon")
val lambda = {fruit: String -> fruit.length}
//maxBy å‡½æ•°å®é™…ä¸Šæ¥æ”¶çš„æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œåç»­è®²é«˜é˜¶å‡½æ•°çš„æ—¶å€™ä¼šè®²åˆ°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª Lambda è¡¨è¾¾å¼
val maxLengthFruit = list1.maxBy(lambda)

//2 æ›¿æ¢ lambda
val maxLengthFruit = list1.maxBy({fruit: String -> fruit.length})

//3 Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢
val maxLengthFruit = list1.maxBy(){fruit: String -> fruit.length}

//4 Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥
val maxLengthFruit = list1.maxBy{fruit: String -> fruit.length}

//5 å½“ Lambda è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‚æ•°ç»™çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°
val maxLengthFruit = list1.maxBy{ it.length }

//ç»è¿‡ä¸Šé¢ 1->2->3->4->5 è¿™å‡ ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº† 5 çš„è¿™ç§å†™æ³•
```

é›†åˆä¸­è¿˜æœ‰å¾ˆå¤šè¿™æ ·çš„å‡½æ•°å¼ Apiï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ list é›†åˆæ¥å®è·µä¸€ä¸‹å…¶ä»–çš„ä¸€äº›å‡½æ•°å¼ Apiï¼š

```kotlin
val list = listOf("Apple","Banana","Orange","Pear","Grape","Watermelon")
//1
//é€šè¿‡ map æ“ä½œï¼ŒæŠŠä¸€ä¸ªå…ƒç´ æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ 
val newList = list.map{
    it.toUpperCase()
}
for (s in newList) {
    print("$s ")
}
//æ‰“å°ç»“æœ
APPLE BANANA ORANGE PEAR GRAPE WATERMELON 

//2
//é€šè¿‡ filter ç­›é€‰æ“ä½œï¼Œç­›é€‰é•¿åº¦å°äºç­‰äº5çš„å­—ç¬¦ä¸²
val newList = list.filter {
    it.length <= 5
}
for (s in newList) {
    print("$s ")
}
//æ‰“å°ç»“æœ
Apple Pear Grape
```

### Java å‡½æ•°å¼ API çš„ä½¿ç”¨

1. Kotlin ä¸­è°ƒç”¨ Java æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°å¼ Api ,ä½†å¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š1ã€å¾—æ˜¯ç”¨ Java ç¼–å†™çš„æ¥å£ 2ã€æ¥å£ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•
2. Kotlin ä¸­å†™åŒ¿åå†…éƒ¨ç±»å’Œ Java æœ‰ä¸€ç‚¹åŒºåˆ«ï¼ŒKotlin ä¸­å› ä¸ºæŠ›å¼ƒäº† ``new`` å…³é”®å­—ï¼Œæ”¹ç”¨ ``object`` å…³é”®å­—å°±å¯ä»¥äº†

```kotlin
//java ä¸­çš„åŒ¿åå†…éƒ¨ç±»
new Thread(new Runnable() {
     @Override
     public void run() {

     }
}).start();

//Kotlin ä¸­å¯ä»¥è¿™ä¹ˆå†™
Thread(object : Runnable{
    override fun run() {
            
    }
}).start()

/**
 * æˆ‘ä»¬æ¥ç€æ¥ç®€åŒ– Kotlin ä¸­çš„å†™æ³•
 * å› ä¸º Runnable ç±»ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°æ–¹æ³•ï¼Œå³ä½¿è¿™é‡Œæ²¡æœ‰æ˜¾ç¤ºçš„é‡å†™ run() æ–¹æ³•ï¼Œ
 * Kotlin ä¹Ÿèƒ½æ˜ç™½åé¢çš„ Lambda è¡¨è¾¾å¼å°±æ˜¯è¦åœ¨ run() æ–¹æ³•ä¸­å®ç°çš„å†…å®¹
 */
Thread(Runnable{
  
}).start()

//å› ä¸ºæ˜¯å•æŠ½è±¡æ–¹æ³•æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¥å£åè¿›è¡Œçœç•¥
Thread({
  
}).start()

//å½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢
Thread(){
  
}.start()

//å½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥
Thread{
  
}.start()
```

## ç©ºæŒ‡é’ˆæ£€æŸ¥

Android ç³»ç»Ÿä¸Šå¥”æºƒæœ€é«˜çš„å¼‚å¸¸å°±æ˜¯ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆNullPointerExceptionï¼‰ï¼Œé€ æˆè¿™ç§ç°è±¡çš„ä¸»è¦åŸå› æ˜¯å› ä¸ºç©ºæŒ‡é’ˆæ˜¯ä¸€ç§ä¸å—ç¼–ç¨‹è¯­è¨€æ£€æŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸ï¼Œåªèƒ½ç”±ç¨‹åºå‘˜ä¸»åŠ¨é€šè¿‡é€»è¾‘åˆ¤æ–­æ¥é¿å…ï¼Œä½†å³ä½¿åœ¨å‡ºè‰²çš„ç¨‹åºå‘˜ï¼Œä¹Ÿä¸å¯èƒ½å°†æ‰€æœ‰æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸éƒ½è€ƒè™‘åˆ°ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µåœ¨ Kotlin ä¸Šå¾—åˆ°äº†å¾ˆå¥½çš„è§£å†³ï¼ŒKotlin æŠŠç©ºæŒ‡é’ˆå¼‚å¸¸æå‰åˆ°äº†ç¼–è¯‘æœŸå»æ£€æŸ¥ï¼Œè¿™æ ·çš„åšæ³•å‡ ä¹æœç»äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œä½†æ˜¯è¿™æ ·å­ä¼šå¯¼è‡´ä»£ç å˜å¾—æ¯”è¾ƒéš¾å†™ï¼Œä¸è¿‡ Kotlin æä¾›äº†ä¸€ç³»åˆ—çš„è¾…åŠ©å·¥å…·ï¼Œè®©æˆ‘ä»¬èƒ½è½»æ¾çš„å¤„ç†å„ç§åˆ¤ç©ºçš„æƒ…å†µï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å­¦ä¹ å®ƒ

### å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·

1. åœ¨ç±»å‹åé¢åŠ ä¸Š ? ï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹ï¼ŒKotlin é»˜è®¤æ‰€æœ‰çš„å‚æ•°å’Œå˜é‡ä¸å¯ä¸ºç©º
2. åœ¨å¯¹è±¡è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸ºç©ºåˆ™è°ƒç”¨ï¼Œä¸ºç©ºåˆ™ä»€ä¹ˆéƒ½ä¸åš
3. ?: æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå·¦è¾¹çš„ç»“æœä¸ä¸ºç©ºï¼Œè¿”å›å·¦è¾¹çš„ç»“æœï¼Œå¦åˆ™è¿”å›å³è¾¹çš„ç»“æœ
4. åœ¨å¯¹è±¡åé¢åŠ  !! æ“ä½œç¬¦è¡¨ç¤ºå‘Šè¯‰Kotlinæˆ‘è¿™é‡Œä¸€å®šä¸ä¼šä¸ºç©º,ä½ ä¸ç”¨è¿›è¡Œæ£€æµ‹äº†ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸
5. let å‡½æ•°ï¼Œæä¾›å‡½æ•°å¼ Apiï¼Œå¹¶æŠŠå½“å‰è°ƒç”¨çš„å¯¹è±¡å½“ä½œå‚æ•°ä¼ é€’åˆ° Lambda è¡¨è¾¾å¼ä¸­

æƒ…å†µ1ï¼š åœ¨ç±»å‹åé¢åŠ ä¸Š ? ï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹ï¼ŒKotlin é»˜è®¤æ‰€æœ‰çš„å‚æ•°å’Œå˜é‡ä¸å¯ä¸ºç©º

```kotlin
interface Study{
    fun readBooks()
    fun domeHomework(){
        println("do homework default implementation")
    }
}

fun doStudy(study: Study){
    study.readBooks()
    study.domeHomework()
}
```

ä¸Šé¢è¿™æ®µä»£ç æ˜¯ä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸çš„ï¼Œå¦‚æœä½ å°è¯•å‘ doStudy è¿™ä¸ªæ–¹æ³•ä¼ é€’ä¸€ä¸ª null ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š

å› æ­¤è¿™ç§æƒ…å†µæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¯ç©ºç±»å‹ï¼ŒæŠŠ Study æ”¹æˆ Studyï¼Ÿï¼Œå¦‚ä¸‹å›¾ï¼š
![Alt text](image-1.png)
ä½ ä¼šå‘ç°è™½ç„¶è°ƒç”¨ doStudy æ–¹æ³•ä¸æŠ¥é”™äº†ï¼Œä½†æ˜¯ doStudy å†…éƒ¨çš„è°ƒç”¨å´æŠ¥é”™äº†ï¼Œå› ä¸ºæ­¤æ—¶ doStudy æ¥å—ä¸€ä¸ªå¯ç©ºçš„ç±»å‹å‚æ•°ï¼Œå¯èƒ½ä¼šé€ æˆå†…éƒ¨çš„ç©ºæŒ‡é’ˆï¼Œ Kotlin ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æƒ…å†µå­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹æ”¹é€ å°±å¥½äº†ï¼š

```kotlin
fun doStudy(study: Study?){
    if(study != null){
        study.readBooks()
        study.domeHomework()
    }
}
```

æƒ…å†µ2ï¼š åœ¨å¯¹è±¡è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸ºç©ºåˆ™è°ƒç”¨ï¼Œä¸ºç©ºåˆ™ä»€ä¹ˆéƒ½ä¸åš
é’ˆå¯¹ä¸Šé¢çš„ doStudy æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™ä¹ˆåšï¼š

```kotlin
fun doStudy(study: Study?){
    study?.readBooks()
    study?.domeHomework()
}
```

æƒ…å†µ3ï¼š ?: æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå·¦è¾¹çš„ç»“æœä¸ä¸ºç©ºï¼Œè¿”å›å·¦è¾¹çš„ç»“æœï¼Œå¦åˆ™è¿”å›å³è¾¹çš„ç»“æœ

```kotlin
//å¹³æ—¶æˆ‘ä»¬å¯èƒ½å†™è¿™æ ·çš„ä»£ç 
val a = if (b != null) {
    b
} else {
    c
}

//ä½¿ç”¨ ?: æ“ä½œç¬¦å¯ä»¥ç®€åŒ–æˆè¿™æ ·
val a = b ?: c
```

æƒ…å†µ4ï¼š åœ¨å¯¹è±¡åé¢åŠ  !! æ“ä½œç¬¦è¡¨ç¤ºå‘Šè¯‰Kotlinæˆ‘è¿™é‡Œä¸€å®šä¸ä¼šä¸ºç©º,ä½ ä¸ç”¨è¿›è¡Œæ£€æµ‹äº†ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸

```kotlin
//ä¸‹é¢è¿™æ®µä»£ç ç¼–è¯‘é€šä¸è¿‡ï¼Œå› ä¸º printName æ–¹æ³•é‡Œçš„ name å¹¶ä¸çŸ¥é“ä½ åœ¨å¤–é¢åšäº†éç©ºåˆ¤æ–­
val name: String? = "erdai"

fun printName(){
    val upperCaseName = name.toUpperCase()
    print(upperCaseName)
}

fun main() {
    if(name != null){
       printName()
    }
}

//å› æ­¤åœ¨ä¸Šé¢è¿™ç§æ˜ç¡®ä¸ä¼šä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ !! æ“ä½œç¬¦ï¼Œæ”¹é€ ä¸€ä¸‹ printName æ–¹æ³•
//åŒæ—¶è¦æé†’ä¸€ä¸‹è‡ªå·±ï¼Œæ˜¯å¦å­˜åœ¨æ›´å¥½çš„å®ç°æ–¹å¼ï¼Œå› ä¸ºä½¿ç”¨è¿™ç§æ“ä½œç¬¦ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸
fun printName(){
    val upperCaseName = name!!.toUpperCase()
    print(upperCaseName)
}
//æ‰“å°ç»“æœ
ERDAI
```

æƒ…å†µ5ï¼š let å‡½æ•°ï¼Œæä¾›å‡½æ•°å¼ Apiï¼Œå¹¶æŠŠå½“å‰è°ƒç”¨çš„å¯¹è±¡å½“ä½œå‚æ•°ä¼ é€’åˆ° Lambda è¡¨è¾¾å¼ä¸­

```kotlin
//è¿™æ˜¯æˆ‘ä»¬æƒ…å†µ2 å®ç°çš„æ–¹å¼ï¼Œä½†æ˜¯å¦‚æœè¿™ç§è°ƒç”¨æ–¹å¼ä¸€å¤šï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«å•°å—¦ï¼Œä¾‹å¦‚ï¼š
fun doStudy(study: Study?){
    study?.readBooks()
    study?.domeHomework()
    study?.a()
    study?.b()
}
//ä¸Šé¢è¿™ç§æƒ…å†µç­‰åŒäºå¦‚ä¸‹ä»£ç :
fun doStudy(study: Study?){
    if(study != null){
      	study?.readBooks()
    }
  
    if(study != null){
     	study?.domeHomework()
    }
  
    if(study != null){
     	study?.a()
    }
  
    if(study != null){
      	study?.b()
    }
}

//è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ let å‡½æ•°æ¥æ“ä½œäº†
fun doStudy(study: Study?){
    study?.let{
      it.readBooks()
      it.domeHomework()
      it.a()
      it.b()
    }
}
```

## Kotlinä¸­çš„å°é­”æœ¯

### å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼

1. Kotlin ä¸­ï¼Œå­—ç¬¦ä¸²é‡Œé¢å¯ä»¥ä½¿ç”¨ ${} å¼•ç”¨å˜é‡å€¼å’Œè¡¨è¾¾å¼ï¼Œå½“ {} é‡Œé¢åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œéè¡¨è¾¾å¼æ—¶ï¼Œ{}ä¹Ÿå¯ä»¥å»æ‰
 
```kotlin
fun main() {
    val a = "erdai"
    val b = "666"
    print("$a ${a + b}")
}
//æ‰“å°ç»“æœ
erdai erdai666
```

### å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼

1. å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡½æ•°çš„å‚æ•°æ·»åŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±ä¸éœ€è¦å»ä¼ é‚£ä¸ªå‚æ•°
2. åœ¨æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ key value çš„å½¢å¼æ¥ä¼ å‚

```kotlin
//æƒ…å†µ1ï¼šå®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡½æ•°çš„å‚æ•°æ·»åŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±ä¸éœ€è¦å»ä¼ é‚£ä¸ªå‚æ•°
fun printParams(name: String,age: Int = 20){
    print("I am $name, $age years old.")
}

fun main() {
    printParams("erdai")
}
//æ‰“å°ç»“æœ
I am erdai, 20 years old.

//å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©è¦†ç›–é»˜è®¤å‚æ•°
fun main() {
    printParams("erdai",25)
}
//æ‰“å°ç»“æœ
I am erdai, 25 years old.

//æƒ…å†µ2ï¼šåœ¨æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ key value çš„å½¢å¼æ¥ä¼ å‚
fun main() {
    //æ³¨æ„ printParams æ–¹æ³•çš„ä¸€ä¸ªå‚æ•°æ˜¯ name ,ç¬¬äºŒä¸ªæ‰æ˜¯ age, ä½†æ˜¯é€šè¿‡ key value çš„å½¢å¼æ¥ä¼ å‚å°±ä¸ä¼šå‡ºç°å‚æ•°é¡ºåºé—®é¢˜
    printParams(age = 19,name = "erdai666")
}
//æ‰“å°ç»“æœ
I am erdai666, 19 years old.
```

> å°æŠ€å·§ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼æ¥ä»£æ›¿æ¬¡æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ä¸»æ„é€ å‡½æ•°å°±å¥½äº†

## æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•

### æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun å’Œ apply

1. let å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸ºå½“å‰è°ƒç”¨è€…ï¼Œä¸”**æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼**
2. also å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸ºå½“å‰è°ƒç”¨è€…ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯å½“å‰è°ƒç”¨å¯¹è±¡æœ¬èº«
3. with å‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºä»»æ„ç±»å‹å‚æ•°ï¼Œç¬¬äºŒä¸ªä¸º Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ç¬¬ä¸€ä¸ªå‚æ•°çš„ä¸Šä¸‹æ–‡ this ï¼Œä¸”**æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼**
4. run å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰å½“å‰è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this ï¼Œä¸”**æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼**
5. apply å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰å½“å‰è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯å½“å‰è°ƒç”¨å¯¹è±¡æœ¬èº«

> æ³¨æ„ï¼šåœ¨Lambda è¡¨è¾¾å¼ä¸­ï¼Œæ‹¥æœ‰å¯¹è±¡çš„ä¸Šä¸‹æ–‡ thisï¼Œå’Œæ‹¥æœ‰è¯¥å¯¹è±¡æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ this å¯çœç•¥ï¼Œè€Œæ‹¥æœ‰è¯¥å¯¹è±¡æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å‚æ•°åï¼Œå¦‚æœä¸å†™è¯¥å‚æ•°ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°

ä¸‹é¢é€šè¿‡ä»£ç æ¥æ„Ÿå—ä¸€ä¸‹ï¼š

```kotlin
/**
 * æƒ…å†µ1ï¼šlet å‡½æ•°
 * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ let å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸º StringBuilder å¯¹è±¡
 * 2ã€å½“ Lambda è¡¨è¾¾å¼ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it çš„å‚æ•°ï¼Œè¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­æœ€åä¸€è¡Œä»£ç 
 */
fun main() {
    val name = "erdai"
    val age = 20
    val returnValue = StringBuilder().let {
        it.append(name).append(" ").append(age)
    }
    println(returnValue)
}
//æ‰“å°ç»“æœ
erdai 20

/**
 * æƒ…å†µ2ï¼šalso å‡½æ•°
 * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ also å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸º StringBuilder å¯¹è±¡
 * 2ã€å½“ Lambda è¡¨è¾¾å¼ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it çš„å‚æ•°ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿”å›è°ƒç”¨å¯¹è±¡æœ¬èº«
 */
fun main() {
    val name = "erdai"
    val age = 20
    val stringBuilder = StringBuilder().also {
        it.append(name).append(" ").append(age)
    }
    println(stringBuilder.toString())
}
//æ‰“å°ç»“æœ
erdai 20

/**
 * æƒ…å†µ3ï¼šwith å‡½æ•°
 * 1ã€æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º StringBuilder å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º Lambda è¡¨è¾¾å¼ï¼Œ
 * 2ã€Lambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this, è¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç 
 */
fun main() {
    val name = "erdai"
    val age = 20
    val returnValue = with(StringBuilder()) {
        append(name).append(" ").append(age)
    }
    println(returnValue)
}
//æ‰“å°ç»“æœ
erdai 20

/**
 * æƒ…å†µ4ï¼šrun å‡½æ•°
 * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ also å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this
 * 2ã€è¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç 
 */
fun main() {
    val name = "erdai"
    val age = 20

    val returnValue = StringBuilder().run {
        append(name).append(" ").append(age)
    }
    println(returnValue)
}
//æ‰“å°ç»“æœ
erdai 20

/**
 * æƒ…å†µ5ï¼šapply å‡½æ•°
 * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ apply å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this
 * 2ã€æ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿”å›è°ƒç”¨å¯¹è±¡æœ¬èº«
 */
fun main() {
    val name = "erdai"
    val age = 20

    val stringBuilder = StringBuilder().apply {
        append(name).append(" ").append(age)
    }
    println(stringBuilder.toString())
}
//æ‰“å°ç»“æœ
erdai 20
```

å…¶å®ä¸Šé¢ 5 ä¸ªæ ‡å‡†å‡½æ•°æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œæˆ‘ä»¬éœ€ææ¸…æ¥šå®ƒä»¬å·®å¼‚ä¹‹å¤„ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå›¾è¡¨æ¥æ€»ç»“ä¸€ä¸‹ï¼š
| æ ‡å‡†å‡½æ•° | å‡½æ•°å‚æ•° | æ˜¯å¦æ˜¯æ‰©å±•å‡½æ•° | è¿”å›å€¼       |
| -------- | -------- | -------------- | ------------ |
| T.let    | it       | æ˜¯             | æœ€åä¸€è¡Œä»£ç  |
| T.also   | it       | æ˜¯             | å¯¹è±¡æœ¬èº«     |
| T.with   | this     | å¦             | æœ€åä¸€è¡Œä»£ç  |
| T.run    | this     | æ˜¯             | æœ€åä¸€è¡Œä»£ç  |
| T.apply  | this     | æ˜¯             | å¯¹è±¡æœ¬èº«     |

### å®šä¹‰é™æ€æ–¹æ³•

Kotlin ä¸­æ²¡æœ‰ç›´æ¥æä¾›å®šä¹‰ä¸ºé™æ€æ–¹æ³•çš„å…³é”®å­—ï¼Œä½†æ˜¯æä¾›äº†ä¸€äº›ç±»ä¼¼çš„è¯­æ³•ç‰¹æ€§æ¥æ”¯æŒé™æ€æ–¹æ³•è°ƒç”¨çš„å†™æ³•

1. ä½¿ç”¨ companion object ä¸ºä¸€ä¸ªç±»åˆ›å»ºä¸€ä¸ªä¼´ç”Ÿç±»ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªä¼´ç”Ÿç±»çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸å«é™æ€æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥å½“ä½œé™æ€æ–¹æ³•è°ƒç”¨
2. ä½¿ç”¨ ``object`` å…³é”®å­—å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»ï¼Œé€šè¿‡å•ä¾‹ç±»ï¼Œå»è°ƒç”¨æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿä¸å«é™æ€æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥å½“ä½œé™æ€æ–¹æ³•è°ƒç”¨
3. å¦‚æœæƒ³å®šä¹‰çœŸæ­£çš„é™æ€æ–¹æ³•ï¼ŒKotlin ä¸­ä¹Ÿæä¾›äº†ä¸¤ç§æ–¹å¼ï¼š1ã€ä½¿ç”¨ @JvmStatic æ³¨è§£ï¼Œä¸”æ³¨è§£åªèƒ½åŠ åœ¨ä¼´ç”Ÿç±»å’Œå•ä¾‹ç±»ä¸Šçš„æ–¹æ³•ä¸Šé¢  2ã€å®šä¹‰é¡¶å±‚æ–¹æ³•
4. é¡¶å±‚æ–¹æ³•å°±æ˜¯ä¸å®šä¹‰åœ¨ä»»ä½•ç±»ä¸­çš„æ–¹æ³•ï¼Œé¡¶å±‚æ–¹æ³•åœ¨ä»»ä½•ä½ç½®éƒ½èƒ½è¢«è°ƒç”¨åˆ°ï¼ŒKotlin ç¼–è¯‘å™¨ä¼šæŠŠæ‰€æœ‰çš„é¡¶å±‚æ–¹æ³•ç¼–è¯‘æˆé™æ€æ–¹æ³•
5. å¦‚æœåœ¨ Java ä¸­è°ƒç”¨é¡¶å±‚æ–¹æ³•ï¼ŒJava é»˜è®¤æ˜¯æ²¡æœ‰é¡¶å±‚æ–¹æ³•çš„æ¦‚å¿µçš„ï¼ŒKotlin ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªæˆ‘ä»¬å®šä¹‰è¿™ä¸ªæ–‡ä»¶çš„ Java ç±»ï¼Œä¾‹å¦‚æˆ‘åœ¨ Kotlin ä¸­çš„ Util.kt æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªé¡¶å±‚æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆä¸€ä¸ª UtilKt çš„ Java ç±»ä¾›åœ¨ Java ä¸­è°ƒç”¨
6. åœ¨ Kotlin ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ å•ä¾‹ï¼Œä¼´ç”Ÿç±»å’Œé¡¶å±‚æ–¹æ³•ï¼Œ@JvmStatic æ³¨è§£ç”¨çš„æ¯”è¾ƒå°‘

```kotlin
//åœ¨ Java ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•
public class Util {
  
    public static void doAction(){
        System.out.println("do something");
    }
}

//Kotlin ä¸­ç±»ä¼¼è¿™æ ·é™æ€è°ƒç”¨å¤šç§å¤šæ ·
//æƒ…å†µ1ï¼šä½¿ç”¨ companion object ä¸ºä¸€ä¸ªç±»åˆ›å»ºä¸€ä¸ªä¼´ç”Ÿç±»
fun main() {
   Util.doAction()
}

class Util{
    companion object{
        fun doAction(){
            println("do something")
        }
    }
}
//æ‰“å°ç»“æœ
do something

//æƒ…å†µ2ï¼šä½¿ç”¨ object å…³é”®å­—å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»
fun main() {
   Util.doAction()
}

object Util {

    fun doAction() {
        println("do something")
    }
}
//æ‰“å°ç»“æœ
do something

//æƒ…å†µ3ï¼š1ã€ä½¿ç”¨ @JvmStatic æ³¨è§£ 2ã€å®šä¹‰é¡¶å±‚æ–¹æ³•
//1
//å•ä¾‹ç±»
object Util {
  
    @JvmStatic
    fun doAction() {
        println("do something")
    }
}

//ä¼´ç”Ÿç±»
class Util {
  
    companion object{
        fun doAction() {
            println("do something")
        }
    }
}

//2 ä½¿ç”¨ AndroidStudio æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å¼¹æ¡†ä¸­é€‰æ‹© File å³å¯ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ª File ä¸­ç¼–å†™ä¸€ä¸ªé¡¶å±‚æ–¹æ³•
//é¡¶å±‚æ–¹æ³•åœ¨ä»»ä½•ä½ç½®éƒ½èƒ½è°ƒç”¨åˆ°
fun doAction(){
    println("do something")
}
```

ä¸Šè¿°ä»£ç å¤§å®¶å¯ä»¥å°† Kotlin æ–‡ä»¶è½¬æ¢æˆ Java æ–‡ä»¶çœ‹ä¸€ä¸‹ï¼Œä½ å°±ä¼šå‘ç°å®šä¹‰çœŸæ­£çš„é™æ€æ–¹æ³•å’Œéé™æ€æ–¹æ³•çš„åŒºåˆ«

## å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»

### å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–

1. ä½¿ç”¨ lateinit å…³é”®å­—å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–

ä½¿ç”¨  lateinit å…³é”®å­—æ³¨æ„äº‹é¡¹ï¼š

- åªèƒ½ä½œç”¨äº var å±æ€§ï¼Œä¸”è¯¥å±æ€§æ²¡æœ‰è‡ªå®šä¹‰ get å’Œ set æ–¹æ³•
- è¯¥å±æ€§å¿…é¡»æ˜¯éç©ºç±»å‹ï¼Œä¸”ä¸èƒ½æ˜¯åŸç”Ÿç±»å‹
- å½“ä½ å¯¹ä¸€ä¸ªå˜é‡ä½¿ç”¨äº† ``lateinit`` å…³é”®å­—ï¼ŒKotlin ç¼–è¯‘å™¨å°±ä¸ä¼šåœ¨å»æ£€æŸ¥è¿™ä¸ªå˜é‡æ˜¯å¦ä¼šä¸ºç©ºäº†ï¼Œæ­¤æ—¶ä½ è¦ç¡®ä¿å®ƒåœ¨è¢«è°ƒç”¨ä¹‹å‰å·²ç»åˆå§‹åŒ–äº†ï¼Œå¦åˆ™ç¨‹åºè¿è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå¯ä»¥ä½¿ç”¨ ``::object.isInitialized`` è¿™ç§å›ºå®šçš„è¯­æ³•ç»“æ„åˆ¤æ–­å˜é‡æ˜¯å¦å·²ç»åˆå§‹åŒ–

2. ä½¿ç”¨ by lazy å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–

ä½¿ç”¨ by lazy æ³¨æ„äº‹é¡¹ï¼š

- åªèƒ½ä½œç”¨äº val å±æ€§

```kotlin
//æƒ…å†µ1ï¼šä½¿ç”¨ lateinit å…³é”®å­—å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–
lateinit var name: String

fun main() {
   name = "erdai"
   println(name)
}
//æ‰“å°ç»“æœ
erdai

//æƒ…å†µ2: ä½¿ç”¨ ::object.isInitialized è¿™ç§å›ºå®šçš„è¯­æ³•ç»“æ„åˆ¤æ–­å˜é‡æ˜¯å¦å·²ç»åˆå§‹åŒ–
lateinit var name: String

fun main() {
    if(::name.isInitialized){
        println(name)
    }else{
        println("name not been initialized")
    }
}
//æ‰“å°ç»“æœ
name not been initialized

//æƒ…å†µ3: ä½¿ç”¨ by lazy å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–
//ç‰¹ç‚¹ï¼šè¯¥å±æ€§è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼Œä¸” lazy åé¢çš„ Lambda è¡¨è¾¾å¼åªä¼šæ‰§è¡Œä¸€æ¬¡
val name: String by lazy {
    "erdai"
}

fun main() {
    println(name)
}
//æ‰“å°ç»“æœ
erdai
```

### ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç 

å¯†å°ç±»èƒ½ä½¿æˆ‘ä»¬å†™å‡ºæ›´åŠ è§„èŒƒå’Œå®‰å…¨çš„ä»£ç 

1. ä½¿ç”¨ ``sealed class`` å®šä¹‰ä¸€ä¸ªå¯†å°ç±»
2. å¯†å°ç±»åŠå…¶å­ç±»ï¼Œåªèƒ½å®šä¹‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶çš„é¡¶å±‚ä½ç½®
3. å¯†å°ç±»å¯è¢«ç»§æ‰¿
4. å½“æˆ‘ä»¬ä½¿ç”¨æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼Œéœ€è¦å®ç°å¯†å°ç±»æ‰€æœ‰å­ç±»çš„æƒ…å†µï¼Œé¿å…å†™å‡ºæ°¸è¿œä¸ä¼šæ‰§è¡Œçš„ä»£ç 

```kotlin
//åœ¨ä½¿ç”¨å¯†å°ç±»ä¹‹å‰æˆ‘ä»¬å¯èƒ½ä¼šå†™å‡ºè¿™ç§ä»£ç 
interface Result
class Success : Result
class Failure : Result

/**
 * é‚£ä¹ˆæ­¤æ—¶å¦‚æœæˆ‘æ–°å¢ä¸€ä¸ªç±»å®ç° Result æ¥å£ï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šæç¤ºæˆ‘ä»¬å»æ–°å¢æ–°çš„æ¡ä»¶åˆ†æ”¯
 * å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ–°å¢ç›¸åº”çš„æ¡ä»¶åˆ†æ”¯ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ‰§è¡Œ else çš„æƒ…å†µ
 * å…¶å®è¿™ä¸ª else å°±æ˜¯ä¸€ä¸ªæ— ç”¨åˆ†æ”¯ï¼Œè¿™ä»…ä»…æ˜¯ä¸ºäº†æ»¡è¶³ç¼–è¯‘å™¨çš„è¦æ±‚
 */
fun getResultMsg(result: Result) = when (result){
    is Success -> "Success"
    is Failure -> "Failure"
    else -> throw RuntimeException()
}

//åœ¨ä½¿ç”¨å¯†å°ç±»ä¹‹å
sealed class Result
class Success : Result()
class Failure : Result()
/**
 * æ­¤æ—¶æˆ‘ä»¬å°±é¿å…äº†å†™ else åˆ†æ”¯ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘æ–°å¢ä¸€ä¸ªç±»å®ç° Result å¯†å°ç±»
 * ç¼–è¯‘å™¨å°±ä¼šæç¤ºå¼‚å¸¸ï¼Œéœ€è¦ when å»æ–°å¢ç›¸åº”çš„æ¡ä»¶åˆ†æ”¯
 */
fun getResultMsg(result: Result) = when (result){
    is Success -> "Success"
    is Failure -> "Failure"
}
```

## æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦

### å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°

æ‰©å±•å‡½æ•°å…è®¸æˆ‘ä»¬å»æ‰©å±•ä¸€ä¸ªç±»çš„å‡½æ•°ï¼Œè¿™ç§ç‰¹æ€§æ˜¯ Java ä¸­æ‰€æ²¡æœ‰çš„
æ‰©å±•å‡½æ•°çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š

```kotlin
fun ClassName.methodName(params1: Int, params2: Int) : Int{
  
}
```

ç›¸æ¯”äºæ™®é€šçš„å‡½æ•°ï¼Œæ‰©å±•å‡½æ•°åªéœ€è¦åœ¨å‡½æ•°å‰é¢åŠ ä¸Šä¸€ä¸ª ClassName. çš„è¯­æ³•ç»“æ„ï¼Œå°±è¡¨ç¤ºæŠŠè¯¥å‡½æ•°æ·»åŠ åˆ°æŒ‡å®šçš„ç±»ä¸­

> ä¸€èˆ¬æˆ‘ä»¬è¦å®šä¹‰å“ªä¸ªç±»çš„æ‰©å±•å‡½æ•°ï¼Œæˆ‘ä»¬å°±å®šä¹‰ä¸€ä¸ªåŒåçš„ Kotlin æ–‡ä»¶ï¼Œä¾¿äºåç»­æŸ¥æ‰¾ï¼Œè™½ç„¶è¯´ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ä»»ä½•ä¸€ä¸ªç±»ä¸­ï¼Œä½†æ˜¯æ›´æ¨èå°†å®ƒå®šä¹‰æˆé¡¶å±‚æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥è®©æ‰©å±•æ–¹æ³•æ‹¥æœ‰å…¨å±€çš„è®¿é—®åŸŸ
> æ‰©å±•å‡½æ•°é»˜è®¤æ‹¥æœ‰è¿™ä¸ªç±»çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ
ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨è¦ç»™ String è¿™ä¸ªç±»æ‰©å±•ä¸€ä¸ª printString æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–°å»ºä¸€ä¸ª String.kt çš„æ–‡ä»¶ï¼Œç„¶ååœ¨è¿™ä¸ªæ–‡ä»¶ä¸‹é¢ç¼–å†™æ‰©å±•å‡½æ•°ï¼š

```kotlin
fun String.printString(){
    println(this)
}

fun main() {
    val name = "erdai"
    name.printString()
}
//æ‰“å°ç»“æœ
erdai
```

### æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½

Kotlin çš„è¿ç®—ç¬¦é‡è½½å…è®¸æˆ‘ä»¬è®©ä»»æ„ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œç›¸åŠ ï¼Œæˆ–è€…æ˜¯è¿›è¡Œå…¶ä»–æ›´å¤šçš„è¿ç®—æ“ä½œ

è¿ç®—ç¬¦é‡è½½ä½¿ç”¨çš„æ˜¯ ``operator`` å…³é”®å­—ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡å®šå‡½æ•°å‰é¢åŠ ä¸Š ``operator`` å…³é”®å­—ï¼Œå°±å¯ä»¥å®ç°è¿ç®—ç¬¦é‡è½½çš„åŠŸèƒ½äº†ã€‚

```kotlin
class Money(val value: Int) {

    //å®ç°è¿ç®—ç¬¦é‡è½½ Money + Money
    operator fun plus(money: Money): Money {
        val sum = value + money.value
        return Money(sum)
    }

    //å®ç°è¿ç®—ç¬¦é‡è½½ Money + Int
    operator fun plus(money: Int): Money{
        val sum = value + money
        return Money(sum)
    }
}

fun main() {
    val money1 = Money(15)
    val money2 = Money(20)
    val money3 = money1 + money2
    val money4 = money3 + 15
    println(money3.value)
    print(money4.value)
}

//æ‰“å°ç»“æœ
35
50
```

## é«˜é˜¶å‡½æ•°è¯¦è§£

é«˜é˜¶å‡½æ•°å’Œ Lambda è¡¨è¾¾å¼æ˜¯å¯†ä¸å¯åˆ†çš„ï¼Œåœ¨ä¹‹å‰çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸€äº› å‡½æ•°å¼ Api çš„ç”¨æ³•ï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒä»¬éƒ½ä¼šæœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼šéœ€è¦ä¼ å…¥ä¸€ä¸ª Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚åƒè¿™ç§æ¥æ”¶ Lambda è¡¨è¾¾å¼çš„å‡½æ•°æˆ‘ä»¬å°±å¯ä»¥ç§°ä¹‹ä¸ºå…·æœ‰å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„ Apiï¼Œè€Œå¦‚æœä½ è¦å®šä¹‰è‡ªå·±çš„å‡½æ•°å¼ Apiï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥å®ç°äº†

### å®šä¹‰é«˜é˜¶å‡½æ•°

é«˜é˜¶å‡½æ•°çš„å®šä¹‰ï¼šä¸€ä¸ªå‡½æ•°æ¥æ”¶å¦å¤–ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…è¿”å›å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°

> Kotlin ä¸­æ–°å¢äº†å‡½æ•°ç±»å‹ï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™ç§å‡½æ•°ç±»å‹æ·»åŠ åˆ°ä¸€ä¸ªå‡½æ•°çš„å‚æ•°å£°æ˜æˆ–è€…è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°

å‡½æ•°ç±»å‹çš„è¯­æ³•è§„åˆ™å¦‚ä¸‹

```kotlin
(String,Int) -> Unit
//æˆ–è€…å¦‚ä¸‹
() -> Unit
```

-> çš„å·¦è¾¹å£°æ˜å‡½æ•°æ¥æ”¶ä»€ä¹ˆç±»å‹çš„å‚æ•°ï¼Œ-> çš„å³è¾¹å£°æ˜çš„æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œç°åœ¨æˆ‘ä»¬æ¥å£°æ˜ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼š

```kotlin
fun example(func: (String,Int) -> Unit) {
    //do something
}
```

### é«˜é˜¶å‡½æ•°çš„è°ƒç”¨

æˆ‘ä»¬åªéœ€è¦åœ¨å‚æ•°ååé¢åŠ ä¸Šä¸€å¯¹æ‹¬å·ï¼Œä¼ å…¥å¯¹åº”ç±»å‹çš„å‚æ•°å³å¯ï¼Œä¾‹å¦‚ä»¥ä¸Šé¢å®šä¹‰çš„è¿™ä¸ªé«˜é˜¶å‡½æ•°ä¸ºä¾‹å­ï¼š

```kotlin
fun example(func: (String,Int) -> Unit) {
    //å‡½æ•°ç±»å‹è°ƒç”¨
    func("erdai",666)
}
```

ä¸‹é¢æˆ‘ä»¬å°±æ¥å®è·µä¸€ä¸‹ï¼š

```kotlin
//æˆ‘ä»¬ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥è·å–ä¸¤ä¸ªæ•°ç›¸åŠ çš„å’Œ
fun numberPlus(num1: Int,num2: Int,func: (Int,Int) -> Int): Int{
    val sum = func(num1,num2)
    return sum
}

fun plus(num1: Int,num2: Int): Int{
    return num1 + num2
}

fun minus(num1: Int,num2: Int): Int{
    return num1 - num2
}

//è°ƒç”¨é«˜é˜¶å‡½æ•°çš„ä¸¤ç§æ–¹å¼
//æ–¹å¼1ï¼šæˆå‘˜å¼•ç”¨ï¼Œä½¿ç”¨ ::plusï¼Œ::minusè¿™ç§å†™æ³•å¼•ç”¨ä¸€ä¸ªå‡½æ•°
fun main() {
    val numberPlus = numberPlus(10, 20, ::plus)
    val numberMinus = numberPlus(10, 20, ::minus)
    println(numberPlus)
    println(numberMinus)
}
//æ‰“å°ç»“æœ
30
-10

//æ–¹å¼2ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„å†™æ³•
fun main() {
    val numberPlus = numberPlus(10, 20){ num1,num2 ->
        num1 + num2
    }
    val numberMinus = numberPlus(10, 20){ num1,num2 ->
        num1 - num2
    }
    println(numberPlus)
    println(numberMinus)
}
//æ‰“å°ç»“æœ
30
-10
```

å…¶ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„å†™æ³•æ˜¯é«˜é˜¶å‡½æ•°ä¸­æœ€æ™®éçš„è°ƒç”¨æ–¹å¼

### å†…è”å‡½æ•°çš„ä½œç”¨

1. å†…è”å‡½æ•°å¯ä»¥æ¶ˆé™¤ Lambda è¡¨è¾¾å¼è¿è¡Œæ—¶å¸¦æ¥çš„å¼€é”€

Kotlin ä»£ç æœ€ç»ˆè¿˜æ˜¯ä¼šè½¬æ¢æˆ Java å­—èŠ‚ç æ–‡ä»¶ï¼Œä¸¾ä¸ªğŸŒ°ï¼š

```kotlin
fun numberPlus(num1: Int,num2: Int,func: (Int,Int) -> Int): Int{
    val sum = func(num1,num2)
    return sum
}

fun main() {
  	val num1 = 10
  	val num2 = 20
    val numberPlus = numberPlus(num1, num2){ num1,num2 ->
        num1 + num2
    }
}

//ä¸Šé¢è¿™äº›ä»£ç æœ€ç»ˆè½¬æ¢æˆ Java ä»£ç å¤§æ¦‚ä¼šå˜æˆè¿™æ ·ï¼š
public static int numberPlus(int num1, int num2, Function operation){
  	int sum = (int) operation.invoke(num1,num2);
  	return sum;
}

public static void main(){
  	int num1 = 10;
  	int num2 = 20;
  	int sum = numberPlus(num1,num2,new Function(){
      	@Override
      	public Integer invoke(Integer num1,Integer num2){
          	return num1 + num2;
        }
    });
}
```

å¯ä»¥çœ‹åˆ°ï¼Œè½¬æ¢ä¹‹åï¼ŒnumberPlus å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å˜æˆäº†ä¸€ä¸ª Function æ¥å£ï¼Œè¿™æ˜¯ä¸€ç§ Kotlin çš„å†…ç½®æ¥å£ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå¾…å®ç°çš„ invoke å‡½æ•°ï¼Œè€Œ numberPlus å‡½æ•°å…¶å®å°±æ˜¯è°ƒç”¨äº† Function æ¥å£çš„ invoke å‡½æ•°ï¼Œå¹¶æŠŠ num1 å’Œ num2 ä¼ äº†è¿›å»ã€‚ä¹‹å‰çš„ Lambda è¡¨è¾¾å¼åœ¨è¿™é‡Œå˜æˆäº† Function æ¥å£çš„åŒ¿åç±»å®ç°ï¼Œè¿™å°±æ˜¯ Lambda è¡¨è¾¾å¼çš„åº•å±‚è½¬æ¢é€»è¾‘ï¼Œå› æ­¤æˆ‘ä»¬æ¯è°ƒç”¨ä¸€æ¬¡ Lambda è¡¨è¾¾å¼ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ¿åç±»å®ä¾‹ï¼Œè¿™æ ·å°±ä¼šé€ æˆé¢å¤–çš„å†…å­˜å’Œæ€§èƒ½å¼€é”€ã€‚ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨å†…è”å‡½æ•°ï¼Œå°±å¯ä»¥å¾ˆå¥½çš„å»è§£å†³è¿™ä¸ªé—®é¢˜

2. å®šä¹‰é«˜é˜¶å‡½æ•°æ—¶åŠ ä¸Š inline å…³é”®å­—ä¿®é¥°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°ç§°ä¹‹ä¸ºå†…è”å‡½æ•°

```kotlin
//å®šä¹‰ä¸€ä¸ªå†…è”å‡½æ•°
inline fun numberPlus(num1: Int,num2: Int,func: (Int,Int) -> Int): Int{
    val sum = func(num1,num2)
    return sum
}
```

**Kotlin ç¼–è¯‘å™¨ä¼šæŠŠå†…è”å‡½æ•°ä¸­çš„ä»£ç åœ¨ç¼–è¯‘çš„æ—¶å€™è‡ªåŠ¨æ›¿æ¢åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹**

3. ä½¿ç”¨ ``noinline`` å…³é”®å­—ä¿®é¥°çš„å‡½æ•°ç±»å‹å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ç±»å‹å‚æ•°ä¸éœ€è¦è¿›è¡Œå†…è”
ä¸€èˆ¬ä½¿ç”¨ ``noinline`` å…³é”®å­—ï¼Œæ˜¯åœ¨ä¸€ä¸ªå†…è”å‡½æ•°ä¸­å­˜åœ¨å¤šä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°

```kotlin
//ä½¿ç”¨å†…è”å‡½æ•°å®šä¹‰çš„é«˜é˜¶å‡½æ•°ï¼Œå…¶é‡Œé¢çš„å‡½æ•°ç±»å‹å‚æ•°éƒ½ä¼šè¿›è¡Œå†…è”ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨ noinline è¡¨ç¤ºæˆ‘è¿™ä¸ªå‡½æ•°ç±»å‹å‚æ•°ä¸éœ€è¦å†…è”
inline fun inlineTest(block1: () -> Unit, noinline block2: () -> Unit){
  
}
```

å‰é¢æˆ‘ä»¬è®²åˆ°ï¼Œä½¿ç”¨å†…è”å‡½æ•°èƒ½å‡å°‘è¿è¡Œæ—¶å¼€é”€ï¼Œä¸ºå•¥ç°åœ¨åˆè¦å‡ºæ¥ä¸ª ``noinline`` å…³é”®å­—å®šä¹‰ä¸éœ€è¦å†…è”å‘¢ï¼ŸåŸå› å¦‚ä¸‹ï¼š

- å†…è”å‡½æ•°åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¿›è¡Œä»£ç æ›¿æ¢ï¼Œå› æ­¤å®ƒæ²¡æœ‰çœŸæ­£çš„å‚æ•°å±æ€§ï¼Œå®ƒçš„å‡½æ•°ç±»å‹å‚æ•°åªèƒ½ä¼ é€’ç»™å¦å¤–ä¸€ä¸ªå†…è”å‡½æ•°ï¼Œè€Œéå†…è”å‡½æ•°çš„å‡½æ•°ç±»å‹å‚æ•°å¯ä»¥è‡ªç”±çš„ä¼ é€’ç»™å…¶ä»–ä»»ä½•å‡½æ•°
- å†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå‡½æ•°è¿”å›ï¼Œéå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return@Method è¯­æ³•ç»“æ„æ¥è¿›è¡Œå±€éƒ¨è¿”å›
  
```kotlin
//æƒ…å†µ1ï¼šéå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå±€éƒ¨è¿”å›
//å®šä¹‰ä¸€ä¸ªéå†…è”çš„é«˜é˜¶å‡½æ•°
fun printString(str: String, block: (String) -> Unit){
    println("printString start...")
    block(str)
    println("printString end...")
}

fun main() {
    println("main start...")
    val str = ""
    printString(str){
        println("lambda start...")
      	/**
         * 1ï¼Œéå†…è”å‡½æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨ return å…³é”®å­—è¿›è¡Œå±€éƒ¨è¿”å›
	 * 2ï¼Œéœ€è¦ä½¿ç”¨ return@printString è¿›è¡Œå±€éƒ¨è¿”å›
         */
        if (str.isEmpty())return@printString
        println(it)
        println("lambda end...")
    }
    println("main end...")
}
//æ‰“å°ç»“æœ
main start...
printString start...
lambda start...
printString end...
main end...

//æƒ…å†µ2ï¼šå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå‡½æ•°è¿”å›
//å®šä¹‰ä¸€ä¸ªéå†…è”çš„é«˜é˜¶å‡½æ•°
inline fun printString(str: String, block: (String) -> Unit){
    println("printString start...")
    block(str)
    println("printString end...")
}

fun main() {
    println("main start...")
    val str = ""
    printString(str){
        println("lambda start...")
        if (str.isEmpty())return
        println(it)
        println("lambda end...")
    }
    println("main end...")
}
//å› ä¸ºå†…è”å‡½æ•°ä¼šè¿›è¡Œä»£ç æ›¿æ¢ï¼Œå› æ­¤è¿™ä¸ª return å°±ç›¸å½“äºå¤–å±‚å‡½æ•°è°ƒç”¨çš„ä¸€ä¸ªè¿”å›ï¼Œå¦‚ä¸‹ä»£ç ï¼š
fun main() {
    println("main start...")
    val str = ""
    println("printString start...")
    println("lambda start...")
    if (str.isEmpty())return
    println(str)
    println("lambda end...")
    println("printString end...")
    println("main end...")
}

//æ‰“å°ç»“æœ
main start...
printString start...
lambda start...
```

4. ä½¿ç”¨ ``crossinline`` å…³é”®å­—ä¿è¯å†…è”å‡½æ•°çš„ Lambda è¡¨è¾¾å¼ä¸­ä¸€å®šä¸ä¼šä½¿ç”¨ ``return`` å…³é”®å­—ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ ``return@Method`` è¯­æ³•ç»“æ„è¿›è¡Œå±€éƒ¨è¿”å›ï¼Œå…¶ä»–æ–¹é¢å’Œå†…è”å‡½æ•°ç‰¹æ€§ä¸€è‡´

ä¸¾ä¸ªä½¿ç”¨ ``crossinline`` åœºæ™¯çš„ğŸŒ° ï¼š
![Alt text](image-2.png)

ä¸Šé¢å›¾ç‰‡ä¸­çš„ä»£ç æŠ¥é”™äº†ï¼Œç¼–è¯‘å™¨æç¤ºæˆ‘ä»¬çš„å¤§è‡´åŸå› æ˜¯ï¼šè¿™ä¸ªåœ°æ–¹ä¸èƒ½ä½¿ç”¨ ``inline`` ,å› ä¸ºå®ƒå¯èƒ½åŒ…å«éå±€éƒ¨çš„ ``return`` è¿”å›ï¼Œæ·»åŠ  ``crossinline`` ä¿®é¥°ç¬¦å»ä¿®é¥°è¿™ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ã€‚
ä¸ºå•¥å‘¢ï¼Ÿæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š
æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Runnable å¯¹è±¡ï¼Œåœ¨ Runnable ä¸­çš„ Lambda è¡¨è¾¾å¼ä¸­è°ƒç”¨äº†å‡½æ•°ç±»å‹å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¢«è½¬æ¢æˆåŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œå†…è”å‡½æ•°å…è®¸æˆ‘ä»¬åœ¨ Lambda è¡¨è¾¾å¼ä¸­ä½¿ç”¨ ``return`` å…³é”®å­—è¿›è¡Œå‡½æ•°è¿”å›ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ˜¯åœ¨åŒ¿åç±»ä¸­è°ƒç”¨çš„å‡½æ•°ç±»å‹å‚æ•°ï¼Œæ­¤æ—¶æ˜¯ä¸å¯èƒ½è¿›è¡Œå¤–å±‚è°ƒç”¨å‡½æ•°è¿”å›çš„ï¼Œæœ€å¤šæ˜¯åœ¨åŒ¿åå‡½æ•°ä¸­è¿›è¡Œè¿”å›ï¼Œå› æ­¤è¿™é‡Œå°±æç¤ºäº†é”™è¯¯ï¼ŒçŸ¥é“äº†åŸå› é‚£æˆ‘ä»¬ä½¿ç”¨ ``crossinline`` å…³é”®å­—æ¥ä¿®æ”¹ä¸€ä¸‹

```kotlin
inline fun runRunnable(crossinline block: () -> Unit) {
    println("runRunnable start...")
    val runnable = Runnable {
        block()
    }
    runnable.run()
    println("runRunnable end...")
}


fun main() {
    println("main start...")
    runRunnable {
        println("lambda start...")
        return@runRunnable
        println("lambda end...")
    }
    println("main end...")
}
//æ‰“å°ç»“æœ
main start...
runRunnable start...
lambda start...
runRunnable end...
main end...
```

## æ³›å‹å’Œå§”æ‰˜

### ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§

å§”æ‰˜æ¨¡å¼çš„æ„ä¹‰ï¼šåœ¨äºæˆ‘ä»¬å¤§éƒ¨åˆ†æ–¹æ³•å®ç°å¯ä»¥è°ƒç”¨è¾…åŠ©å¯¹è±¡å»å®ç°ï¼Œå°‘éƒ¨åˆ†æ–¹æ³•çš„å®ç°ç”±è‡ªå·±æ¥é‡å†™ï¼Œç”šè‡³åŠ å…¥ä¸€äº›è‡ªå·±ç‹¬æœ‰çš„æ–¹æ³•ï¼Œä½¿æˆ‘ä»¬è¿™ä¸ªç±»å˜æˆä¸€ä¸ªå…¨æ–°æ•°æ®ç»“æ„çš„ç±»

1. ç±»å§”æ‰˜æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠä¸€ä¸ªç±»çš„å…·ä½“å®ç°å§”æ‰˜ç»™å¦å¤–ä¸€ä¸ªç±»ï¼Œä½¿ç”¨ ``by`` å…³é”®å­—è¿›è¡Œå§”æ‰˜

```kotlin
//å®šä¹‰ä¸€ä¸ª MySet ç±»ï¼Œå®ƒé‡Œé¢çš„å…·ä½“å®ç°éƒ½å§”æ‰˜ç»™äº† HashSet è¿™ä¸ªç±»ï¼Œè¿™æ˜¯æ˜¯ç±»å§”æ‰˜
class MySet<T>(val helperSet: HashSet<T>) : Set<T>{

    override val size: Int get() = helperSet.size

    override fun contains(element: T) = helperSet.contains(element)

    override fun containsAll(elements: Collection<T>) = helperSet.containsAll(elements)

    override fun isEmpty() = helperSet.isEmpty()

    override fun iterator() = helperSet.iterator()
}

/**
 * å¦‚æœæˆ‘ä»¬ä½¿ç”¨ by å…³é”®å­—ï¼Œä¸Šé¢çš„ä»£ç å°†ä¼šå˜å¾—éå¸¸æ•´æ´ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å¯¹æŸä¸ªæ–¹æ³•è¿›è¡Œé‡å†™æˆ–è€…æ–°å¢æ–¹æ³•
 * é‚£ä¹ˆ MySet å°±å˜æˆäº†ä¸€ä¸ªå…¨æ–°çš„æ•°æ®ç»“æ„ç±»
 */
class MySet<T>(val helperSet: HashSet<T>) : Set<T> by helperSet{
     fun helloWord(){
        println("Hello World")
    }
    
    override fun isEmpty() = false
}
```

2. å±æ€§å§”æ‰˜çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ä¸€ä¸ªå±æ€§çš„å…·ä½“å®ç°å§”æ‰˜ç»™å¦ä¸€ä¸ªç±»å»å®Œæˆ

å±æ€§å§”æ‰˜çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š

```kotlin
/**
* ä½¿ç”¨ by å…³é”®å­—è¿æ¥äº†å·¦è¾¹çš„ p å±æ€§å’Œå³è¾¹çš„ Delegate å®ä¾‹
* è¿™ç§å†™æ³•å°±ä»£è¡¨ç€å°† p å±æ€§çš„å…·ä½“å®ç°å§”æ‰˜ç»™äº† Delegate å»å®Œæˆ
*/
class MyClass{

   var p by Delegate()
}

/**
* ä¸‹é¢æ˜¯ä¸€ä¸ªè¢«å§”æ‰˜ç±»çš„ä»£ç å®ç°æ¨¡ç‰ˆ
* ä¸€ã€getValue æ–¹æ³•å’ŒsetValue æ–¹æ³•å¿…é¡»ä½¿ç”¨ operator å…³é”®å­—ä¿®é¥°
* 
* äºŒã€getValue æ–¹æ³•ä¸»è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š
* 1ã€ç¬¬ä¸€ä¸ªå‚æ•°è¡¨æ˜ Delegate ç±»çš„å§”æ‰˜åŠŸèƒ½å¯ä»¥åœ¨ä»€ä¹ˆç±»ä¸­ä½¿ç”¨
* 2ã€ç¬¬äºŒä¸ªå‚æ•° KProperty<*> æ˜¯ Kotlin ä¸­çš„ä¸€ä¸ªå±æ€§æ“ä½œç±»ï¼Œ
*    å¯ç”¨äºè·å–å„ç§å±æ€§çš„ç›¸å…³å€¼ï¼Œ<*>è¿™ç§æ³›å‹çš„å†™æ³•ç±»ä¼¼ Java çš„
*    <?>ï¼Œè¡¨ç¤ºæˆ‘ä¸å…³å¿ƒæ³›å‹çš„å…·ä½“ç±»å‹
*
* ä¸‰ã€setValue æ–¹æ³•ä¹Ÿæ˜¯ç›¸ä¼¼çš„ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š
* 1ã€å‰é¢ä¸¤ä¸ªå‚æ•°å’Œ getValue æ˜¯ä¸€æ ·çš„
* 2ã€ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºå…·ä½“è¦èµ‹å€¼ç»™å§”æ‰˜å±æ€§çš„å€¼ï¼Œè¿™ä¸ªå‚æ•°çš„ç±»å‹å¿…é¡»å’Œ
*    getValue æ–¹æ³•è¿”å›å€¼çš„ç±»å‹ä¿æŒä¸€è‡´
*
*
* ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šç”¨ val å®šä¹‰çš„å˜é‡ä¸éœ€è¦å®ç° setValue æ–¹æ³•ï¼Œå› ä¸º val
*             å…³é”®å­—å£°æ˜çš„å±æ€§åªå¯è¯»ï¼Œèµ‹å€¼ä¹‹åå°±ä¸èƒ½æ›´æ”¹äº†
*/
class Delegate{
      var propValue: Any? = null

   operator fun getValue(any: Any?,prop: KProperty<*>): Any?{
       return propValue
   }

   operator fun setValue(any: Any?,prop: KProperty<*>,value: Any?){
       propValue = value
   }
}
```

### ä½¿ç”¨ infix å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•

infix å‡½æ•°è¯­æ³•ç»“æ„å¯è¯»æ€§é«˜ï¼Œç›¸æ¯”äºè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ›´æ¥è¿‘äºä½¿ç”¨è‹±è¯­ A to B è¿™æ ·çš„è¯­æ³•ç»“æ„
ä¾‹å¦‚æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¼šä½¿ç”¨ï¼š A.to(B) è¿™ç§ç»“æ„ï¼Œä½†æ˜¯ä½¿ç”¨ infix å‡½æ•°æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼šA to Bï¼Œè¿™ç§è¯­æ³•æˆ‘ä»¬åœ¨è®² Map çš„æ—¶å€™ç”¨è¿‡

```kotlin
//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Map é›†åˆ
val map1 = mapOf("Apple" to 1,"Banana" to 2,"Orange" to 3, "Pear" to 4,"Grape" to 5)

1ï¼‰ã€åœ¨å‡½æ•°å‰é¢åŠ ä¸Š infix å…³é”®å­—ï¼Œå°±å¯ä»¥å£°æ˜è¿™æ˜¯ä¸€ä¸ª infix å‡½æ•°
kotlinå¤åˆ¶ä»£ç //å¯¹ String å¢åŠ ä¸€ä¸ªæ‰©å±•çš„ infix å‡½æ•°ï¼Œæœ€ç»ˆè°ƒç”¨çš„è¿˜æ˜¯ String çš„ startsWith å‡½æ•°
infix fun String.beginWith(string: String) = startsWith(string)

fun main() {
    val name = "erdai"
    println(name beginWith "er")
}
//æ‰“å°ç»“æœ
true
```

æˆ‘ä»¬å†æ¥å®ç°ä¸€ä¸ªåˆå§‹åŒ– Map æ—¶é‡Œé¢ä¼ å…¥ A to B è¿™ç§ infix å‡½æ•°

```kotlin
//è¿™æ˜¯ A to B çš„æºç å®ç°
public infix fun <A, B> A.to(that: B): Pair<A, B> = Pair(this, that)

//æˆ‘ä»¬ä»¿ç…§å®ƒå†™ä¸€ä¸ª
public infix fun <A,B> A.with(that: B): Pair<A,B> = Pair(this,that)

fun main() {
    val map = mapOf("Apple" with 1,"Banana" with 2,"Orange" with 3,"Pear" with 4,"Grape" with 5)
}
```

### æ³›å‹æ“¦é™¤

```java
public class JavaGenericWipe {
  
    public static void main(String[] args) {
        Class a = new ArrayList<String>().getClass();
        Class b = new ArrayList<Integer>().getClass();

        System.out.println("a = " + a);
        System.out.println("b = " + b);
        System.out.println("a == b: " + (a == b));
    }
}

//æ‰“å°ç»“æœ
a = class java.util.ArrayList
b = class java.util.ArrayList
a == b: true
```

ä¸ºå•¥ä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ
> å› ä¸º Java ä¸­çš„æ³›å‹æ˜¯ä½¿ç”¨æ“¦é™¤æŠ€æœ¯æ¥å®ç°çš„ï¼šæ³›å‹æ“¦é™¤æ˜¯æŒ‡é€šè¿‡ç±»å‹å‚æ•°åˆå¹¶ï¼Œå°†æ³›å‹ç±»å‹å®ä¾‹å…³è”åˆ°åŒä¸€ä»½å­—èŠ‚ç ä¸Šã€‚ç¼–è¯‘å™¨åªä¸ºæ³›å‹ç±»å‹ç”Ÿæˆä¸€ä»½å­—èŠ‚ç ï¼Œå¹¶å°†å…¶å®ä¾‹å…³è”åˆ°è¿™ä»½å­—èŠ‚ç ä¸Š

ä¹‹æ‰€ä»¥è¦ä½¿ç”¨æ³›å‹æ“¦é™¤æ˜¯ä¸ºäº†å…¼å®¹ JDK 1.5 ä¹‹å‰è¿è¡Œæ—¶çš„ç±»åŠ è½½å™¨ï¼Œé¿å…å› ä¸ºå¼•å…¥æ³›å‹è€Œå¯¼è‡´è¿è¡Œæ—¶åˆ›å»ºä¸å¿…è¦çš„ç±»

#### æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤

1. æ“¦é™¤æ‰€æœ‰ç±»å‹å‚æ•°ä¿¡æ¯ï¼Œå¦‚æœç±»å‹å‚æ•°æ˜¯æœ‰ç•Œçš„ï¼Œåˆ™å°†æ¯ä¸ªå‚æ•°æ›¿æ¢ä¸ºå…¶ç¬¬ä¸€ä¸ªè¾¹ç•Œï¼›å¦‚æœç±»å‹å‚æ•°æ˜¯æ— ç•Œçš„ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸º Objectç±»å‹æ“¦é™¤çš„è§„åˆ™ï¼š

```java
<T> æ“¦é™¤åå˜ä¸º Object
<T extends A> æ“¦é™¤åå˜ä¸º A
<? extends A>  æ“¦é™¤åå˜ä¸º A
<? super A> æ“¦é™¤åå˜ä¸ºObject
```

2. å¿…è¦æ—¶ï¼‰æ’å…¥ç±»å‹è½¬æ¢ï¼Œä»¥ä¿æŒç±»å‹å®‰å…¨
3. å¿…è¦æ—¶ï¼‰ç”Ÿæˆæ¡¥æ¥æ–¹æ³•ä»¥åœ¨å­ç±»ä¸­ä¿ç•™å¤šæ€æ€§


```java
//æƒ…å†µ1: æ“¦é™¤æ‰€æœ‰ç±»å‹å‚æ•°ä¿¡æ¯ï¼Œå¦‚æœç±»å‹å‚æ•°æ˜¯æœ‰ç•Œçš„ï¼Œåˆ™å°†æ¯ä¸ªå‚æ•°æ›¿æ¢ä¸ºå…¶ç¬¬ä¸€ä¸ªè¾¹ç•Œï¼›å¦‚æœç±»å‹å‚æ•°æ˜¯æ— ç•Œçš„ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸º Object
class Paint {
    void draw() {
        System.out.println("Paint.draw() called");
    }
}

//å¦‚æœä¸ç»™ T è®¾ç½®è¾¹ç•Œï¼Œé‚£ä¹ˆ work æ–¹æ³•é‡Œé¢çš„ t å°±è°ƒç”¨ä¸åˆ° draw æ–¹æ³•
class Painter<T extends Paint> {
    private T t;

    public Painter(T t) {
        this.t = t;
    }
    public void work() {
        t.draw();
    }
}

//æƒ…å†µ2ï¼šï¼ˆå¿…è¦æ—¶ï¼‰æ’å…¥ç±»å‹è½¬æ¢ï¼Œä»¥ä¿æŒç±»å‹å®‰å…¨
public class JavaGenericWipe {
    public static void main(String[] args) {
        List<String> stringList = new ArrayList<>();
        stringList.add("erdai");
        stringList.add("666");

        for (String s : stringList) {
            System.out.println(s);
        }
    }
}

//ç¼–è¯‘æ—¶ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ç¿»è¯‘è¿‡æ¥å¤§è‡´å¦‚ä¸‹
public class JavaGenericWipe {
    public JavaGenericWipe() {
    }

    public static void main(String[] args) {
        List<String> stringList = new ArrayList();
        stringList.add("erdai");
        stringList.add("666");
        Iterator var2 = stringList.iterator();

        while(var2.hasNext()) {
            //ç¼–è¯‘å™¨ç»™æˆ‘ä»¬åšäº†å¼ºè½¬çš„å·¥ä½œ
            String s = (String)var2.next();
            System.out.println(s);
        }
    }
}

//æƒ…å†µ3 ï¼ˆå¿…è¦æ—¶ï¼‰ç”Ÿæˆæ¡¥æ¥æ–¹æ³•ä»¥åœ¨å­ç±»ä¸­ä¿ç•™å¤šæ€æ€§
class Node {
    public Object data;

    public Node(Object data) {
        this.data = data;
    }

    public void setData(Object data) {
        this.data = data;
    }
}

class MyNode extends Node {

    public MyNode(Integer data) {
        super(data);
    }

    public void setData(Integer data) {
        super.setData(data);
    }
}

//ç¼–è¯‘æ—¶ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ç¿»è¯‘è¿‡æ¥å¤§è‡´å¦‚ä¸‹
class MyNode extends Node {

    public MyNode(Integer data) {
        super(data);
    }
    // ç¼–è¯‘å™¨ç”Ÿæˆçš„æ¡¥æ¥æ–¹æ³•
    public void setData(Object data) {
        setData((Integer) data);
    }

    public void setData(Integer data) {
        System.out.println("MyNode.setData");
        super.setData(data);
    }
}
```

#### ä¼ªæ³›å‹

Java ä¸­çš„æ³›å‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ç³–ï¼Œé€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼Œè¿™ç§æ³›å‹ç§°ä¸ºä¼ªæ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥åå°„ç»•è¿‡ç¼–è¯‘å™¨æ³›å‹æ£€æŸ¥ï¼Œæ·»åŠ ä¸€ä¸ªä¸åŒç±»å‹çš„å‚æ•°

```java
//åå°„ç»•è¿‡ç¼–è¯‘å™¨æ£€æŸ¥
public static void main(String[] args) {
    
     List<String> stringList = new ArrayList<>();
     stringList.add("erdai");
     stringList.add("666");

     //ä½¿ç”¨åå°„å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ 
     Class<? extends List> aClass = stringList.getClass();
     try {
         Method method = aClass.getMethod("add", Object.class);
         method.invoke(stringList,123);
     } catch (Exception e) {
         e.printStackTrace();
     }

     Iterator iterator = stringList.iterator();
     while (iterator.hasNext()){
         System.out.println(iterator.next());
     }
}
//æ‰“å°ç»“æœ
erdai
666
123
```

#### æ³›å‹æ“¦é™¤è¿›é˜¶

ä¸‹é¢æˆ‘æŠ›å‡ºä¸€ä¸ªåœ¨å·¥ä½œä¸­ç»å¸¸ä¼šé‡åˆ°çš„é—®é¢˜ï¼š

åœ¨è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œä¼ å…¥ä¸€ä¸ªæ³›å‹çš„å®é™…ç±»å‹ï¼Œä¸ºå•¥èƒ½å¤Ÿæ­£ç¡®çš„è·å–åˆ°è¯¥æ³›å‹ç±»å‹ï¼Œå¹¶åˆ©ç”¨ Gson è½¬æ¢ä¸ºå®é™…çš„å¯¹è±¡ï¼Ÿ

ç­”ï¼šæ˜¯å› ä¸ºåœ¨è¿è¡ŒæœŸæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå°„è·å–åˆ°å…·ä½“çš„æ³›å‹ç±»å‹

What? æ³›å‹ä¸æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™è¢«æ“¦é™¤äº†å—ï¼Ÿä¸ºå•¥åœ¨è¿è¡Œæ—¶è¿˜èƒ½å¤Ÿè·å–åˆ°å…·ä½“çš„æ³›å‹ç±»å‹ï¼ŸğŸ¤”ï¸

ç­”ï¼šæ³›å‹ä¸­æ‰€è°“çš„ç±»å‹æ“¦é™¤ï¼Œå…¶å®åªæ˜¯æ“¦é™¤ Code å±æ€§ä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œåœ¨ç±»å¸¸é‡æ± å±æ€§ï¼ˆSignature å±æ€§ã€LocalVariableTypeTable å±æ€§ï¼‰ä¸­å…¶å®è¿˜ä¿ç•™ç€æ³›å‹ä¿¡æ¯ï¼Œè€Œç±»å¸¸é‡æ± ä¸­çš„å±æ€§å¯ä»¥è¢« class æ–‡ä»¶ï¼Œå­—æ®µè¡¨ï¼Œæ–¹æ³•è¡¨ç­‰æºå¸¦ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬å£°æ˜çš„æ³›å‹ä¿¡æ¯å¾—ä»¥ä¿ç•™ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å¯ä»¥åå°„è·å–æ³›å‹ä¿¡æ¯çš„æ ¹æœ¬ä¾æ®

```java
//è¿™æ˜¯åç¼–è¯‘åçš„ JavaGenericClass.class æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° T
public class JavaGenericClass<T> {

    private T a;

    public JavaGenericClass(T a) {
        this.a = a;
    }

    public T getA() {
        return a;
    }

    public void setA(T a) {
        this.a = a;
    }
  
  //...
}
```

> æ³¨æ„ï¼šJava æ˜¯åœ¨ JDK 1.5 å¼•å…¥çš„æ³›å‹ï¼Œä¸ºäº†å¼¥è¡¥æ³›å‹æ“¦é™¤çš„ä¸è¶³ï¼ŒJVM çš„ class æ–‡ä»¶ä¹Ÿåšäº†ç›¸åº”çš„ä¿®æ”¹ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯æ–°å¢äº† Signature å±æ€§è¡¨å’Œ LocalVariableTypeTable å±æ€§è¡¨

æˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼š

```java
class ParentGeneric<T> {

}

class SubClass extends ParentGeneric<String>{

}

class SubClass2<T> extends ParentGeneric<T> {

}

public class GenericGet {

    //è·å–å®é™…çš„æ³›å‹ç±»å‹
    public static <T> Type findGenericType(Class<T> cls) {
        Type genType = cls.getGenericSuperclass();
        Type finalNeedType = null;
        if (genType instanceof ParameterizedType) {
            Type[] params = ((ParameterizedType) genType).getActualTypeArguments();
            finalNeedType = params[0];
        }
        return finalNeedType;
    }
  
    public static void main(String[] args) {
        SubClass subClass = new SubClass();
	SubClass2<Integer> subClass2 = new SubClass2<Integer>();
        //æ‰“å° subClass è·å–çš„æ³›å‹
        System.out.println("subClass: " + findNeedClass(subClass.getClass()));
      	//æ‰“å°subClass2è·å–çš„æ³›å‹
        System.out.println("subClass2: " + findGenericType(subClass2.getClass()));
    }
}

//è¿è¡Œè¿™æ®µä»£ç  æ‰“å°ç»“æœå¦‚ä¸‹
subClass: class java.lang.String
subClass2: T
```

ä¸Šé¢ä»£ç ï¼š

1. ubClass ç›¸å½“äºå¯¹ ParentGeneric åšäº†èµ‹å€¼æ“ä½œ T = Stringï¼Œæˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°äº†æ³›å‹ç±»å‹ä¸º String
2. SubClass2 å¯¹ ParentGenericæ²¡æœ‰åšèµ‹å€¼æ“ä½œ ï¼Œæˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°äº†æ³›å‹ç±»å‹ä¸º T

è¿™é‡Œå¤§å®¶è‚¯å®šä¼šæœ‰å¾ˆå¤šç–‘é—®ï¼Ÿ

1. ä¸ºå•¥ 1 ä¸­æ²¡æœ‰ä¼ å…¥ä»»ä½•æ³›å‹çš„ä¿¡æ¯å´èƒ½è·å–åˆ°æ³›å‹ç±»å‹å‘¢ï¼Ÿ
2. ä¸ºå•¥ 2 ä¸­æˆ‘åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ä¼ å…¥çš„æ³›å‹æ˜¯ Integer ï¼Œè·å–çš„æ—¶å€™å˜æˆäº† T å‘¢ï¼Ÿ

ç°åœ¨æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€æ³¢ï¼š
ä¸Šé¢æˆ‘è®²è¿‡ï¼Œç±»å‹æ“¦é™¤å…¶å®åªæ˜¯æ“¦é™¤ Code å±æ€§ä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œåœ¨ç±»å¸¸é‡æ± å±æ€§ä¸­è¿˜ä¿ç•™ç€æ³›å‹ä¿¡æ¯ï¼Œå› æ­¤ä¸Šé¢çš„ SubClass å’ŒSubClass2 **åœ¨ç¼–è¯‘çš„æ—¶å€™å…¶å®ä¼šä¿ç•™å„è‡ªçš„æ³›å‹åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­**ï¼Œä¸€ä¸ªæ˜¯ Stringï¼Œä¸€ä¸ªæ˜¯ T ã€‚è€Œ subClass å’Œ subClass2 æ˜¯è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„ï¼Œè¿™ä¸ªæ—¶å€™ä½ å³ä½¿ä¼ å…¥äº†æ³›å‹ç±»å‹ï¼Œä¹Ÿä¼šè¢«æ“¦é™¤æ‰ï¼Œå› æ­¤æ‰ä¼šå‡ºç°ä¸Šé¢çš„ç»“æœï¼Œåˆ°è¿™é‡Œï¼Œå¤§å®¶æ˜¯å¦æ˜äº†äº†å‘¢ï¼Ÿ

å¦‚æœè¿˜æœ‰ç‚¹æ¨¡ç³Šï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

```java
class ParentGeneric<T> {

}

public class GenericGet {
    //è·å–å®é™…çš„æ³›å‹ç±»å‹
    public static <T> Type findGenericType(Class<T> cls) {
       Type genType = cls.getGenericSuperclass();
        Type finalNeedType = null;
        if (genType instanceof ParameterizedType) {
            Type[] params = ((ParameterizedType) genType).getActualTypeArguments();
            finalNeedType = params[0];
        }
        return finalNeedType;
    }

    public static void main(String[] args) {
        ParentGeneric<String> parentGeneric1 = new ParentGeneric<String>();
        ParentGeneric<String> parentGeneric2 = new ParentGeneric<String>(){};

        //æ‰“å° parentGeneric1 è·å–çš„æ³›å‹
        System.out.println("parentGeneric1: " + findGenericType(parentGeneric1.getClass()));
        //æ‰“å° parentGeneric2 è·å–çš„æ³›å‹
        System.out.println("parentGeneric2: " + findGenericType(parentGeneric2.getClass()));

    }
}
//è¿è¡Œè¿™æ®µä»£ç  æ‰“å°ç»“æœå¦‚ä¸‹
parentGeneric1: null
parentGeneric2: class java.lang.String
```

ä¸Šè¿°ä»£ç  parentGeneric1 å’Œ parentGeneric2 å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¤šäº† {}ï¼Œè·å–çš„ç»“æœå´æˆªç„¶ä¸åŒï¼Œæˆ‘ä»¬åœ¨æ¥ä»”ç»†åˆ†æä¸€æ³¢ï¼š

1. ParentGeneric å£°æ˜çš„æ³›å‹ T åœ¨ç¼–è¯‘çš„æ—¶å€™å…¶å®æ˜¯ä¿ç•™åœ¨äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼ŒparentGeneric1 æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œç”±äºæ³›å‹æ“¦é™¤ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡åå°„è·å–å…¶ä¸­çš„ç±»å‹ï¼Œå› æ­¤æ‰“å°äº† null

è¿™ä¸ªåœ°æ–¹å¯èƒ½å¤§å®¶åˆä¼šæœ‰ä¸ªç–‘é—®äº†ï¼Œä½ æ—¢ç„¶ä¿ç•™äº†æ³›å‹ç±»å‹ä¸º Tï¼Œé‚£ä¹ˆæˆ‘è·å–çš„æ—¶å€™åº”è¯¥ä¸º T æ‰æ˜¯ï¼Œä¸ºå•¥æ‰“å°çš„ç»“æœæ˜¯ null å‘¢ï¼Ÿ

å¦‚æœä½ å¿ƒé‡Œæœ‰è¿™ä¸ªç–‘é—®ï¼Œè¯´æ˜ä½ æ€è€ƒçš„éå¸¸ç»†è‡´ï¼Œè¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹ Java ç±»å‹ï¼ˆTypeï¼‰ç³»ç»Ÿæœ‰ä¸€å®šçš„äº†è§£ï¼Œè¿™å…¶å®å’Œæˆ‘ä¸Šé¢å†™çš„é‚£ä¸ªè·å–æ³›å‹ç±»å‹çš„æ–¹æ³•æœ‰å…³ï¼š

```java
//è·å–å®é™…çš„æ³›å‹ç±»å‹
public static <T> Type findGenericType(Class<T> cls) {
    //è·å–å½“å‰å¸¦æœ‰æ³›å‹çš„çˆ¶ç±»
    Type genType = cls.getGenericSuperclass();
    Type finalNeedType = null;
    //å¦‚æœå½“å‰ genType æ˜¯å‚æ•°åŒ–ç±»å‹åˆ™è¿›å…¥åˆ°æ¡ä»¶ä½“
    if (genType instanceof ParameterizedType) {
      	//è·å–å‚æ•°ç±»å‹ <> é‡Œé¢çš„é‚£äº›å€¼,ä¾‹å¦‚ Map<K,V> é‚£ä¹ˆå°±å¾—åˆ° [K,V]çš„ä¸€ä¸ªæ•°ç»„
        Type[] params = ((ParameterizedType) genType).getActualTypeArguments();
      	//å°†ç¬¬ä¸€ä¸ªæ³›å‹ç±»å‹èµ‹å€¼ç»™ finalNeedType
        finalNeedType = params[0];
    }
    return finalNeedType;
}
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬éœ€è¦å…ˆè·å–è¿™ä¸ªç±»çš„æ³›å‹çˆ¶ç±»ï¼Œå¦‚æœæ˜¯**å‚æ•°åŒ–ç±»å‹**åˆ™è¿›å…¥åˆ°æ¡ä»¶ä½“ï¼Œè·å–å®é™…çš„æ³›å‹ç±»å‹å¹¶è¿”å›ã€‚å¦‚æœä¸æ˜¯åˆ™ç›´æ¥è¿”å› finalNeedType , é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¸º null äº†

åœ¨ä¾‹1ä¸­ï¼š

```java
SubClass1 subClass1 = new SubClass1();
SubClass2<Integer> subClass2 = new SubClass2<>();
System.out.println(subClass1.getClass().getGenericSuperclass());
System.out.println(subClass2.getClass().getGenericSuperclass());
//è¿è¡Œç¨‹åº æ‰“å°ç»“æœå¦‚ä¸‹
com.dream.java_generic.share.ParentGeneric<java.lang.String>
com.dream.java_generic.share.ParentGeneric<T>
```

å¯ä»¥çœ‹åˆ°è·å–åˆ°äº†æ³›å‹çˆ¶ç±»ï¼Œå› æ­¤ä¼šèµ°åˆ°æ¡ä»¶ä½“é‡Œé¢è·å–åˆ°å®é™…çš„æ³›å‹ç±»å‹å¹¶è¿”å›
åœ¨ä¾‹2ä¸­:

```java
ParentGeneric<String> parentGeneric1 = new ParentGeneric<String>();
System.out.println(parentGeneric1.getClass().getGenericSuperclass());
//è¿è¡Œç¨‹åº æ‰“å°ç»“æœå¦‚ä¸‹
class java.lang.Object
```

å¯ä»¥çœ‹åˆ°è·å–åˆ°çš„æ³›å‹çˆ¶ç±»æ˜¯ ``Object``ï¼Œå› æ­¤è¿›ä¸å»æ¡ä»¶ä½“ï¼Œæ‰€ä»¥å°±è¿”å› null äº†

2. parentGeneric2 åœ¨åˆ›å»ºçš„æ—¶å€™åé¢åŠ äº† {}ï¼Œè¿™å°±ä½¿å¾— parentGeneric2 æˆä¸ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œä¸”çˆ¶ç±»å°±æ˜¯ ParentGenericï¼Œå› ä¸ºåŒ¿åå†…éƒ¨ç±»æ˜¯åœ¨ç¼–è¯‘æ—¶åˆ›å»ºçš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šåˆ›å»ºå¹¶æºå¸¦å…·ä½“çš„æ³›å‹ä¿¡æ¯ï¼Œå› æ­¤ parentGeneric2 å¯ä»¥è·å–å…¶ä¸­çš„æ³›å‹ç±»å‹

é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š**å¦‚æœåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¿å­˜äº†æ³›å‹ç±»å‹åˆ°å­—èŠ‚ç ä¸­ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åå°„è·å–åˆ°ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶ä¼ å…¥å®é™…çš„æ³›å‹ç±»å‹ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¢«æ“¦é™¤ï¼Œåå°„è·å–ä¸åˆ°å½“å‰ä¼ å…¥çš„æ³›å‹å®é™…ç±»å‹**

ä¾‹å­1ä¸­æˆ‘ä»¬æŒ‡å®šäº†æ³›å‹çš„å®é™…ç±»å‹ä¸º Stringï¼Œç¼–è¯‘çš„æ—¶å€™å°±å°†å®ƒå­˜å‚¨åˆ°äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå› æ­¤æˆ‘ä»¬è·å–åˆ°äº†æ³›å‹ç±»å‹ã€‚
ä¾‹å­2ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼ŒåŒæ ·åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¿›è¡Œåˆ›å»ºå¹¶ä¿å­˜äº†å®é™…çš„æ³›å‹åˆ°å­—èŠ‚ç ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è·å–åˆ°ã€‚
è€Œ parentGeneric1 æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œè™½ç„¶ ParentGeneric å£°æ˜çš„æ³›å‹ T åœ¨ç¼–è¯‘æ—¶ä¹Ÿä¿ç•™åœ¨äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å®ƒä¼ å…¥çš„å®é™…ç±»å‹è¢«æ“¦é™¤äº†ï¼Œè¿™ç§æ³›å‹ä¹Ÿæ˜¯æ— æ³•é€šè¿‡åå°„è·å–çš„ï¼Œè®°ä½ä¸Šé¢è¿™æ¡ç»“è®ºï¼Œé‚£ä¹ˆå¯¹äºæ³›å‹ç±»å‹çš„è·å–ä½ å°±å¾—å¿ƒåº”æ‰‹äº†

#### æ³›å‹è·å–ç»éªŒæ€»ç»“

å…¶å®é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥å‘ç°ï¼Œå½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå­ç±»ç»§æ‰¿ä¸€ä¸ªæ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªç±»å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°è¿™ä¸ªæ³›å‹ç±»å‹

```java
//å®šä¹‰ä¸€ä¸ªå­ç±»ç»§æ‰¿æ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªå®é™…çš„ç±»å‹
class SubClass extends ParentGeneric<String>{

}

//åŒ¿åå†…éƒ¨ç±»ï¼Œå…¶å®æˆ‘ä»¬å®šä¹‰çš„è¿™ä¸ªåŒ¿åå†…éƒ¨ç±»ä¹Ÿæ˜¯ä¸€ä¸ªå­ç±»ï¼Œå®ƒç»§æ‰¿äº†æ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªå®é™…çš„ç±»å‹
ParentGeneric<String> parentGeneric2 = new ParentGeneric<String>(){};
```

### è¾¹ç•Œ

è¾¹ç•Œå°±æ˜¯åœ¨æ³›å‹çš„å‚æ•°ä¸Šè®¾ç½®é™åˆ¶æ¡ä»¶ï¼Œè¿™æ ·å¯ä»¥å¼ºåˆ¶æ³›å‹å¯ä»¥ä½¿ç”¨çš„ç±»å‹ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥æŒ‰ç…§è‡ªå·±çš„è¾¹ç•Œç±»å‹æ¥è°ƒç”¨æ–¹æ³•

1. Java ä¸­è®¾ç½®è¾¹ç•Œä½¿ç”¨ ``extends`` å…³é”®å­—ï¼Œå®Œæ•´è¯­æ³•ç»“æ„ï¼š``<T extends Bound>`` ï¼ŒBound å¯ä»¥æ˜¯ç±»å’Œæ¥å£ï¼Œå¦‚æœä¸æŒ‡å®šè¾¹ç•Œï¼Œé»˜è®¤è¾¹ç•Œä¸º``Object``
2. å¯ä»¥è®¾ç½®å¤šä¸ªè¾¹ç•Œï¼Œä¸­é—´ä½¿ç”¨ & è¿æ¥ï¼Œå¤šä¸ªè¾¹ç•Œä¸­åªèƒ½æœ‰**ä¸€ä¸ª**è¾¹ç•Œæ˜¯ç±»ï¼Œä¸”ç±»å¿…é¡»æ”¾åœ¨æœ€å‰é¢ï¼Œç±»ä¼¼è¿™ç§è¯­æ³•ç»“æ„

```java
<T extends ClassBound & InterfaceBound1 & InterfaceBound2>

// ä¸‹é¢æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹ï¼š
abstract class ClassBound{
    public abstract void test1();
}

interface InterfaceBound1{
    void test2();
}

interface InterfaceBound2{
    void test3();
}

class ParentClass <T extends ClassBound & InterfaceBound1 & InterfaceBound2>{
    private final T item;

    public ParentClass(T item) {
        this.item = item;
    }

    public void test1(){
        item.test1();
    }

    public void test2(){
        item.test2();
    }

    public void test3(){
        item.test3();
    }
}

class SubClass extends ClassBound implements InterfaceBound1,InterfaceBound2 {

    @Override
    public void test1() {
        System.out.println("test1");
    }

    @Override
    public void test2() {
        System.out.println("test2");
    }

    @Override
    public void test3() {
        System.out.println("test3");
    }
}

public class Bound {
    public static void main(String[] args) {
        SubClass subClass = new SubClass();
        ParentClass<SubClass> parentClass = new ParentClass<SubClass>(subClass);
        parentClass.test1();
        parentClass.test2();
        parentClass.test3();
    }
}
//æ‰“å°ç»“æœ
test1
test2
test3
```

### é€šé…ç¬¦

#### æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜

æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
Number number = new Integer(666);
ArrayList<Number> numberList = new ArrayList<Integer>();//ç¼–è¯‘å™¨æŠ¥é”™ type mismatch
```

ä¸Šè¿°ä»£ç ï¼Œä¸ºå•¥ ``Number`` çš„å¯¹è±¡å¯ä»¥ç”± ``Integer`` å®ä¾‹åŒ–ï¼Œè€Œ ``ArrayList<Number>`` çš„å¯¹è±¡å´ä¸èƒ½ç”± ``ArrayList<Integer>`` å®ä¾‹åŒ–ï¼Ÿ
è¦æ˜ç™½ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½ï¼Œä»€ä¹ˆæ˜¯æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜

1. æ³›å‹åå˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª ``Class<T>`` çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ A æ˜¯ B çš„å­ç±»ï¼ŒåŒæ—¶ ``Class<A>`` ä¹Ÿæ˜¯ ``Class<B>`` çš„å­ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ ``Class`` åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯åå˜çš„
2. æ³›å‹é€†å˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª ``Class<T>`` çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ A æ˜¯ B çš„å­ç±»ï¼ŒåŒæ—¶ ``Class<B>`` ä¹Ÿæ˜¯ ``Class<A>`` çš„å­ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ Class åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯é€†å˜çš„
3. æ³›å‹ä¸å˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª ``Class<T>``  çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ A æ˜¯ B çš„å­ç±»ï¼ŒåŒæ—¶ ``Class<B>`` å’Œ ``Class<A>`` æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ Class åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯ä¸å˜çš„

å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ ``ArrayList<Number>`` çš„å¯¹è±¡ä¸èƒ½ç”± ``ArrayList<Integer>`` å®ä¾‹åŒ–æ˜¯å› ä¸º ``ArrayList`` å½“å‰çš„æ³›å‹æ˜¯ä¸å˜çš„ï¼Œæˆ‘ä»¬è¦è§£å†³ä¸Šé¢æŠ¥é”™çš„é—®é¢˜ï¼Œå¯ä»¥è®© ``ArrayList`` å½“å‰çš„æ³›å‹æ”¯æŒåå˜ï¼Œå¦‚ä¸‹ï¼š

```java
Number number = new Integer(666);
ArrayList<? extends Number> numberList = new ArrayList<Integer>();
```

#### æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦

æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦è¯­æ³•ç»“æ„ï¼š``<? extends Bound>``ï¼Œä½¿å¾—æ³›å‹æ”¯æŒåå˜ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸Šè¾¹ç•Œæ¥å£æˆ–è€…å®ç°ç±»ï¼Œä½¿ç”¨**ä¸Šè¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªè¯»ï¼Œä¸å¯ä»¥å†™**ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰

```java
public class WildCard {
    public static void main(String[] args) {
        List<Integer> integerList = new ArrayList<Integer>();
        List<Number> numberList = new ArrayList<Number>();
        integerList.add(666);
        numberList.add(123);

        getNumberData(integerList);
        getNumberData(numberList);
    }

    public static void getNumberData(List<? extends Number> data) {
        System.out.println("Number data :" + data.get(0));
    }
}
//æ‰“å°ç»“æœ
Number data: 666
Number data: 123
```

é—®é¢˜ï¼šä¸ºå•¥ä½¿ç”¨ä¸Šè¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªè¯»ï¼Œè€Œä¸èƒ½å†™ï¼Ÿ

- ``<? extends Bound>``ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå®ƒæ— æ³•ç¡®å®šè‡ªå·±å…·ä½“çš„ç±»å‹ï¼Œå› æ­¤ç¼–è¯‘å™¨æ— æ³•éªŒè¯ç±»å‹çš„å®‰å…¨ï¼Œæ‰€ä»¥ä¸èƒ½å†™
- å‡è®¾å¯ä»¥å†™ï¼Œæˆ‘ä»¬å‘å®ƒé‡Œé¢æ·»åŠ è‹¥å¹²ä¸ªå­ç±»ï¼Œç„¶åç”¨ä¸€ä¸ªå…·ä½“çš„å­ç±»å»æ¥æ”¶ï¼ŒåŠ¿å¿…ä¼šé€ æˆç±»å‹è½¬æ¢å¼‚å¸¸

#### æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦

æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦è¯­æ³•ç»“æ„ï¼š``<? super Bound>``ï¼Œä½¿å¾—æ³›å‹æ”¯æŒé€†å˜ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸‹è¾¹ç•Œæ¥å£æˆ–è€…å…¶çˆ¶æ¥å£ï¼Œä½¿ç”¨**ä¸‹è¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªå†™ï¼Œä¸å»ºè®®è¯»**

```java
public class WildCard {

    public static void main(String[] args) {
        List<Number> numberList = new ArrayList<Number>();
        List<Object> objectList = new ArrayList<Object>();
        setNumberData(numberList);
        setNumberData(objectList);
    }
    
    public static void setNumberData(List<? super Number> data) {
        Number number = new Integer(666);
        data.add(number);
    }
}
```

é—®é¢˜ï¼šä¸ºå•¥ä½¿ç”¨ä¸‹è¾¹ç•Œé€šé…ç¬¦çš„å˜é‡å¯ä»¥å†™ï¼Œè€Œä¸å»ºè®®è¯»ï¼Ÿ

- ``<? super Bound>``ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œè™½ç„¶å®ƒä¹Ÿæ— æ³•ç¡®å®šè‡ªå·±å…·ä½“çš„ç±»å‹ï¼Œä½†æ ¹æ®å¤šæ€ï¼Œå®ƒèƒ½ä¿è¯è‡ªå·±æ·»åŠ çš„å…ƒç´ æ˜¯å®‰å…¨çš„ï¼Œå› æ­¤å¯ä»¥å†™
- è·å–å€¼çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ª ``Object`` ç±»å‹çš„å€¼ï¼Œè€Œä¸èƒ½è·å–å®é™…ç±»å‹å‚æ•°ä»£è¡¨çš„ç±»å‹ï¼Œå› æ­¤å»ºè®®ä¸è¦å»è¯»ï¼Œå¦‚æœä½ å®åœ¨è¦å»è¯»ä¹Ÿè¡Œï¼Œä½†æ˜¯è¦æ³¨æ„ç±»å‹è½¬æ¢å¼‚å¸¸

#### æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦

æ— è¾¹ç•Œé€šé…ç¬¦çš„è¯­æ³•ç»“æ„ï¼š``<?>``ï¼Œå®é™…ä¸Šå®ƒç­‰ä»·äº ``<? extends Object>``ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„ä¸Šè¾¹ç•Œæ˜¯ ``Object`` æˆ–å…¶å­ç±»ï¼Œå› æ­¤ä½¿ç”¨æ— ç•Œé€šé…ç¬¦çš„å˜é‡åŒæ ·åªè¯»ï¼Œä¸èƒ½å†™ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰

```java
public class WildCard {
  
    public static void main(String[] args) {
        List<String> stringList = new ArrayList<String>();
        List<Number> numberList = new ArrayList<Number>();
        List<Integer> integerList = new ArrayList<Integer>();
        stringList.add("erdai");
        numberList.add(666);
        integerList.add(123);
        getData(stringList);
        getData(numberList);
        getData(integerList);
    }
    
     public static void getData(List<?> data) {
        System.out.println("data: " + data.get(0));
    }
}
//æ‰“å°ç»“æœ
data: erdai
data: 666
data: 123
```

#### PECS åŸåˆ™

æ³›å‹ä»£ç çš„è®¾è®¡ï¼Œåº”éµå¾ªPECSåŸåˆ™ï¼ˆProducer extends Consumer superï¼‰ï¼š

1. å¦‚æœåªéœ€è¦è·å–å…ƒç´ ï¼Œä½¿ç”¨ <? extends T>
2. å¦‚æœåªéœ€è¦å­˜å‚¨ï¼Œä½¿ç”¨ <? super T>

```java
//è¿™æ˜¯ Collections.java ä¸­ copy æ–¹æ³•çš„æºç 
public static <T> void copy(List<? super T> dest, List<? extends T> src) {
      //...
}
```

è¿™æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ï¼Œsrc è¡¨ç¤ºåŸå§‹é›†åˆï¼Œä½¿ç”¨äº† ``<? extends T>``ï¼Œåªèƒ½ä»ä¸­è¯»å–å…ƒç´ ï¼Œdest è¡¨ç¤ºç›®æ ‡é›†åˆï¼Œåªèƒ½å¾€é‡Œé¢å†™å…ƒç´ ï¼Œå……åˆ†çš„ä½“ç°äº† PECS åŸåˆ™

#### ä½¿ç”¨é€šé…ç¬¦æ€»ç»“

1. å½“ä½ åªæƒ³è¯»å–å€¼çš„æ—¶å€™ï¼Œä½¿ç”¨ ``<? extends T>``
2. å½“ä½ åªæƒ³å†™å…¥å€¼çš„æ—¶å€™ï¼Œä½¿ç”¨ ``<? super T>``
3. å½“ä½ æ—¢æƒ³è¯»å–å€¼åˆæƒ³å†™å…¥å€¼çš„æ—¶å€™ï¼Œå°±ä¸è¦ä½¿ç”¨é€šé…

### æ³›å‹çš„é™åˆ¶

1. æ³›å‹ä¸èƒ½æ˜¾å¼åœ°å¼•ç”¨åœ¨è¿è¡Œæ—¶ç±»å‹çš„æ“ä½œé‡Œï¼Œå¦‚ ``instanceof`` æ“ä½œå’Œ ``new`` è¡¨è¾¾å¼ï¼Œè¿è¡Œæ—¶ç±»å‹åªé€‚ç”¨äºåŸç”Ÿç±»å‹

```java
public class GenericLimitedClass<T> {
    private void test(){
        String str = "";
      	//ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æ“ä½œ
        if(str instanceof T){

        }
        //ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æ“ä½œ
        T t = new T();
    }
}
```

2. ä¸èƒ½åˆ›å»ºæ³›å‹ç±»å‹çš„æ•°ç»„ï¼Œåªå¯ä»¥å£°æ˜ä¸€ä¸ªæ³›å‹ç±»å‹çš„æ•°ç»„å¼•ç”¨

```java
public class GenericLimitedClass<T> {
    private void test(){
       GenericLimitedClass<Test>[] genericLimitedClasses;
       //ç¼–è¯‘å™¨ä¸å…è®¸
       genericLimitedClasses = new GenericLimitedClass<Test>[10];
    }
}
```

3. ä¸èƒ½å£°æ˜ç±»å‹ä¸ºæ³›å‹çš„é™æ€å­—æ®µ

```java
public class GenericLimitedClass<T> {
    //ç¼–è¯‘å™¨ä¸å…è®¸
    private static T t;
}
```

4. æ³›å‹ç±»ä¸å¯ä»¥ç›´æ¥æˆ–é—´æ¥åœ°ç»§æ‰¿ Throwable

```java
//ç¼–è¯‘å™¨ä¸å…è®¸
public class GenericLimitedClass<T> extends Throwable {
   
}
```

5. æ–¹æ³•ä¸­ä¸å¯ä»¥æ•è·ç±»å‹å‚æ•°çš„å®ä¾‹ï¼Œä½†æ˜¯å¯ä»¥åœ¨ throws è¯­å¥ä¸­ä½¿ç”¨ç±»å‹å‚æ•°

```java
public class GenericLimitedClass<T> {
    private <T extends Throwable> void test1() throws T{
        try {

        //ç¼–è¯‘å™¨ä¸å…è®¸
        }catch (T exception){

        }
    }
}
```

6. ä¸€ä¸ªç±»ä¸å¯ä»¥é‡è½½åœ¨ç±»å‹æ“¦é™¤åæœ‰åŒæ ·æ–¹æ³•ç­¾åçš„æ–¹æ³•

```java
public class GenericLimitedClass<T> {
    //ç¼–è¯‘å™¨ä¸å…è®¸
    private void test2(List<String> stringList){

    }

    private void test2(List<Integer> integerList){

    }
}
```

### é—®é¢˜

1. ç±»å‹è¾¹ç•Œå’Œé€šé…ç¬¦è¾¹ç•Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
ç±»å‹è¾¹ç•Œå¯ä»¥æœ‰å¤šä¸ªï¼Œé€šé…ç¬¦è¾¹ç•Œåªèƒ½æœ‰ä¸€ä¸ª

2. ``List<?>`` å’Œ ``List<Object>`` ä¸€æ ·å—ï¼Ÿ
ä¸ä¸€æ ·

- ``List<Object>`` å¯è¯»å†™ï¼Œä½†æ˜¯ ``List<?>`` åªè¯»
- ``List<?>``å¯ä»¥æœ‰å¾ˆå¤šå­ç±»ï¼Œä½†æ˜¯ ``List<Object>`` æ²¡æœ‰

### æ³›å‹çš„åŸºæœ¬ç”¨æ³•

1. åœ¨ Kotlin ä¸­æˆ‘ä»¬å®šä¹‰å’Œä½¿ç”¨æ³›å‹çš„æ–¹å¼å¦‚ä¸‹ï¼š

```kotlin
//1ã€å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»ï¼Œåœ¨ç±»ååé¢ä½¿ç”¨ <T> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªç±»å®šä¹‰ä¸€ä¸ªæ³›å‹
class MyClass<T>{
  	fun method(params: T) {
      
    }
}
//æ³›å‹è°ƒç”¨
val myClass = MyClass<Int>()
myClass.method(12)

//2ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•åçš„å‰é¢åŠ ä¸Š <T> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ–¹æ³•å®šä¹‰ä¸€ä¸ªæ³›å‹
class MyClass{
    fun <T> method(params: T){

    }
}
//æ³›å‹è°ƒç”¨
val myClass = MyClass()
myClass.method<Int>(12)
//æ ¹æ® Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ³›å‹ç»™çœç•¥
myClass.method(12)

//3ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œåœ¨æ¥å£ååé¢åŠ ä¸Š <T> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ¥å£å®šä¹‰ä¸€ä¸ªæ³›å‹
interface MyInterface<T>{
    fun interfaceMethod(params: T)
}
```

å¯¹æ¯” Java ä¸­å®šä¹‰æ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šåœ¨å®šä¹‰ç±»å’Œæ¥å£æ³›å‹ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œåœ¨å®šä¹‰æ–¹æ³•æ³›å‹æ—¶ï¼ŒKotlin æ˜¯åœ¨æ–¹æ³•åå‰é¢æ·»åŠ æ³›å‹ï¼Œè€Œ Java æ˜¯åœ¨è¿”å›å€¼å‰é¢æ·»åŠ æ³›å‹

### è¾¹ç•Œ

1. ä¸ºæ³›å‹æŒ‡å®šè¾¹ç•Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ``<T : Class>`` è¿™ç§è¯­æ³•ç»“æ„ï¼Œå¦‚æœä¸æŒ‡å®šæ³›å‹çš„è¾¹ç•Œï¼Œé»˜è®¤ä¸º ``Any?``
2. å¦‚æœæœ‰å¤šä¸ªè¾¹ç•Œï¼Œå¯ä»¥ä½¿ç”¨ ``where`` å…³é”®å­—ï¼Œä¸­é—´ä½¿ç”¨``:`` éš”å¼€ï¼Œå¤šä¸ªè¾¹ç•Œä¸­åªèƒ½æœ‰ä¸€ä¸ªè¾¹ç•Œæ˜¯ç±»ï¼Œä¸”ç±»å¿…é¡»æ”¾åœ¨æœ€å‰é¢

```kotlin
//æƒ…å†µ1 å•ä¸ªè¾¹ç•Œ
class MyClass1<T : Number> {

    var data: T? = null

    fun <T : Number> method(params: T) {

    }
}

//æƒ…å†µ2 å¤šä¸ªè¾¹ç•Œä½¿ç”¨ where å…³é”®å­—
open class Animal
interface Food
interface Food2

class MyClass2<T> where T : Animal, T : Food, T : Food2 {

    fun <T> method(params: T) where T : Animal, T : Food, T : Food2 {

    }
}
```

### æ³›å‹å®åŒ–

æ³›å‹å®åŒ–åœ¨ Java ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼ŒKotlin ä¸­ä¹‹æ‰€ä»¥èƒ½å®ç°æ³›å‹å®åŒ–ï¼Œæ˜¯å› ä¸ºä½¿ç”¨çš„å†…è”å‡½æ•°ä¼šå¯¹ä»£ç è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆåœ¨å†…è”å‡½æ•°ä¸­ä½¿ç”¨æ³›å‹ï¼Œæœ€ç»ˆä¹Ÿä¼šä½¿ç”¨å®é™…çš„ç±»å‹è¿›è¡Œæ›¿æ¢

1. ä½¿ç”¨å†…è”å‡½æ•°é…åˆ ``reified`` å…³é”®å­—å¯¹æ³›å‹è¿›è¡Œå®åŒ–ï¼Œè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š

```kotlin
inline fun <reified T> getGenericType() {
  
}
```

å®æ“ä¸€ä¸‹ï¼š

```kotlin
inline fun <reified T> getGenericType() = T::class.java

fun main() {
    //æ³›å‹å®åŒ– è¿™ç§æƒ…å†µåœ¨ Java æ˜¯ä¼šè¢«ç±»å‹æ“¦é™¤çš„
    val result1 = getGenericType<String>()
    val result2 = getGenericType<Number>()
    println(result1)
    println(result2)
}
//æ‰“å°ç»“æœ
class java.lang.String
class java.lang.Number
```

2. å®é™…åº”ç”¨

åœ¨æˆ‘ä»¬è·³è½¬ Activity çš„æ—¶å€™é€šå¸¸ä¼šè¿™ä¹ˆæ“ä½œ

```kotlin
val intent = Intent(mContext,TestActivity::class.java)
mContext.startActivity(intent)
```

æœ‰æ²¡æœ‰æ„Ÿè§‰å†™è¿™ç§ TestActivity::class.java çš„è¯­æ³•å¾ˆéš¾å—ï¼Œåæ­£æˆ‘æ˜¯è§‰å¾—å¾ˆéš¾å—ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ³›å‹å®åŒ–æ¢ä¸€ç§å†™æ³•ï¼š

```kotlin
//å®šä¹‰ä¸€ä¸ªé¡¶å±‚å‡½æ•°
inline fun <reified T> startActivity(mContext: Context){
    val intent = Intent(mContext,T::class.java)
    mContext.startActivity(intent)
}

//ä½¿ç”¨çš„æ—¶å€™
startActivity<TestActivity>(mContext)
```

è¿™ç§å†™æ³•æ˜¯ä¸æ˜¯æ¸…çˆ½äº†å¾ˆå¤šï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬è·³è½¬ Activity çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæºå¸¦ä¸€äº›å‚æ•°ï¼Œå¦‚ä¸‹ï¼š

```kotlin
val intent  = Intent(mContext,TestActivity::class.java)
intent.putExtra("params1","erdai")
intent.putExtra("params2","666")
mContext.startActivity(intent)
```

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å¢åŠ ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œä½¿ç”¨ Lambda è¡¨è¾¾å¼å»è°ƒç”¨ï¼Œå¦‚ä¸‹ï¼š

```kotlin
inline fun <reified T> startActivity(mContext: Context, block: Intent.() -> Unit){
    val intent = Intent(mContext,T::class.java)
    intent.block()
    mContext.startActivity(intent)
}

//ä½¿ç”¨çš„æ—¶å€™
startActivity<SecondActivity>(mContext){       
  putExtra("params1","erdai")     
  putExtra("params2","666")
}
```

### æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜

1. æ³›å‹åå˜çš„è¯­æ³•è§„åˆ™ï¼š``<out T>`` ç±»ä¼¼äº Java çš„  ``<? extends Bound>``ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸Šè¾¹ç•Œæ¥å£æˆ–è€…å®ç°ç±»ï¼Œåå˜çš„æ³›å‹å˜é‡åªè¯»ï¼Œä¸å¯ä»¥å†™ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰

```kotlin
open class Person
class Student: Person()
class Teacher: Person()

class SimpleData<out T>{

}

fun main() {
    val person: Person = Student()
    val personGeneric: SimpleData<Person> = SimpleData<Student>()
    val list1: ArrayList<out Person> = ArrayList<Student>()
}
```

2. æ³›å‹é€†å˜çš„è¯­æ³•è§„åˆ™ï¼š``<in T>`` ç±»ä¼¼äº Java çš„ ``<? super Bound>``ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸‹è¾¹ç•Œæ¥å£æˆ–è€…å…¶çˆ¶æ¥å£ï¼Œé€†å˜çš„æ³›å‹å˜é‡åªèƒ½å†™ï¼Œä¸å»ºè®®è¯»

```kotlin
open class Person
class Student: Person()
class Teacher: Person()

class SimpleData<in T>{

}

fun main() {
    val person1: Person = Student()
    val personGeneric1: SimpleData<Student> = SimpleData<Person>()
    val list2: ArrayList<in Person> = ArrayList<Any>()
}
```

5. æ³›å‹ä¸å˜å’Œ Java è¯­æ³•è§„åˆ™æ˜¯ä¸€æ ·çš„

```kotlin
open class Person
class Student: Person()
class Teacher: Person()

class SimpleData<T>{

}

fun main() {
    val person: Person = Student()
    //ç¼–è¯‘å™¨ä¸å…è®¸
    val personGeneric: SimpleData<Person> = SimpleData<Student>()
}
```

6. Kotlin ä½¿ç”¨ ``<*>`` è¿™ç§è¯­æ³•ç»“æ„æ¥è¡¨ç¤ºæ— ç•Œé€šé…ç¬¦ï¼Œå®ƒç­‰ä»·äº ``<out Any>``ï¼Œç±»ä¼¼äº Java ä¸­çš„ ``<?>``ï¼Œåœ¨å®šä¹‰ä¸€ä¸ªç±»çš„æ—¶å€™ä½ å¦‚æœä½¿ç”¨``<out T : Number>`` ï¼Œé‚£ä¹ˆ * å°±ç›¸å½“äº ``<out Number>``

```kotlin
class KotlinGeneric<out T: Number>{

}

//æ— ç•Œé€šé…ç¬¦ ç­‰ä»·äº <out Any>ï¼Œä½†æ˜¯æˆ‘è¿™ä¸ªç±»é™åˆ¶äº†æ³›å‹è¾¹ç•Œä¸º Numberï¼Œå› æ­¤è¿™é‡Œç›¸å½“äº <out Number>
fun main() {
    val noBound: KotlinGeneric<*> = KotlinGeneric<Int>()
 
    //æ ¹æ®åå˜è§„åˆ™ ç¼–è¯‘å™¨ä¸å…è®¸è¿™æ ·å†™
    val noBound: KotlinGeneric<*> = KotlinGeneric<Any>()
}
```

## åç¨‹

### åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“

Kotlin å¹¶æ²¡æœ‰æŠŠåç¨‹çº³å…¥æ ‡å‡†åº“ä¸­ï¼Œè€Œæ˜¯ä»¥ä¾èµ–åº“çš„å½¢å¼æä¾›çš„ï¼Œè¿™æ˜¯ä¸€å¼  Kotlin åç¨‹çš„ç”Ÿæ€å›¾ï¼š

![åç¨‹](image-3.png)

ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°ï¼ŒKotlin æ ‡å‡†åº“å’Œåç¨‹ä¾èµ–åº“æ‰€æä¾›çš„ä¸œè¥¿ï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Kotlin é¡¹ç›®çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šå¯¼å…¥æ ‡å‡†åº“çš„ä¾èµ–ï¼Œå› æ­¤è¿™é‡Œæ·»åŠ å¦‚ä¸‹åç¨‹ä¾èµ–åº“å°±å¯ä»¥äº†ï¼Œæœ€æ–°åç¨‹ä¾èµ–åº“ç‰ˆæœ¬å¯ä»¥ç‚¹å‡»ä¼ é€é—¨æŸ¥çœ‹ï¼š

```kotlin
//åç¨‹æ ¸å¿ƒåº“
implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.3'
//è¿™ä¸ªåº“åœ¨ Android é¡¹ç›®ä¸­æ‰ä¼šç”¨åˆ°
implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.3'
```

### ä½¿ç”¨ GlobalScope.launch å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹

``GlobalScope.launch`` å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œè¿™æ ·ä¼ é€’ç»™ ``launch`` å‡½æ•°çš„ä»£ç å—å°±æ˜¯åœ¨åç¨‹ä¸­è¿è¡Œäº†
``GlobalScope.launch`` å‡½æ•°åˆ›å»ºçš„æ˜¯ä¸€ä¸ª**é¡¶çº§åç¨‹**ï¼Œå½“åº”ç”¨ç¨‹åºè¿è¡Œç»“æŸæ—¶ä¹Ÿä¼šè·Ÿç€ä¸€èµ·ç»“æŸ
``GlobalScope.launch`` å‡½æ•°åˆ›å»ºçš„åç¨‹å’Œçº¿ç¨‹æœ‰ç‚¹åƒï¼Œå› ä¸ºçº¿ç¨‹æ²¡æœ‰é¡¶çº§è¿™ä¸€è¯´ï¼Œæ‰€ä»¥æ°¸è¿œéƒ½æ˜¯é¡¶çº§çš„

```kotlin
fun main() {
    GlobalScope.launch {
        println("codes run in coroutine scope")
    }  
}
```

ä¸Šé¢è¿™æ®µç®€çŸ­çš„ä»£ç å°±æ˜¯å¼€å¯äº†ä¸€ä¸ªåç¨‹ï¼Œå¾ˆç®€å•å§ï¼Œä¸€è¡Œä»£ç å°±å®ç°äº†ï¼Œåç¨‹ä¹Ÿä¸è¿‡å¦‚æ­¤å•ŠğŸ˜‚ã€‚å®é™…ä¸‹é¢è¿™æ®µä»£ç èƒŒååŒ…å«ç€æˆå¨çš„çŸ¥è¯†ç‚¹ï¼š

1. åç¨‹ä½œç”¨åŸŸ
2. åç¨‹ä½œç”¨åŸŸçš„æ‰©å±•å‡½æ•°
3. åç¨‹ä¸Šä¸‹æ–‡
4. åç¨‹å¯åŠ¨æ¨¡å¼

å¯èƒ½å¤§å®¶ä¼šæœ‰ç‚¹ç–‘æƒ‘ï¼ŒåŒºåŒºä¸€è¡Œä»£ç ï¼Œæ€ä¹ˆå¯èƒ½ä¼šæ¶‰åŠè¿™ä¹ˆå¤šä¸œè¥¿ï¼Ÿä¸ä¿¡æˆ‘ä»¬åœ¨ç‚¹å‡» launch å‡½æ•°çœ‹ä¸‹å®ƒçš„æºç ï¼š

```kotlin
// launch å‡½æ•°æºç 
public fun CoroutineScope.launch(
    context: CoroutineContext = EmptyCoroutineContext,
    start: CoroutineStart = CoroutineStart.DEFAULT,
    block: suspend CoroutineScope.() -> Unit
): Job {
  	//...
}
```

å¯ä»¥çœ‹åˆ°ï¼Œ``launch`` å‡½æ•°æ˜¯ ``CoroutineScope`` å³åç¨‹ä½œç”¨åŸŸçš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œå®ƒé‡Œé¢æœ‰ä¸‰ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°ï¼š ``CoroutineContext`` å³åç¨‹ä¸Šä¸‹æ–‡ï¼Œæœ‰é»˜è®¤å€¼ã€‚ç¬¬äºŒä¸ªå‚æ•°ï¼š``CoroutineStart`` å³åç¨‹å¯åŠ¨æ¨¡å¼ï¼Œæœ‰é»˜è®¤å€¼ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå‡½æ•°ç±»å‹å‚æ•°ï¼Œæ— é»˜è®¤å€¼ã€‚å› æ­¤``launch``å‡½æ•°åœ¨å®é™…è°ƒç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ª ``Lambda`` è¡¨è¾¾å¼å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¼ å‚å»è¦†ç›–é»˜è®¤å€¼
å¥½äº†ï¼ŒçŸ¥é“å®ƒé‡Œé¢æ¶‰åŠåˆ°è¿™ä¹ˆå¤šçŸ¥è¯†ç‚¹ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¿›è¡Œå„ä¸ªå‡»ç ´ï¼Œä¸‹é¢æˆ‘ä¼šè®²è§£åç¨‹ä½œç”¨åŸŸï¼Œå…¶ä»–çš„åœ¨è¿™ç¯‡æ–‡ç« åˆ†æå¯èƒ½æœ‰ç‚¹æ¯ç‡¥ï¼Œæˆ‘ä»¬æ”¾åˆ°ä¸‹ç¯‡æ–‡ç« åœ¨æ¥åˆ†æ

### åç¨‹ä½œç”¨åŸŸ

å›åˆ°æœ€å¼€å§‹é‚£æ®µä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹åˆ° ``GlobalScope`` è¿™ä¸ªä¸œä¸œï¼Œç‚¹è¿›å»çœ‹ä¸€çœ¼å®ƒçš„æºç ï¼š

```kotlin
public object GlobalScope : CoroutineScope {
    /**
     * Returns [EmptyCoroutineContext].
     */
    override val coroutineContext: CoroutineContext
        get() = EmptyCoroutineContext
}
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š``GlobalScope`` æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œå®ç°äº† ``CoroutineScope`` è¿™ä¸ªæ¥å£ï¼Œå¹¶é‡å†™äº† ``coroutineContext`` è¿™ä¸ªå±æ€§

#### CoroutineScope

æ¥ç€ç‚¹è¿›å» ``CoroutineScope`` è¿™ä¸ªä¸œä¸œçœ‹ä¸€ä¸‹ï¼š

```kotlin
public interface CoroutineScope {
    public val coroutineContext: CoroutineContext
}
```

1. æºç é‡Œé¢æœ‰ä¸€æ®µå¯¹å®ƒçš„æ³¨é‡Šï¼Œç¿»è¯‘è¿‡æ¥å¤§è‡´å°±æ˜¯ï¼š``CoroutineScope`` èƒ½å¤Ÿå®šä¹‰ä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œæ¯ä¸ªåç¨‹æ„å»ºå™¨åƒ ``launch``, ``async`` éƒ½æ˜¯å®ƒçš„ä¸€ä¸ªæ‰©å±•ã€‚
2. å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢æŒæœ‰ä¸€ä¸ª ``CoroutineContext`` å³åç¨‹ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç±»å®ç°å®ƒï¼Œè®©è¯¥ç±»æˆä¸ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ

#### GlobalScope

ç°åœ¨å›åˆ° ``GlobalScope`` è¿™ä¸ªä¸œä¸œï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥æŠŠå®ƒè§£é‡Šæ¸…æ¥šäº†ï¼šå› ä¸º ``GlobalScope`` æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œä¸”å®ç°äº†``CoroutineScope``ï¼Œæ‰€æœ‰å®ƒæ‹¥æœ‰äº†å…¨å±€çš„åç¨‹ä½œç”¨åŸŸï¼Œä¸”åœ¨æ•´ä¸ª JVM è™šæ‹Ÿæœºä¸­åªæœ‰ä¸€ä»½å¯¹è±¡å®ä¾‹ã€‚å› ä¸ºå®ƒçš„ç”Ÿå‘½å‘¨æœŸè´¯ç©¿æ•´ä¸ª JVMï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™éœ€è¦è­¦æƒ•å†…å­˜æ³„æ¼ã€‚ä¸Šé¢ä»£ç ä¸­è°ƒç”¨çš„ ``GlobalScope.launch``ï¼Œå®è´¨ä¸Šæ˜¯è°ƒç”¨äº† ``CoroutineScope`` çš„ ``launch`` æ‰©å±•å‡½æ•°

#### åç¨‹ä½œç”¨åŸŸä½œç”¨

é‚£ä¹ˆè¿™é‡Œä½ å¿ƒé‡Œæ˜¯å¦ä¼šæœ‰ä¸ªç–‘é—®ï¼šæ‹¥æœ‰åç¨‹ä½œç”¨åŸŸæœ‰å•¥ç”¨å‘¢ï¼Ÿä½œç”¨å¯å¤§äº†

åç¨‹å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸä¸­æ‰èƒ½å¯åŠ¨ï¼Œåç¨‹ä½œç”¨åŸŸä¸­å®šä¹‰äº†ä¸€äº›çˆ¶å­åç¨‹çš„è§„åˆ™ï¼ŒKotlin åç¨‹é€šè¿‡åç¨‹ä½œç”¨åŸŸæ¥ç®¡æ§åŸŸä¸­çš„æ‰€æœ‰åç¨‹

åç¨‹ä½œç”¨åŸŸé—´å¯å¹¶åˆ—æˆ–åŒ…å«ï¼Œç»„æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œè¿™å°±æ˜¯ Kotlin åç¨‹ä¸­çš„ç»“æ„åŒ–å¹¶å‘ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š

#### ä½œç”¨åŸŸç»†åˆ†

æœ‰ä¸‹è¿°ä¸‰ç§

1. é¡¶çº§ä½œç”¨åŸŸï¼šæ²¡æœ‰çˆ¶åç¨‹çš„åç¨‹æ‰€åœ¨çš„ä½œç”¨åŸŸ
2. ååŒä½œç”¨åŸŸï¼šåç¨‹ä¸­å¯åŠ¨æ–°åç¨‹(å³å­åç¨‹)ï¼Œæ­¤æ—¶å­åç¨‹æ‰€åœ¨çš„ä½œç”¨åŸŸé»˜è®¤ä¸ºååŒä½œç”¨åŸŸï¼Œå­åç¨‹æŠ›å‡ºçš„æœªæ•è·å¼‚å¸¸éƒ½å°†ä¼ é€’ç»™çˆ¶åç¨‹å¤„ç†ï¼Œçˆ¶åç¨‹åŒæ—¶ä¹Ÿä¼šè¢«å–æ¶ˆï¼›
3. ä¸»ä»ä½œç”¨åŸŸï¼šä¸ååŒä½œç”¨åŸŸçˆ¶å­å…³ç³»ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äºå­åç¨‹å‡ºç°æœªæ•è·å¼‚å¸¸æ—¶ä¸ä¼šå‘ä¸Šä¼ é€’ç»™çˆ¶åç¨‹

#### çˆ¶å­åç¨‹é—´çš„è§„åˆ™

1. çˆ¶åç¨‹å¦‚æœå–æ¶ˆæˆ–ç»“æŸäº†ï¼Œé‚£ä¹ˆå®ƒä¸‹é¢çš„æ‰€æœ‰å­åç¨‹å‡è¢«å–æ¶ˆæˆ–ç»“æŸ
2. çˆ¶åç¨‹éœ€ç­‰å¾…å­åç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæœ€ç»ˆè¿›å…¥å®ŒæˆçŠ¶æ€ï¼Œè€Œä¸ç®¡çˆ¶åç¨‹æœ¬èº«çš„ä»£ç å—æ˜¯å¦å·²æ‰§è¡Œå®Œ
3. å­åç¨‹ä¼šç»§æ‰¿çˆ¶åç¨‹ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ ï¼Œå¦‚æœè‡ªèº«æœ‰ç›¸åŒ Key çš„æˆå‘˜ï¼Œåˆ™è¦†ç›–å¯¹åº” Keyï¼Œè¦†ç›–æ•ˆæœä»…åœ¨è‡ªèº«èŒƒå›´å†…æœ‰æ•ˆ
å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œå…³äºåç¨‹ä½œç”¨åŸŸä½ æ˜¯å¦ç†è§£äº†å‘¢ï¼Ÿå¦‚æœä¸æ˜ç™½ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œæˆ–è®¸éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œä½ çš„é—®é¢˜å°±å¼•åˆƒè€Œè§£äº†

### ä½¿ç”¨ Delay å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ

``delay`` å‡½æ•°æ˜¯ä¸€ä¸ªéé˜»å¡å¼æŒ‚èµ·å‡½æ•°ï¼Œå®ƒå¯ä»¥è®©å½“å‰åç¨‹å»¶è¿Ÿåˆ°æŒ‡å®šçš„æ—¶é—´æ‰§è¡Œï¼Œä¸”åªèƒ½åœ¨åç¨‹çš„ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨

å¯¹æ¯”``Thread.sleep()`` å‡½æ•°ï¼Œ``delay`` å‡½æ•°åªä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶ä¸ä¼šå½±å“å…¶ä»–åç¨‹çš„è¿è¡Œï¼Œè€Œ ``Thread.sleep()`` å‡½æ•°ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ä¸‹çš„æ‰€æœ‰åç¨‹éƒ½ä¼šè¢«é˜»å¡

```kotlin
fun main() {
\    GlobalScope.launch {
        println("codes run in coroutine scope")
    }  
}
```

ä¸Šè¿°ä»£ç ä½ è¿è¡Œä¸€ä¸‹ä¼šå‘ç°æ—¥å¿—æ‰“å°ä¸å‡ºæ¥ï¼Œå°æœ‹å‹ï¼Œä½ æ˜¯å¦æœ‰å¾ˆå¤šé—®å·ï¼ŸğŸ˜‚
è¿™æ˜¯å› ä¸ºä»£ç å—ä¸­çš„ä»£ç è¿˜æ²¡æ¥å¾—åŠæ‰§è¡Œï¼Œåº”ç”¨ç¨‹åºå°±ç»“æŸäº†ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç¨‹åºå»¶è¿Ÿä¸€æ®µæ—¶é—´åœ¨ç»“æŸï¼Œå¦‚ä¸‹ï¼š

```kotlin
fun main() {
    GlobalScope.launch {
        println("codes run in coroutine scope")
    }  
    Thread.sleep(1000)
}
//æ‰“å°ç»“æœ
codes run in coroutine scope
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬è®©ä¸»çº¿ç¨‹é˜»å¡äº† 1 ç§’é’Ÿåœ¨æ‰§è¡Œï¼Œå› æ­¤ä»£ç å—ä¸­çš„ä»£ç å¾—åˆ°äº†æ‰§è¡Œã€‚å…¶å®è¿™ç§å†™æ³•è¿˜æ˜¯å­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œå¦‚æœæˆ‘è®©ä»£ç å—ä¸­çš„ä»£ç åœ¨ 1 ç§’é’Ÿå†…ä¸èƒ½è¿è¡Œç»“æŸï¼Œé‚£ä¹ˆå°±ä¼šè¢«å¼ºåˆ¶ä¸­æ–­ï¼š

```kotlin
fun main() {
    GlobalScope.launch {
        println("codes run in coroutine scope")
      	delay(1500)
        println("codes run in coroutine scope finished")
    }  
    Thread.sleep(1000)
}
//æ‰“å°ç»“æœ
codes run in coroutine scope
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬åœ¨ä»£ç å—ä¸­åŠ å…¥äº†ä¸€ä¸ª ``delay`` å‡½æ•°ï¼Œå¹¶åœ¨å…¶ä¹‹ååˆæ‰“å°äº†ä¸€è¡Œæ—¥å¿—ã€‚é‚£ä¹ˆå½“å‰åç¨‹ä¼šæŒ‚èµ· 1.5 ç§’ï¼Œè€Œä¸»çº¿ç¨‹å´åªé˜»å¡äº† 1 ç§’ï¼Œé‚£ä¹ˆé‡æ–°è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œæ–°å¢çš„è¿™æ¡æ—¥å¿—å¹¶æ²¡æœ‰æ‰“å°å‡ºæ¥ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æ¥å¾—åŠè¿è¡Œï¼Œç¨‹åºå°±ç»“æŸäº†ã€‚
é‚£æœ‰åŠæ³•è®©åç¨‹ä¸­æ‰€æœ‰çš„ä»£ç éƒ½æ‰§è¡Œå®Œäº†ä¹‹ååœ¨ç»“æŸå—ï¼ŸğŸ¤”ï¸
ç­”ï¼šæœ‰çš„ï¼Œä½¿ç”¨ runBlocking å‡½æ•°

### ä½¿ç”¨ runBlocking å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ

runBlocking å‡½æ•°å¯ä»¥ä¿è¯åœ¨åç¨‹ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹æ²¡æœ‰å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ä¸€ç›´é˜»å¡å½“å‰çº¿ç¨‹

æ³¨æ„ï¼šrunBlocking å‡½æ•°é€šå¸¸åªèƒ½åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåœ¨æ­£å¼ç¯å¢ƒä¸­ä½¿ç”¨ä¼šå®¹æ˜“äº§ç”Ÿä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜

```kotlin
fun main() {
    runBlocking {
       println("codes run in coroutine scope")
       delay(1500)
       println("codes run in coroutine scope finished")
    }
}
//æ‰“å°ç»“æœ
codes run in coroutine scope
codes run in coroutine scope finished
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨äº† runBlocking å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤æ¡æ—¥å¿—éƒ½èƒ½å¤Ÿæ­£å¸¸æ‰“å°å‡ºæ¥äº†ã€‚åˆ°äº†è¿™é‡Œæˆ‘å¿ƒé‡Œä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼šä¸Šé¢çš„ä»£ç éƒ½æ˜¯è·‘åœ¨åŒä¸€ä¸ªåç¨‹ä¸­ï¼Œæˆ‘èƒ½ä¸èƒ½åˆ›å»ºå¤šä¸ªåç¨‹åŒæ—¶è·‘å‘¢ï¼Ÿ
ç­”ï¼šå¯ä»¥çš„ï¼Œä½¿ç”¨ launch å‡½æ•°

### ä½¿ç”¨ launch å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹

ä¸Šé¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œ``launch`` å‡½æ•°æ˜¯ ``CoroutineScope`` çš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œå› æ­¤åªè¦æ‹¥æœ‰åç¨‹ä½œç”¨åŸŸï¼Œå°±å¯ä»¥è°ƒç”¨ ``launch`` å‡½æ•°

å•ç‹¬ä½¿ç”¨ ``launch`` å‡½æ•°å’Œæˆ‘ä»¬åˆšæ‰ä½¿ç”¨çš„ ``GlobalScope.launch`` å‡½æ•°ä¸åŒï¼Œ ``GlobalScope.launch`` åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œè€Œ ``launch`` å‡½æ•°åˆ›å»ºçš„æ˜¯å­åç¨‹

```kotlin
fun main() {
    runBlocking {
        launch {
            println("launch1")
            delay(1000)
            println("launch1 finished")
        }

        launch {
            println("launch2")
            delay(1000)
            println("launch2 finished")
        }
    }
}
//æ‰“å°ç»“æœ
launch1
launch2
launch1 finished
launch2 finished
```

ä¸Šè¿°ä»£ç æˆ‘ä»¬è°ƒç”¨äº†ä¸¤æ¬¡ launch å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºäº†ä¸¤ä¸ªå­åç¨‹ï¼Œè¿è¡Œä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå­åç¨‹çš„æ—¥å¿—æ˜¯äº¤æ›¿æ‰“å°çš„ï¼Œè¿™ä¸€ç°è±¡è¡¨æ˜ä»–ä»¬åƒæ˜¯**å¤šçº¿ç¨‹é‚£æ ·å¹¶å‘è¿è¡Œçš„**ã€‚ç„¶è€Œè¿™ä¸¤ä¸ªå­åç¨‹å®é™…ä¸Šæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œåªæ˜¯ç”±ç¼–ç¨‹è¯­è¨€æ¥å†³å®šå¦‚ä½•åœ¨å¤šä¸ªåç¨‹ä¹‹é—´è¿›è¡Œè°ƒåº¦ï¼Œè®©è°è¿è¡Œï¼Œè®©è°æŒ‚èµ·ã€‚è°ƒåº¦çš„è¿‡ç¨‹å®Œå…¨ä¸éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸ï¼Œè¿™ä¹Ÿå°±ä½¿å¾—åç¨‹çš„å¹¶å‘æ•ˆç‡å‡ºå¥‡çš„é«˜
ç›®å‰ launch å‡½æ•°ä¸­çš„é€»è¾‘æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œé‚£ä¹ˆéšç€é€»è¾‘è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†éƒ¨åˆ†ä»£ç æå–åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­ï¼Œå¦‚ä¸‹ï¼š

```kotlin
fun performLogistics(){
    //å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç 
    //...
    //è¿™å¥ä»£ç ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸º delay å‡½æ•°åªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨
    delay(1500)
    //...
}
```

ä¸Šé¢è¿™æ®µä»£ç æŠ¥é”™äº†ï¼Œå› ä¸ºæå–åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­å°±æ²¡æœ‰åç¨‹ä½œç”¨åŸŸäº†ï¼Œé‚£ä¹ˆ delay å‡½æ•°å°±è°ƒç”¨ä¸äº†äº†ï¼Œè›‹ç–¼ï¼Œæœ‰æ²¡æœ‰å…¶ä»–åŠæ³•å‘¢ï¼Ÿ
ä»”ç»†åˆ†æä¸€ä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“ delay å‡½æ•°åªèƒ½åœ¨**åç¨‹ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­**è°ƒç”¨ï¼Œç°åœ¨æå–å‡ºæ¥çš„å•ç‹¬å‡½æ•°æ²¡æœ‰åç¨‹ä½œç”¨åŸŸäº†ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥æŠŠå®ƒå£°æ˜æˆä¸€ä¸ªæŒ‚èµ·å‡½æ•°å‘¢ï¼Ÿ
ç­”ï¼šå¯ä»¥çš„ï¼Œ**ä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°ï¼ŒæŒ‚èµ·å‡½æ•°ä¹‹é—´æ˜¯å¯ä»¥ç›¸äº’è°ƒç”¨çš„**

### ä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°

``suspend`` å…³é”®å­—èƒ½å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°
æŒ‚èµ·å‡½æ•°å¿…é¡»åœ¨åç¨‹æˆ–è€…å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨

é‚£ä¹ˆä¸Šé¢ä»£ç æˆ‘ä»¬åŠ ä¸ªå…³é”®å­—ä¿®é¥°ä¸€ä¸‹å°± ok äº†ï¼Œå¦‚ä¸‹ï¼š

```kotlin
suspend fun performLogistics(){
    //å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç 
    //...
    delay(1500)
    //...
}
```

ç°åœ¨é—®é¢˜åˆæ¥äº†ï¼Œå¦‚æœæˆ‘æƒ³åœ¨è¿™ä¸ªæŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ launch å‡½æ•°å¯ä»¥ä¹ˆï¼Ÿå¦‚ä¸‹ï¼š

```kotlin
suspend fun performLogistics(){
    //å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç 
    //...
    delay(1500)
    //...
    //è¿™å¥ä»£ç ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡æœ‰åç¨‹ä½œç”¨åŸŸ
    launch{
      
    }
}
```

ä¸Šé¢è¿™æ®µä»£ç åˆæŠ¥é”™äº†ï¼Œå› ä¸ºæ²¡æœ‰åç¨‹ä½œç”¨åŸŸï¼Œé‚£ä¹ˆå¦‚æœæˆ‘æƒ³è¿™æ ·è°ƒç”¨ï¼Œèƒ½å®ç°ä¹ˆï¼Ÿ
ç­”ï¼šå¯ä»¥çš„ï¼Œå€ŸåŠ© coroutineScope å‡½æ•°æ¥è§£å†³

### ä½¿ç”¨ coroutineScope å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ

``coroutineScope`` å‡½æ•°ä¼šç»§æ‰¿å¤–éƒ¨çš„åç¨‹ä½œç”¨åŸŸå¹¶åˆ›å»ºä¸€ä¸ªå­ä½œç”¨åŸŸ
``coroutineScope`` å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨

```kotlin
suspend fun printDot() = coroutineScope {
    println(".")
    delay(1000)
    launch {

    }
}
```

ä¸Šè¿°ä»£ç è°ƒç”¨ launch å‡½æ•°å°±ä¸ä¼šæŠ¥é”™äº†ã€‚
å¦å¤–ï¼Œ ``coroutineScope`` å‡½æ•°å’Œ ``runBlocking`` å‡½æ•°æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒå¯ä»¥ä¿è¯å…¶ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹åœ¨å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¸€ç›´é˜»å¡å½“å‰åç¨‹ã€‚è€Œ runBlocking æ˜¯ä¸€ç›´é˜»å¡å½“å‰çº¿ç¨‹ï¼Œæˆ‘ä»¬æ¥åšä¸ªéªŒè¯ï¼š

```kotlin
fun main() {
    runBlocking {
        coroutineScope {
            launch {
                for (i in 1..5) {
                    println(i)
                }
            }
        }
        println("coroutineScope finished")
    }
    println("runBlocking finished")
}

//æ‰“å°ç»“æœ
1
2
3
4
5
coroutineScope finished
runBlocking finished
```

ä»æ‰“å°ç»“æœï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯ä¸Šé¢è¿™ä¸€ç»“è®º

### ä½¿ç”¨ async å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ

ä»ä¸Šé¢çš„å­¦ä¹ æˆ‘ä»¬å¯ä»¥çŸ¥é“ ``launch`` å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªå­åç¨‹ï¼Œä½†æ˜¯ ``launch`` å‡½æ•°åªèƒ½ç”¨äºæ‰§è¡Œä¸€æ®µé€»è¾‘ï¼Œå´ä¸èƒ½è·å–æ‰§è¡Œçš„ç»“æœï¼Œå› ä¸ºå®ƒçš„è¿”å›å€¼æ°¸è¿œæ˜¯ä¸€ä¸ª Job å¯¹è±¡ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–å®ƒçš„æ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ``async`` å‡½æ•°

- async å‡½æ•°å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸä¸‹æ‰èƒ½è°ƒç”¨
- async å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è¿”å›ä¸€ä¸ª Deferred å¯¹è±¡ï¼Œå¦‚æœéœ€è¦è·å– async å‡½æ•°ä»£ç å—ä¸­çš„æ‰§è¡Œç»“æœï¼Œåªéœ€è¦è°ƒç”¨ Deferred å¯¹è±¡çš„ ``await()`` æ–¹æ³•å³å¯
- async å‡½æ•°åœ¨è°ƒç”¨åä¼šç«‹åˆ»æ‰§è¡Œï¼Œå½“è°ƒç”¨ ``await()`` æ–¹æ³•æ—¶ï¼Œå¦‚æœä»£ç å—ä¸­çš„ä»£ç è¿˜æ²¡æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆ await() æ–¹æ³•ä¼šå°†å½“å‰åç¨‹é˜»å¡ä½ï¼Œç›´åˆ°å¯ä»¥è·å– async å‡½æ•°ä¸­çš„æ‰§è¡Œç»“æœ

```kotlin
fun main() {
    runBlocking {
        val start = System.currentTimeMillis()
        val result1 = async {
            delay(1000)
            5 + 5
        }.await()


        val result2 = async {
            delay(1000)
            4 + 6
        }.await()
        println("result is ${result1 + result2}")
        val end = System.currentTimeMillis()
        println("cost: ${end - start} ms.")
    }
}

//æ‰“å°ç»“æœ
result is 20
cost: 2017 ms.
```

ä¸Šè¿°ä»£ç è¿ç»­ä½¿ç”¨äº†ä¸¤ä¸ª ``async`` å‡½æ•°æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶åœ¨ä»£ç å—ä¸­è¿›è¡Œ 1 ç§’çš„å»¶è¿Ÿï¼ŒæŒ‰ç…§åˆšæ‰ä¸Šé¢è¯´çš„ï¼Œ``await()`` æ–¹æ³•åœ¨ ``async`` å‡½æ•°ä»£ç å—ä¸­çš„ä»£ç æ‰§è¡Œå®Œä¹‹å‰ä¼šä¸€ç›´å°†å½“å‰åç¨‹é˜»å¡ä½ã€‚æ•´æ®µä»£ç çš„æ‰§è¡Œè€—æ—¶æ˜¯ 2017 msï¼Œè¯´æ˜è¿™é‡Œçš„ä¸¤ä¸ª async å‡½æ•°ç¡®å®æ˜¯ä¸€ç§ä¸²è¡Œçš„å…³ç³»ï¼Œå‰ä¸€ä¸ªæ‰§è¡Œå®Œäº†ä¸‹ä¸€ä¸ªæ‰èƒ½æ‰§è¡Œã€‚å¾ˆæ˜æ˜¾è¿™ç§å†™æ³•æ˜¯æ¯”è¾ƒä½æ•ˆçš„ï¼Œå› ä¸ºä¸¤ä¸ª async å®Œå…¨å¯ä»¥å¼‚æ­¥å»æ‰§è¡Œï¼Œè€Œç°åœ¨å´è¢«æ•´æˆäº†åŒæ­¥ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„å†™æ³•ï¼š

```kotlin
fun main() {
    runBlocking {
        val start = System.currentTimeMillis()
        val deferred1 = async {
            delay(1000)
            5 + 5
        }


        val deferred2 = async {
            delay(1000)
            4 + 6
        }
        println("result is ${deferred1.await() + deferred2.await()}")
        val end = System.currentTimeMillis()
        println("cost: ${end - start} ms.")
    }
}

//æ‰“å°ç»“æœ
result is 20
cost: 1020 ms.
```

ä¸Šé¢çš„å†™æ³•æˆ‘ä»¬æ²¡æœ‰åœ¨æ¯æ¬¡è°ƒç”¨ ``async`` å‡½æ•°ä¹‹åå°±ç«‹åˆ»ä½¿ç”¨ ``await()`` æ–¹æ³•è·å–ç»“æœäº†ï¼Œè€Œæ˜¯ä»…åœ¨éœ€è¦ç”¨åˆ° ``async`` å‡½æ•°çš„æ‰§è¡Œç»“æœæ—¶æ‰è°ƒç”¨ ``await()`` æ–¹æ³•è¿›è¡Œè·å–ï¼Œè¿™æ · ``async`` å‡½æ•°å°±å˜æˆäº†ä¸€ç§å¼‚æ­¥å…³ç³»äº†ï¼Œå¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœä¹ŸéªŒè¯äº†è¿™ä¸€ç‚¹
æˆ‘æ˜¯ä¸ªå–œæ¬¢å·æ‡’çš„äººï¼Œ async å‡½æ•°æ¯æ¬¡éƒ½è¦è°ƒç”¨ await() æ–¹æ³•æ‰èƒ½è·å–ç»“æœï¼Œæ¯”è¾ƒç¹çï¼Œé‚£æˆ‘å°±ä¼šæƒ³ï¼šæœ‰æ²¡æœ‰ç±»ä¼¼ async å‡½æ•°å¹¶ä¸”ä¸éœ€è¦æ¯æ¬¡éƒ½å»è°ƒç”¨ await() æ–¹æ³•è·å–ç»“æœçš„å‡½æ•°å‘¢ï¼Ÿ
ç­”ï¼šæœ‰çš„ï¼Œä½¿ç”¨ withContext å‡½æ•°

### ä½¿ç”¨ withContext å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„  async å‡½æ•°

``withContext`` å‡½æ•°æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå¹¶ä¸”å¼ºåˆ¶è¦æ±‚æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåç¨‹ä¸Šä¸‹æ–‡å‚æ•°ï¼Œè¿™ä¸ªè°ƒåº¦å™¨å…¶å®å°±æ˜¯æŒ‡å®šåç¨‹å…·ä½“çš„è¿è¡Œçº¿ç¨‹
``withContext`` å‡½æ•°åœ¨è°ƒç”¨åä¼šç«‹åˆ»æ‰§è¡Œï¼Œå®ƒå¯ä»¥ä¿è¯å…¶ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹åœ¨å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¸€ç›´é˜»å¡å½“å‰åç¨‹
``withContext`` å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶å°†æœ€åä¸€è¡Œçš„æ‰§è¡Œç»“æœä½œä¸ºè¿”å›å€¼

```kotlin
fun main() {
    runBlocking {
        val result = withContext(Dispatchers.Default) {
            5 + 5
        }
        println(result)
    }
}

//æ‰“å°ç»“æœ
10
```

### ä½¿ç”¨ suspendCoroutine å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•

åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡å¼‚æ­¥å›è°ƒæœºåˆ¶å»è·å–ç½‘ç»œå“åº”æ•°æ®ï¼Œä¸çŸ¥ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œè¿™ç§å›è°ƒæœºåˆ¶åŸºæœ¬ä¸Šæ˜¯ä¾é åŒ¿åå†…éƒ¨ç±»æ¥å®ç°çš„ï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š

```kotlin
sendHttpRequest(object : OnHttpCallBackListener{
    override fun onSuccess(response: String) {
            
    }

    override fun onError(exception: Exception) {
            
    }
 })
```

é‚£ä¹ˆåœ¨å¤šå°‘åœ°æ–¹å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå°±éœ€è¦ç¼–å†™å¤šå°‘æ¬¡è¿™æ ·çš„åŒ¿åå†…éƒ¨ç±»å»å®ç°ï¼Œè¿™æ ·ä¼šæ˜¾å¾—ç‰¹åˆ«ç¹çã€‚åœ¨æˆ‘ä»¬å­¦ä¹  Kotin åç¨‹ä¹‹å‰ï¼Œå¯èƒ½ç¡®å®æ˜¯æ²¡æœ‰å•¥æ›´ç®€å•çš„å†™æ³•äº†ï¼Œä¸è¿‡ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ© Kotlin åç¨‹é‡Œé¢çš„ ``suspendCoroutine`` å‡½æ•°æ¥ç®€åŒ–å›è°ƒçš„å†™æ³•ï¼š

``suspendCoroutine`` å‡½æ•°å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸæˆ–è€…æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†å½“å‰åç¨‹ç«‹å³æŒ‚èµ·ï¼Œç„¶ååœ¨ä¸€ä¸ªæ™®é€šçº¿ç¨‹ä¸­å»æ‰§è¡Œ Lambda è¡¨è¾¾å¼ä¸­çš„ä»£ç 
``suspendCoroutine`` å‡½æ•°çš„ Lambda è¡¨è¾¾å¼å‚æ•°åˆ—è¡¨ä¼šä¼ å…¥ä¸€ä¸ª ``Contination`` å‚æ•°ï¼Œè°ƒç”¨å®ƒçš„ ``resume()`` æˆ– ``resumeWithException()`` æ–¹æ³•å¯ä»¥è®©åç¨‹æ¢å¤æ‰§è¡Œ

```kotlin
//å®šä¹‰æˆåŠŸå’Œå¤±è´¥çš„æ¥å£
interface OnHttpCallBackListener{
    fun onSuccess(response: String)
    fun onError(exception: Exception)
}

//æ¨¡æ‹Ÿå‘é€ä¸€ä¸ªç½‘ç»œè¯·æ±‚
fun sendHttpRequest(url: String, httpCallBack: OnHttpCallBackListener){

}

//å¯¹å‘é€çš„ç½‘ç»œè¯·æ±‚å›è°ƒä½¿ç”¨ suspendCoroutine å‡½æ•°è¿›è¡Œå°è£…
suspend fun request(url: String): String{
    return suspendCoroutine { continuation ->
        sendHttpRequest(url,object : OnHttpCallBackListener{
            override fun onSuccess(response: String) {
                continuation.resume(response)
            }

            override fun onError(exception: Exception) {
                continuation.resumeWithException(exception)
            }

        })

    }
}

//å…·ä½“ä½¿ç”¨
suspend fun getBaiduResponse(){
    try {
        val request = request("https://www.baidu.com/")
    } catch (e: Exception) {
        //å¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œå¤„ç†
    }
}
```

ä¸Šè¿°ä»£ç ä¸­ï¼š
1ã€æˆ‘ä»¬åœ¨ request å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†åˆšåˆšä»‹ç»çš„ ``suspendCoroutine`` å‡½æ•°ï¼Œè¿™æ ·å½“å‰åç¨‹ä¼šç«‹åˆ»è¢«æŒ‚èµ·ï¼Œè€Œ Lambda è¡¨è¾¾å¼ä¸­çš„ä»£ç åˆ™ä¼šåœ¨æ™®é€šçº¿ç¨‹ä¸­æ‰§è¡Œã€‚æ¥ç€æˆ‘ä»¬åœ¨ Lambda è¡¨è¾¾å¼ä¸­è°ƒç”¨äº†``sendHttpRequest()`` æ–¹æ³•å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶é€šè¿‡ä¼ ç»Ÿå›è°ƒçš„æ–¹å¼ç›‘å¬è¯·æ±‚ç»“æœ
2ã€å¦‚æœè¯·æ±‚æˆåŠŸå°±è°ƒç”¨ Continuation çš„ ``resume()`` æ–¹æ³•æ¢å¤è¢«æŒ‚èµ·çš„åç¨‹ï¼Œå¹¶ä¼ å…¥æœåŠ¡å™¨å“åº”çš„æ•°æ®ï¼Œè¯¥å€¼ä¼šæˆä¸º ``suspendCoroutine`` å‡½æ•°çš„è¿”å›å€¼
3ã€å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œå°±è°ƒç”¨ Continuation çš„ ``resumeWithException()`` æ–¹æ³•æ¢å¤è¢«æŒ‚èµ·çš„åç¨‹ï¼Œå¹¶ä¼ å…¥å…·ä½“çš„å¼‚å¸¸åŸå› 
4ã€æœ€ååœ¨ ``getBaiduResponse()`` ä¸­è¿›è¡Œäº†å…·ä½“ä½¿ç”¨ï¼Œæœ‰æ²¡æœ‰è§‰å¾—è¿™é‡Œçš„ä»£ç æ¸…çˆ½äº†å¾ˆå¤šï¼Ÿç”±äº  ``getBaiduResponse()`` æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå½“ ``getBaiduResponse()`` è°ƒç”¨äº† ``request()`` å‡½æ•°æ—¶ï¼Œå½“å‰åç¨‹ä¼šç«‹åˆ»æŒ‚èµ·ï¼Œç„¶åç­‰å¾…ç½‘ç»œè¯·æ±‚æˆåŠŸæˆ–è€…å¤±è´¥åï¼Œå½“å‰åç¨‹æ‰èƒ½æ¢å¤è¿è¡Œ
5ã€å¦‚æœè¯·æ±‚æˆåŠŸï¼Œæˆ‘ä»¬å°±èƒ½è·å¾—å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„å“åº”æ•°æ®ï¼Œå¦‚æœè¯·æ±‚å¤±è´¥ï¼Œåˆ™ä¼šç›´æ¥è¿›å…¥ catch è¯­å¥ä¸­
åˆ°è¿™é‡Œå…¶å®åˆä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼š``getBaiduResponse()`` å‡½æ•°è¢«å£°æ˜æˆäº†ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå› æ­¤å®ƒåªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸæˆ–å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨äº†ï¼Œä½¿ç”¨èµ·æ¥æ˜¯ä¸æ˜¯éå¸¸æœ‰å±€é™æ€§ï¼Ÿ
ç­”ï¼šç¡®å®å¦‚æ­¤ï¼Œå› ä¸º ``suspendCoroutine`` å‡½æ•°æœ¬èº«å°±æ˜¯è¦ç»“åˆåç¨‹ä¸€èµ·ä½¿ç”¨çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦é€šè¿‡åˆç†çš„é¡¹ç›®æ¶æ„è®¾è®¡å»è§£å†³è¿™ä¸ªé—®é¢˜
ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ ``suspendCoroutine`` å‡½æ•°å®ç°äº†çœ‹ä¼¼åŒæ­¥çš„æ–¹å¼å†™å‡ºå¼‚æ­¥çš„ä»£ç ï¼Œäº‹å®ä¸Š ``suspendCoroutine`` å‡½æ•°å‡ ä¹å¯ä»¥ç”¨äºç®€åŒ–ä»»ä½•å›è°ƒçš„å†™æ³•ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ Retrofit å°±å¯ä»¥ä½¿ç”¨ ``suspendCoroutine`` å‡½æ•°æ¥ç®€åŒ–å›è°ƒ
åˆ°äº†è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹åç¨‹æœ‰äº†ä¸€å®šçš„äº†è§£äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†æä¸€ç‚¹æ·±å…¥çš„ä¸œè¥¿

## æŒ‚èµ·

### æŒ‚èµ·çš„æœ¬è´¨

å¦‚ä¸‹ä»£ç ï¼š

```kotlin
class MainActivity : AppCompatActivity() {

    private val TAG: String = "MainActivity"
  
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        Log.d(TAG, "start... ");
        GlobalScope.launch(Dispatchers.Main) {
            mockTimeConsume()
            Log.d(TAG, "æˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œ");
        }
        Log.d(TAG, "æˆ‘åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†æˆå¨çš„ä»£ç ");
    }


    //æ¨¡æ‹ŸæŒ‚èµ·å‡½æ•°è€—æ—¶ä»»åŠ¡
    suspend fun mockTimeConsume() = withContext(Dispatchers.IO){
        Log.d(TAG, "ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... " +  + Thread.currentThread().name);
        Thread.sleep(3000)
    }
}
//æ‰“å°ç»“æœå¦‚ä¸‹
start...
æˆ‘åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†æˆå¨çš„ä»£ç 
ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­...DefaultDispatcher-worker-2
æˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œ
```

ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š

1. åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œå¹¶æŒ‡å®šè¯¥åç¨‹åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œ
2. åœ¨åç¨‹ä¸­æ‰§è¡Œ ``mockTimeConsume`` è¿™ä¸ªæ–¹æ³•å¹¶æ‰“å°äº†ä¸€å¥ Log
ç°åœ¨æˆ‘ä»¬ä»çº¿ç¨‹å’Œåç¨‹ä¸¤ä¸ªè§’åº¦å»åˆ†æå®ƒï¼š
å‰é¢æˆ‘åœ¨å›ç­”é—®é¢˜çš„æ—¶å€™è®²åˆ°è¿‡ï¼Œ**æŒ‚èµ·å°±æ˜¯åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªæŒ‡å®šçš„çº¿ç¨‹å»æ‰§è¡Œ**

#### çº¿ç¨‹

çº¿ç¨‹ï¼šé‚£ä¹ˆå½“æ‰§è¡Œåˆ°åç¨‹ä¸­çš„ ``mockTimeConsume()`` è¿™å¥ä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºé‡åˆ°äº†æŒ‚èµ·å‡½æ•°ï¼Œåç¨‹è¢«æŒ‚èµ·äº†ï¼Œä¸»çº¿ç¨‹å°†ä¼šè·³å‡ºè¿™ä¸ªåç¨‹ï¼Œå¦‚æœä¸‹é¢è¿˜æœ‰ä»£ç ï¼Œåˆ™ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ‰§è¡Œå®ƒç•Œé¢åˆ·æ–°çš„ä»»åŠ¡

#### åç¨‹

åç¨‹ï¼šå½“æ‰§è¡Œåˆ°åç¨‹ä¸­çš„ ``mockTimeConsume()`` è¿™å¥ä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºé‡åˆ°äº†æŒ‚èµ·å‡½æ•°ï¼Œå½“å‰åç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œæ³¨æ„æ˜¯æ•´ä¸ªåç¨‹è¢«æŒ‚èµ·äº†ï¼Œæ„å‘³ç€ ``mockTimeConsume()`` è¿™å¥ä»£ç ä¸‹é¢çš„ä»£ç éƒ½ä¸ä¼šæ‰§è¡Œäº†ï¼Œéœ€ç­‰å¾…æˆ‘è¿™å¥ä»£ç æ‰§è¡Œå®Œä¹‹ååœ¨æ¥ç€å¾€åæ‰§è¡Œï¼Œæ¥ä¸‹æ¥ä¼šåœ¨æŒ‡å®šçš„çº¿ç¨‹æ‰§è¡ŒæŒ‚èµ·å‡½æ•°é‡Œé¢çš„å†…å®¹ã€‚è°æŒ‡å®šçš„ï¼Ÿæ˜¯å½“å‰æŒ‚èµ·å‡½æ•°æŒ‡å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°å†…éƒ¨çš„ withContext ä¼ å…¥çš„ Dispatchers.IO æ‰€æŒ‡å®šçš„ IO çº¿ç¨‹

Dispatchers è°ƒåº¦å™¨ï¼Œå®ƒå¯ä»¥å°†åç¨‹é™åˆ¶åœ¨ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹æ‰§è¡Œï¼Œæˆ–è€…å°†å®ƒåˆ†æ´¾åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæˆ–è€…è®©å®ƒä¸å—é™åˆ¶åœ°è¿è¡Œ
å¸¸ç”¨çš„ Dispatchers ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š

- Dispatchers.Mainï¼šAndroid ä¸­çš„ä¸»çº¿ç¨‹
- Dispatchers.IOï¼šé’ˆå¯¹ç£ç›˜å’Œç½‘ç»œ IO è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé€‚åˆ IO å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ï¼šè¯»å†™æ–‡ä»¶ï¼Œæ“ä½œæ•°æ®åº“ä»¥åŠç½‘ç»œè¯·æ±‚
- Dispatchers.Defaultï¼šé€‚åˆ CPU å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è®¡ç®—

å½“æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œåç¨‹ä¸ºæˆ‘ä»¬åšçš„æœ€çˆ½çš„äº‹å°±æ¥äº†ï¼šæ¢å¤å½“å‰åç¨‹ï¼ŒæŠŠçº¿ç¨‹ä»å…¶ä»–çº¿ç¨‹ï¼Œåˆ‡å›åˆ°äº†å½“å‰çš„çº¿ç¨‹ã€‚é‚£ä¹ˆæ¥ç€å°±ä¼šæ‰§è¡Œåç¨‹ä¸­ Log.d(TAG, "æˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œ") è¿™å¥ä»£ç ï¼Œæ•´ä¸ªæµç¨‹å°±ç»“æŸäº†
é€šè¿‡ä¸Šé¢å¯¹çº¿ç¨‹å’Œåç¨‹ä¸¤ä¸ªè§’åº¦éƒ½åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€äº›ç»“è®ºï¼š

1. è¢« ``suspend`` ä¿®é¥°çš„æŒ‚èµ·å‡½æ•°æ¯”æ™®é€šå‡½æ•°å¤šä¸¤ä¸ªæ“ä½œï¼š
   
- æŒ‚èµ·ï¼šæš‚åœå½“å‰åç¨‹çš„æ‰§è¡Œï¼Œä¿å­˜æ‰€æœ‰çš„å±€éƒ¨å˜é‡
- æ¢å¤ï¼šä»åç¨‹è¢«æš‚åœçš„åœ°æ–¹ç»§ç»­æ‰§è¡Œåç¨‹
  
2. åç¨‹åœ¨æ‰§è¡Œåˆ°æœ‰ ``suspend`` æ ‡è®°çš„æŒ‚èµ·å‡½æ•°æ—¶ï¼Œä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ‰€è°“çš„è¢«æŒ‚èµ·ï¼Œå°±æ˜¯åˆ‡æ¢çº¿ç¨‹
   
3. åç¨‹è¢«æŒ‚èµ·ä¹‹åéœ€è¦æ¢å¤ï¼Œè€Œæ¢å¤è¿™ä¸ªæ“ä½œæ˜¯åç¨‹æ¡†æ¶ç»™æˆ‘ä»¬åšçš„

é€šè¿‡ç»“è®º 3 ï¼Œæˆ‘ä»¬å¼•ç”³ä¸€ä¸‹ï¼šå¦‚æœä½ ä¸åœ¨åç¨‹é‡Œé¢è°ƒç”¨æŒ‚èµ·å‡½æ•°ï¼Œæ¢å¤è¿™ä¸ªåŠŸèƒ½æ²¡æ³•å®ç°ï¼Œæ‰€ä»¥ä¹Ÿå°±å›ç­”äº†é—®é¢˜ï¼šä¸ºä»€ä¹ˆæŒ‚èµ·å‡½æ•°å¿…é¡»åœ¨åç¨‹æˆ–è€…å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨

å†ç»†æƒ³ä¸‹è¿™ä¸ªé€»è¾‘ï¼šä¸€ä¸ªæŒ‚èµ·å‡½æ•°è¦ä¹ˆåœ¨åç¨‹é‡Œè¢«è°ƒç”¨ï¼Œè¦ä¹ˆåœ¨å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå®ƒå…¶å®ç›´æ¥æˆ–è€…é—´æ¥åœ°ï¼Œæ€»æ˜¯ä¼šåœ¨ä¸€ä¸ªåç¨‹é‡Œè¢«è°ƒç”¨çš„
æ‰€ä»¥ï¼Œ**è¦æ±‚ suspend å‡½æ•°åªèƒ½åœ¨åç¨‹é‡Œæˆ–è€…å¦ä¸€ä¸ª suspend å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œè¿˜æ˜¯ä¸ºäº†è¦è®©åç¨‹èƒ½å¤Ÿåœ¨æŒ‚èµ·å‡½æ•°åˆ‡æ¢çº¿ç¨‹ä¹‹åå†åˆ‡å›æ¥**

### æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ

åˆ°è¿™é‡Œä½ å¿ƒé‡Œæ˜¯å¦ä¼šæœ‰å¦å¤–ä¸€ä¸ªç–‘é—®ï¼šåç¨‹æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿå¦‚æœä¸Šé¢é‚£ä¸ªæŒ‚èµ·å‡½æ•°è¿™ä¹ˆå†™ï¼š

```kotlin
suspend fun mockTimeConsume(){
   Log.d(TAG, "ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­..." + Thread.currentThread().name);
   Thread.sleep(3000)
}
```

è¿è¡Œåä½ ä¼šå‘ç°æ‰“å°çš„çº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼Œé‚£ä¸ºä»€ä¹ˆæ²¡æœ‰åˆ‡æ¢çº¿ç¨‹å‘¢ï¼Ÿå› ä¸ºå®ƒä¸çŸ¥é“å¾€å“ªåˆ‡ï¼Œéœ€è¦æˆ‘ä»¬å‘Šè¯‰å®ƒï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š

```kotlin
suspend fun mockTimeConsume() = withContext(Dispatchers.IO){
   Log.d(TAG, "ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... " +  + Thread.currentThread().name);
   Thread.sleep(3000)
}
```

æˆ‘ä»¬å¯ä»¥å‘ç°ä¸åŒä¹‹å¤„å…¶å®åœ¨äº ``withContext`` å‡½æ•°ã€‚
å…¶å®é€šè¿‡ ``withContext`` æºç å¯ä»¥çŸ¥é“ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª Dispatcher å‚æ•°ï¼Œä¾èµ–è¿™ä¸ª Dispatcher å‚æ•°çš„æŒ‡ç¤ºï¼Œä½ çš„åç¨‹å°±è¢«æŒ‚èµ·äº†ï¼Œç„¶ååˆ‡åˆ°åˆ«çš„çº¿ç¨‹
æ‰€ä»¥ä½¿ç”¨ ``suspend`` å®šä¹‰çš„æŒ‚èµ·å‡½æ•°ï¼Œè¿˜ä¸æ˜¯çœŸæ­£çš„æŒ‚èµ·å‡½æ•°ï¼Œ**çœŸæ­£çš„æŒ‚èµ·å‡½æ•°å†…éƒ¨éœ€è¦è°ƒç”¨åˆ° Kotlin åç¨‹æ¡†æ¶è‡ªå¸¦çš„æŒ‚èµ·å‡½æ•°**
å› æ­¤æˆ‘ä»¬æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œä»…ä»…åªåŠ ä¸Š ``suspend`` å…³é”®å­—æ˜¯ä¸è¡Œçš„ï¼Œè¿˜éœ€è¦å‡½æ•°å†…éƒ¨ç›´æ¥æˆ–é—´æ¥åœ°è°ƒç”¨åˆ° Kotlin åç¨‹æ¡†æ¶è‡ªå¸¦çš„ æŒ‚èµ·å‡½æ•°æ‰è¡Œ

### ä½¿ç”¨ suspend çš„æ„ä¹‰

é€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬çŸ¥é“ï¼Œä½¿ç”¨ ``suspend`` å…³é”®å­—ä¿®é¥°çš„å‡½æ•°å¯èƒ½è¿˜ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æŒ‚èµ·å‡½æ•°ï¼Œé‚£å®ƒçš„ä½œç”¨æ˜¯å•¥å‘¢ï¼Ÿ
èµ·åˆ°ä¸€ä¸ªæé†’çš„ä½œç”¨ï¼Œæé†’è°ƒç”¨è€…æˆ‘æ˜¯ä¸€ä¸ªè€—æ—¶å‡½æ•°ï¼Œéœ€è¦åœ¨æŒ‚èµ·å‡½æ•°æˆ–è€…åç¨‹ä¸­è°ƒç”¨æˆ‘
ä¸ºä»€ä¹ˆ ``suspend`` å…³é”®å­—å¹¶æ²¡æœ‰å®é™…å»æ“ä½œæŒ‚èµ·ï¼Œä½† Kotlin å´æŠŠå®ƒæä¾›å‡ºæ¥ï¼Ÿ
å› ä¸ºå®ƒæœ¬æ¥å°±ä¸æ˜¯ç”¨æ¥æ“ä½œæŒ‚èµ·çš„ã€‚
**æŒ‚èµ·çš„æ“ä½œ â€”â€” ä¹Ÿå°±æ˜¯åˆ‡çº¿ç¨‹ï¼Œä¾èµ–çš„æ˜¯æŒ‚èµ·å‡½æ•°é‡Œé¢çš„å®é™…ä»£ç ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå…³é”®å­—**
æ‰€ä»¥è¿™ä¸ªå…³é”®å­—ï¼Œåªæ˜¯ä¸€ä¸ªæé†’ã€‚

```kotlin
suspend fun mockTimeConsume(){
   Log.d(TAG, "ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­..." + Thread.currentThread().name);
   Thread.sleep(3000)
}
```

ä¸Šè¿°è¿™æ®µä»£ç è¿™æ ·åšæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè€Œä¸”ä¼šå½±å“åˆ°ç¨‹åºçš„æ€§èƒ½ï¼ŒAndroidStudio ä¹Ÿä¼šæç¤ºä½  suspend ä¿®é¥°ç¬¦æ˜¯å¤šä½™çš„ã€‚

### å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ

ç¬¬ä¸€æ­¥ï¼šåˆ†æåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å»ä½¿ç”¨æŒ‚èµ·å‡½æ•°ï¼Ÿ
å¦‚æœä½ çš„æŸä¸ªå‡½æ•°æ¯”è¾ƒè€—æ—¶ï¼Œæ¶‰åŠåˆ°å¤šçº¿ç¨‹æ“ä½œï¼Œå¦‚ï¼šç½‘ç»œè¯·æ±‚ï¼ŒI/O æ“ä½œï¼ŒCPU è®¡ç®—å·¥ä½œç­‰éœ€è¦ç­‰å¾…çš„æ“ä½œï¼Œé‚£å°±æŠŠå®ƒå†™æˆ suspend æŒ‚èµ·å‡½æ•°ï¼Œè¿™æ˜¯åŸåˆ™
ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ **suspend** å…³é”®å­—ä¿®é¥°ä½ çš„å‡½æ•°ï¼Œå¹¶åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ Kotin åç¨‹æ¡†æ¶æä¾›çš„æŒ‚èµ·å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š

```kotlin
suspend fun mockTimeConsume() = withContext(Dispatchers.IO){
   Log.d(TAG, "ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... " +  + Thread.currentThread().name);
   Thread.sleep(3000)
}
```
